==========================================
ðŸš€ Pipeline started at Mon Dec 15 18:44:32 UTC 2025
==========================================
[1/5] Ingesting raw data...
25/12/15 18:44:36 INFO SparkContext: Running Spark version 3.5.1
25/12/15 18:44:36 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:44:36 INFO SparkContext: Java version 17.0.17
25/12/15 18:44:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 18:44:36 INFO ResourceUtils: ==============================================================
25/12/15 18:44:36 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 18:44:36 INFO ResourceUtils: ==============================================================
25/12/15 18:44:36 INFO SparkContext: Submitted application: Airline Delay Analysis
25/12/15 18:44:36 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 18:44:36 INFO ResourceProfile: Limiting resource is cpu
25/12/15 18:44:36 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 18:44:36 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 18:44:36 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 18:44:36 INFO SecurityManager: Changing view acls groups to: 
25/12/15 18:44:36 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 18:44:36 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 18:44:37 INFO Utils: Successfully started service 'sparkDriver' on port 43863.
25/12/15 18:44:37 INFO SparkEnv: Registering MapOutputTracker
25/12/15 18:44:37 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 18:44:37 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 18:44:37 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 18:44:37 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 18:44:37 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-564fc55f-29ef-4404-b5f1-b199ba3ce5e5
25/12/15 18:44:37 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 18:44:37 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 18:44:37 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 18:44:37 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 18:44:37 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 18:44:37 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:44:37 INFO Executor: Java version 17.0.17
25/12/15 18:44:37 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 18:44:37 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 18:44:37 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45127.
25/12/15 18:44:37 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:45127
25/12/15 18:44:37 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 18:44:37 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45127, None)
25/12/15 18:44:37 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:45127 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45127, None)
25/12/15 18:44:38 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45127, None)
25/12/15 18:44:38 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45127, None)
25/12/15 18:44:38 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 18:44:38 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 18:44:40 INFO InMemoryFileIndex: It took 71 ms to list leaf files for 1 paths.
25/12/15 18:44:40 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
25/12/15 18:44:42 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:44:43 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 18:44:43 INFO CodeGenerator: Code generated in 230.833089 ms
25/12/15 18:44:43 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 18:44:43 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/15 18:44:43 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 18:44:43 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:44:43 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:44:44 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:44:44 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:44:44 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:44:44 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:44:44 INFO DAGScheduler: Missing parents: List()
25/12/15 18:44:44 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:44:44 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 18:44:44 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 18:44:44 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 18:44:44 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 18:44:44 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:44:44 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 18:44:44 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:44:44 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 18:44:44 INFO CodeGenerator: Code generated in 16.32096 ms
25/12/15 18:44:44 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:44:44 INFO CodeGenerator: Code generated in 20.467222 ms
25/12/15 18:44:44 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 18:44:44 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 306 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:44:44 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 18:44:44 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.437 s
25/12/15 18:44:44 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:44:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 18:44:44 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.486575 s
25/12/15 18:44:44 INFO CodeGenerator: Code generated in 11.594579 ms
25/12/15 18:44:44 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:44:44 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:44:44 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 18:44:44 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/15 18:44:44 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 18:44:44 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:44:44 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:44:44 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:44:44 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:44:44 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:44:44 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:44:44 INFO DAGScheduler: Missing parents: List()
25/12/15 18:44:44 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:44:44 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 18:44:44 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 18:44:44 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:44:44 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 18:44:44 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:44:44 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 18:44:44 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:44:44 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:44:44 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 18:44:44 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 18:44:44 INFO CodeGenerator: Code generated in 18.765997 ms
25/12/15 18:44:44 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:44:44 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:44:47 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 18:44:47 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2140 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:44:47 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 18:44:47 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2296 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:44:47 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 18:44:47 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.356 s
25/12/15 18:44:47 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:44:47 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 18:44:47 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.368361 s
25/12/15 18:44:47 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:44:47 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:44:47 INFO CodeGenerator: Code generated in 23.417054 ms
25/12/15 18:44:47 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 18:44:47 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.2 MiB)
25/12/15 18:44:47 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 18:44:47 INFO SparkContext: Created broadcast 4 from count at NativeMethodAccessorImpl.java:0
25/12/15 18:44:47 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:44:47 INFO DAGScheduler: Registering RDD 13 (count at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/15 18:44:47 INFO DAGScheduler: Got map stage job 2 (count at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:44:47 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0)
25/12/15 18:44:47 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:44:47 INFO DAGScheduler: Missing parents: List()
25/12/15 18:44:47 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:44:47 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 18.6 KiB, free 413.2 MiB)
25/12/15 18:44:47 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 9.1 KiB, free 413.2 MiB)
25/12/15 18:44:47 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 9.1 KiB, free: 413.8 MiB)
25/12/15 18:44:47 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 18:44:47 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:44:47 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 18:44:47 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:44:47 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:44:47 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 18:44:47 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 18:44:47 INFO CodeGenerator: Code generated in 28.097179 ms
25/12/15 18:44:47 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:44:47 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:44:47 INFO CodeGenerator: Code generated in 19.278438 ms
25/12/15 18:44:48 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 1988 bytes result sent to driver
25/12/15 18:44:48 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2031 bytes result sent to driver
25/12/15 18:44:48 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 485 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:44:48 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 485 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:44:48 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 18:44:48 INFO DAGScheduler: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0) finished in 0.524 s
25/12/15 18:44:48 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:44:48 INFO DAGScheduler: running: Set()
25/12/15 18:44:48 INFO DAGScheduler: waiting: Set()
25/12/15 18:44:48 INFO DAGScheduler: failed: Set()
25/12/15 18:44:48 INFO CodeGenerator: Code generated in 16.18399 ms
25/12/15 18:44:48 INFO SparkContext: Starting job: count at NativeMethodAccessorImpl.java:0
25/12/15 18:44:48 INFO DAGScheduler: Got job 3 (count at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:44:48 INFO DAGScheduler: Final stage: ResultStage 4 (count at NativeMethodAccessorImpl.java:0)
25/12/15 18:44:48 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/15 18:44:48 INFO DAGScheduler: Missing parents: List()
25/12/15 18:44:48 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:44:48 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 12.5 KiB, free 413.1 MiB)
25/12/15 18:44:48 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 413.1 MiB)
25/12/15 18:44:48 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 5.9 KiB, free: 413.8 MiB)
25/12/15 18:44:48 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/15 18:44:48 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:44:48 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/15 18:44:48 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:44:48 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/15 18:44:48 INFO ShuffleBlockFetcherIterator: Getting 2 (120.0 B) non-empty blocks including 2 (120.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:44:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 13 ms
25/12/15 18:44:48 INFO CodeGenerator: Code generated in 28.122644 ms
25/12/15 18:44:48 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 3995 bytes result sent to driver
25/12/15 18:44:48 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 105 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:44:48 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/15 18:44:48 INFO DAGScheduler: ResultStage 4 (count at NativeMethodAccessorImpl.java:0) finished in 0.123 s
25/12/15 18:44:48 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:44:48 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/15 18:44:48 INFO DAGScheduler: Job 3 finished: count at NativeMethodAccessorImpl.java:0, took 0.140379 s
Number of rows: 318017
Schema:
root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- carrier_name: string (nullable = true)
 |-- airport: string (nullable = true)
 |-- airport_name: string (nullable = true)
 |-- arr_flights: integer (nullable = true)
 |-- arr_del15: integer (nullable = true)
 |-- carrier_ct: double (nullable = true)
 |-- weather_ct: double (nullable = true)
 |-- nas_ct: double (nullable = true)
 |-- security_ct: double (nullable = true)
 |-- late_aircraft_ct: double (nullable = true)
 |-- arr_cancelled: integer (nullable = true)
 |-- arr_diverted: integer (nullable = true)
 |-- arr_delay: integer (nullable = true)
 |-- carrier_delay: integer (nullable = true)
 |-- weather_delay: integer (nullable = true)
 |-- nas_delay: integer (nullable = true)
 |-- security_delay: integer (nullable = true)
 |-- late_aircraft_delay: integer (nullable = true)

25/12/15 18:44:48 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:45127 in memory (size: 5.9 KiB, free: 413.8 MiB)
25/12/15 18:44:48 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:44:48 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:44:48 INFO CodeGenerator: Code generated in 70.719742 ms
25/12/15 18:44:48 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.0 MiB)
25/12/15 18:44:48 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 412.9 MiB)
25/12/15 18:44:48 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 18:44:48 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:44:48 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:44:48 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:44:48 INFO DAGScheduler: Got job 4 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:44:48 INFO DAGScheduler: Final stage: ResultStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:44:48 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:44:48 INFO DAGScheduler: Missing parents: List()
25/12/15 18:44:48 INFO DAGScheduler: Submitting ResultStage 5 (MapPartitionsRDD[20] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:44:48 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 25.1 KiB, free 412.9 MiB)
25/12/15 18:44:48 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 9.6 KiB, free 412.9 MiB)
25/12/15 18:44:48 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:45127 (size: 9.6 KiB, free: 413.8 MiB)
25/12/15 18:44:48 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/15 18:44:48 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 5 (MapPartitionsRDD[20] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:44:48 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
25/12/15 18:44:48 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:44:48 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/15 18:44:48 INFO CodeGenerator: Code generated in 49.159401 ms
25/12/15 18:44:48 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:44:48 INFO CodeGenerator: Code generated in 29.901481 ms
25/12/15 18:44:48 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 3602 bytes result sent to driver
25/12/15 18:44:48 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 127 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:44:48 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/15 18:44:48 INFO DAGScheduler: ResultStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 0.139 s
25/12/15 18:44:48 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:44:48 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
25/12/15 18:44:48 INFO DAGScheduler: Job 4 finished: showString at NativeMethodAccessorImpl.java:0, took 0.144874 s
25/12/15 18:44:48 INFO CodeGenerator: Code generated in 54.243834 ms
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
|year|month|carrier|carrier_name     |airport|airport_name                                               |arr_flights|arr_del15|carrier_ct|weather_ct|nas_ct|security_ct|late_aircraft_ct|arr_cancelled|arr_diverted|arr_delay|carrier_delay|weather_delay|nas_delay|security_delay|late_aircraft_delay|
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
|2022|5    |9E     |Endeavor Air Inc.|ABE    |Allentown/Bethlehem/Easton, PA: Lehigh Valley International|136        |7        |5.95      |0.0       |0.05  |0.0        |1.0             |0            |0           |255      |222          |0            |4        |0             |29                 |
|2022|5    |9E     |Endeavor Air Inc.|ABY    |Albany, GA: Southwest Georgia Regional                     |91         |16       |7.38      |0.0       |2.54  |0.0        |6.09            |0            |0           |884      |351          |0            |81       |0             |452                |
|2022|5    |9E     |Endeavor Air Inc.|ACK    |Nantucket, MA: Nantucket Memorial                          |19         |2        |0.13      |0.0       |1.0   |0.0        |0.88            |1            |0           |138      |4            |0            |106      |0             |28                 |
|2022|5    |9E     |Endeavor Air Inc.|AEX    |Alexandria, LA: Alexandria International                   |88         |14       |7.26      |0.76      |4.35  |0.0        |1.64            |0            |0           |947      |585          |35           |125      |0             |202                |
|2022|5    |9E     |Endeavor Air Inc.|AGS    |Augusta, GA: Augusta Regional at Bush Field                |181        |19       |13.84     |0.0       |3.07  |0.0        |2.09            |0            |0           |808      |662          |0            |87       |0             |59                 |
|2022|5    |9E     |Endeavor Air Inc.|ALB    |Albany, NY: Albany International                           |134        |18       |4.42      |1.0       |6.48  |0.0        |6.09            |5            |0           |917      |224          |78           |398      |0             |217                |
|2022|5    |9E     |Endeavor Air Inc.|ATL    |Atlanta, GA: Hartsfield-Jackson Atlanta International      |3042       |453      |142.96    |13.53     |106.98|0.0        |189.53          |2            |3           |38397    |20775        |1205         |3610     |0             |12807              |
|2022|5    |9E     |Endeavor Air Inc.|ATW    |Appleton, WI: Appleton International                       |118        |13       |4.83      |0.0       |6.85  |0.0        |1.32            |0            |0           |914      |578          |0            |171      |0             |165                |
|2022|5    |9E     |Endeavor Air Inc.|AUS    |Austin, TX: Austin - Bergstrom International               |53         |8        |5.23      |1.0       |0.89  |0.0        |0.88            |1            |0           |582      |445          |20           |19       |0             |98                 |
|2022|5    |9E     |Endeavor Air Inc.|AVL    |Asheville, NC: Asheville Regional                          |58         |14       |4.54      |0.0       |7.61  |0.0        |1.85            |1            |0           |996      |290          |0            |618      |0             |88                 |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
only showing top 10 rows

25/12/15 18:44:48 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 18:44:48 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 18:44:48 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 18:44:48 INFO MemoryStore: MemoryStore cleared
25/12/15 18:44:48 INFO BlockManager: BlockManager stopped
25/12/15 18:44:48 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 18:44:48 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 18:44:48 INFO SparkContext: Successfully stopped SparkContext
25/12/15 18:44:49 INFO ShutdownHookManager: Shutdown hook called
25/12/15 18:44:49 INFO ShutdownHookManager: Deleting directory /tmp/spark-b1bb1ff6-714f-4864-8551-a385d51dd634/pyspark-a7f32d20-faf8-4e15-8857-aaef50b05421
25/12/15 18:44:49 INFO ShutdownHookManager: Deleting directory /tmp/spark-1fac398a-40d4-4523-94c5-b88b3158cbda
25/12/15 18:44:49 INFO ShutdownHookManager: Deleting directory /tmp/spark-b1bb1ff6-714f-4864-8551-a385d51dd634
[2/5] Transforming data...
25/12/15 18:44:52 INFO SparkContext: Running Spark version 3.5.1
25/12/15 18:44:52 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:44:52 INFO SparkContext: Java version 17.0.17
25/12/15 18:44:52 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 18:44:52 INFO ResourceUtils: ==============================================================
25/12/15 18:44:52 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 18:44:52 INFO ResourceUtils: ==============================================================
25/12/15 18:44:52 INFO SparkContext: Submitted application: Airline Transform
25/12/15 18:44:52 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 18:44:52 INFO ResourceProfile: Limiting resource is cpu
25/12/15 18:44:52 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 18:44:52 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 18:44:52 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 18:44:52 INFO SecurityManager: Changing view acls groups to: 
25/12/15 18:44:52 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 18:44:52 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 18:44:53 INFO Utils: Successfully started service 'sparkDriver' on port 32831.
25/12/15 18:44:53 INFO SparkEnv: Registering MapOutputTracker
25/12/15 18:44:53 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 18:44:53 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 18:44:53 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 18:44:53 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 18:44:53 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-6e49e6dc-2a19-43ae-8e43-e0b35efa4959
25/12/15 18:44:53 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 18:44:53 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 18:44:53 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 18:44:53 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 18:44:53 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 18:44:53 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:44:53 INFO Executor: Java version 17.0.17
25/12/15 18:44:53 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 18:44:53 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 18:44:53 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 35773.
25/12/15 18:44:53 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:35773
25/12/15 18:44:53 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 18:44:53 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 35773, None)
25/12/15 18:44:53 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:35773 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 35773, None)
25/12/15 18:44:53 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 35773, None)
25/12/15 18:44:53 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 35773, None)
25/12/15 18:44:54 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 18:44:54 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 18:44:55 INFO InMemoryFileIndex: It took 56 ms to list leaf files for 1 paths.
25/12/15 18:44:55 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/15 18:44:58 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:44:58 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 18:44:59 INFO CodeGenerator: Code generated in 283.452186 ms
25/12/15 18:44:59 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 18:44:59 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/15 18:44:59 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:35773 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 18:44:59 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:44:59 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:44:59 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:44:59 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:44:59 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:44:59 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:44:59 INFO DAGScheduler: Missing parents: List()
25/12/15 18:44:59 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:44:59 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 18:44:59 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 18:44:59 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:35773 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 18:44:59 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 18:44:59 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:44:59 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 18:44:59 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:44:59 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 18:44:59 INFO CodeGenerator: Code generated in 27.591631 ms
25/12/15 18:44:59 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:44:59 INFO CodeGenerator: Code generated in 13.907793 ms
25/12/15 18:45:00 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 18:45:00 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 301 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:00 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 18:45:00 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.501 s
25/12/15 18:45:00 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:00 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 18:45:00 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.631971 s
25/12/15 18:45:00 INFO CodeGenerator: Code generated in 21.880462 ms
25/12/15 18:45:00 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:00 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:45:00 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 18:45:00 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/15 18:45:00 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:35773 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 18:45:00 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:00 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:00 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:00 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:00 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:00 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:00 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:00 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:00 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 18:45:00 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 18:45:00 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:35773 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:45:00 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:00 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:00 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 18:45:00 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:00 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:00 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 18:45:00 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 18:45:00 INFO CodeGenerator: Code generated in 21.724177 ms
25/12/15 18:45:00 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:00 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:02 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 18:45:02 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2002 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:02 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 18:45:02 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2167 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:02 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 18:45:02 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.239 s
25/12/15 18:45:02 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:02 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 18:45:02 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.253499 s
root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- carrier_name: string (nullable = true)
 |-- airport: string (nullable = true)
 |-- airport_name: string (nullable = true)
 |-- arr_flights: integer (nullable = true)
 |-- arr_del15: integer (nullable = true)
 |-- carrier_ct: double (nullable = true)
 |-- weather_ct: double (nullable = true)
 |-- nas_ct: double (nullable = true)
 |-- security_ct: double (nullable = true)
 |-- late_aircraft_ct: double (nullable = true)
 |-- arr_cancelled: integer (nullable = true)
 |-- arr_diverted: integer (nullable = true)
 |-- arr_delay: integer (nullable = true)
 |-- carrier_delay: integer (nullable = true)
 |-- weather_delay: integer (nullable = true)
 |-- nas_delay: integer (nullable = true)
 |-- security_delay: integer (nullable = true)
 |-- late_aircraft_delay: integer (nullable = true)
 |-- total_delay_minutes: integer (nullable = true)
 |-- total_delay_count: double (nullable = true)

25/12/15 18:45:03 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:03 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:03 INFO CodeGenerator: Code generated in 127.714549 ms
25/12/15 18:45:03 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 18:45:03 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 18:45:03 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:35773 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:03 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:03 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:03 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:03 INFO DAGScheduler: Got job 2 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:03 INFO DAGScheduler: Final stage: ResultStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:03 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:03 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:03 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:03 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 30.4 KiB, free 413.2 MiB)
25/12/15 18:45:03 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 10.5 KiB, free 413.1 MiB)
25/12/15 18:45:03 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:35773 (size: 10.5 KiB, free: 413.8 MiB)
25/12/15 18:45:03 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:03 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:03 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks resource profile 0
25/12/15 18:45:03 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:03 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 18:45:03 INFO CodeGenerator: Code generated in 109.422186 ms
25/12/15 18:45:03 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:03 INFO CodeGenerator: Code generated in 49.674222 ms
25/12/15 18:45:03 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 3811 bytes result sent to driver
25/12/15 18:45:03 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 258 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:03 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 18:45:03 INFO DAGScheduler: ResultStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 0.288 s
25/12/15 18:45:03 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:03 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
25/12/15 18:45:03 INFO DAGScheduler: Job 2 finished: showString at NativeMethodAccessorImpl.java:0, took 0.301248 s
25/12/15 18:45:03 INFO CodeGenerator: Code generated in 43.191466 ms
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
|year|month|carrier|carrier_name     |airport|airport_name                                               |arr_flights|arr_del15|carrier_ct|weather_ct|nas_ct|security_ct|late_aircraft_ct|arr_cancelled|arr_diverted|arr_delay|carrier_delay|weather_delay|nas_delay|security_delay|late_aircraft_delay|total_delay_minutes|total_delay_count |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
|2022|5    |9E     |Endeavor Air Inc.|ABE    |Allentown/Bethlehem/Easton, PA: Lehigh Valley International|136        |7        |5.95      |0.0       |0.05  |0.0        |1.0             |0            |0           |255      |222          |0            |4        |0             |29                 |255                |7.0               |
|2022|5    |9E     |Endeavor Air Inc.|ABY    |Albany, GA: Southwest Georgia Regional                     |91         |16       |7.38      |0.0       |2.54  |0.0        |6.09            |0            |0           |884      |351          |0            |81       |0             |452                |884                |16.009999999999998|
|2022|5    |9E     |Endeavor Air Inc.|ACK    |Nantucket, MA: Nantucket Memorial                          |19         |2        |0.13      |0.0       |1.0   |0.0        |0.88            |1            |0           |138      |4            |0            |106      |0             |28                 |138                |2.01              |
|2022|5    |9E     |Endeavor Air Inc.|AEX    |Alexandria, LA: Alexandria International                   |88         |14       |7.26      |0.76      |4.35  |0.0        |1.64            |0            |0           |947      |585          |35           |125      |0             |202                |947                |14.01             |
|2022|5    |9E     |Endeavor Air Inc.|AGS    |Augusta, GA: Augusta Regional at Bush Field                |181        |19       |13.84     |0.0       |3.07  |0.0        |2.09            |0            |0           |808      |662          |0            |87       |0             |59                 |808                |19.0              |
|2022|5    |9E     |Endeavor Air Inc.|ALB    |Albany, NY: Albany International                           |134        |18       |4.42      |1.0       |6.48  |0.0        |6.09            |5            |0           |917      |224          |78           |398      |0             |217                |917                |17.990000000000002|
|2022|5    |9E     |Endeavor Air Inc.|ATL    |Atlanta, GA: Hartsfield-Jackson Atlanta International      |3042       |453      |142.96    |13.53     |106.98|0.0        |189.53          |2            |3           |38397    |20775        |1205         |3610     |0             |12807              |38397              |453.0             |
|2022|5    |9E     |Endeavor Air Inc.|ATW    |Appleton, WI: Appleton International                       |118        |13       |4.83      |0.0       |6.85  |0.0        |1.32            |0            |0           |914      |578          |0            |171      |0             |165                |914                |13.0              |
|2022|5    |9E     |Endeavor Air Inc.|AUS    |Austin, TX: Austin - Bergstrom International               |53         |8        |5.23      |1.0       |0.89  |0.0        |0.88            |1            |0           |582      |445          |20           |19       |0             |98                 |582                |8.0               |
|2022|5    |9E     |Endeavor Air Inc.|AVL    |Asheville, NC: Asheville Regional                          |58         |14       |4.54      |0.0       |7.61  |0.0        |1.85            |1            |0           |996      |290          |0            |618      |0             |88                 |996                |14.0              |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
only showing top 10 rows

25/12/15 18:45:03 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 18:45:03 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 18:45:03 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 18:45:03 INFO MemoryStore: MemoryStore cleared
25/12/15 18:45:03 INFO BlockManager: BlockManager stopped
25/12/15 18:45:03 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 18:45:03 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 18:45:03 INFO SparkContext: Successfully stopped SparkContext
25/12/15 18:45:04 INFO ShutdownHookManager: Shutdown hook called
25/12/15 18:45:04 INFO ShutdownHookManager: Deleting directory /tmp/spark-39adee2c-17be-403d-8243-e391e376d7fe
25/12/15 18:45:04 INFO ShutdownHookManager: Deleting directory /tmp/spark-2bf38216-5291-4f27-863c-03051a14ff99
25/12/15 18:45:04 INFO ShutdownHookManager: Deleting directory /tmp/spark-2bf38216-5291-4f27-863c-03051a14ff99/pyspark-ebc6e006-6555-4adc-8974-5d1c21f5ad8b
[3/5] Computing metrics...
25/12/15 18:45:07 INFO SparkContext: Running Spark version 3.5.1
25/12/15 18:45:07 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:45:07 INFO SparkContext: Java version 17.0.17
25/12/15 18:45:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 18:45:07 INFO ResourceUtils: ==============================================================
25/12/15 18:45:07 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 18:45:07 INFO ResourceUtils: ==============================================================
25/12/15 18:45:07 INFO SparkContext: Submitted application: Airline Metrics
25/12/15 18:45:07 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 18:45:07 INFO ResourceProfile: Limiting resource is cpu
25/12/15 18:45:07 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 18:45:07 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 18:45:07 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 18:45:07 INFO SecurityManager: Changing view acls groups to: 
25/12/15 18:45:07 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 18:45:07 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 18:45:08 INFO Utils: Successfully started service 'sparkDriver' on port 40357.
25/12/15 18:45:08 INFO SparkEnv: Registering MapOutputTracker
25/12/15 18:45:08 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 18:45:08 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 18:45:08 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 18:45:08 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 18:45:08 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-b2dcebfe-06ad-464a-b91c-8b44599b22cc
25/12/15 18:45:08 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 18:45:08 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 18:45:08 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 18:45:08 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 18:45:08 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 18:45:08 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:45:08 INFO Executor: Java version 17.0.17
25/12/15 18:45:08 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 18:45:08 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 18:45:09 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42143.
25/12/15 18:45:09 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:42143
25/12/15 18:45:09 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 18:45:09 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 42143, None)
25/12/15 18:45:09 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:42143 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 42143, None)
25/12/15 18:45:09 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 42143, None)
25/12/15 18:45:09 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 42143, None)
25/12/15 18:45:09 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 18:45:09 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 18:45:10 INFO InMemoryFileIndex: It took 55 ms to list leaf files for 1 paths.
25/12/15 18:45:10 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/15 18:45:13 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:13 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 18:45:14 INFO CodeGenerator: Code generated in 283.813847 ms
25/12/15 18:45:14 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 18:45:14 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.7 MiB)
25/12/15 18:45:14 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:14 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:14 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:14 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:14 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:14 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:14 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:14 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:14 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:14 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 18:45:14 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 18:45:14 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 18:45:14 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:14 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:14 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 18:45:14 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:14 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 18:45:15 INFO CodeGenerator: Code generated in 34.375461 ms
25/12/15 18:45:15 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:15 INFO CodeGenerator: Code generated in 26.276975 ms
25/12/15 18:45:15 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 18:45:15 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 353 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:15 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 18:45:15 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.542 s
25/12/15 18:45:15 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:15 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 18:45:15 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.613706 s
25/12/15 18:45:15 INFO CodeGenerator: Code generated in 18.071501 ms
25/12/15 18:45:15 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:15 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:45:15 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 18:45:15 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/15 18:45:15 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:15 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:15 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:15 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:15 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:15 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:15 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:15 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:15 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 18:45:15 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 18:45:15 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:45:15 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:15 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:15 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 18:45:15 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:15 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:15 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 18:45:15 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 18:45:15 INFO CodeGenerator: Code generated in 19.536052 ms
25/12/15 18:45:15 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:15 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:17 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 18:45:17 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2163 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:17 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 18:45:17 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2313 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:17 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 18:45:17 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.375 s
25/12/15 18:45:17 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 18:45:17 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.389795 s
25/12/15 18:45:18 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:18 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:18 INFO CodeGenerator: Code generated in 169.052522 ms
25/12/15 18:45:18 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 18:45:18 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 18:45:18 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:18 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:18 INFO DAGScheduler: Registering RDD 13 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/15 18:45:18 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:18 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:18 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:18 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:18 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:18 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 55.5 KiB, free 413.1 MiB)
25/12/15 18:45:18 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 23.4 KiB, free 413.1 MiB)
25/12/15 18:45:18 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 23.4 KiB, free: 413.8 MiB)
25/12/15 18:45:18 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:18 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:18 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 18:45:18 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:18 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:18 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 18:45:18 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 18:45:19 INFO CodeGenerator: Code generated in 98.477874 ms
25/12/15 18:45:19 INFO CodeGenerator: Code generated in 20.641789 ms
25/12/15 18:45:19 INFO CodeGenerator: Code generated in 14.567131 ms
25/12/15 18:45:19 INFO CodeGenerator: Code generated in 16.534761 ms
25/12/15 18:45:19 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:19 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:19 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:19 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:45:19 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/15 18:45:19 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:19 INFO CodeGenerator: Code generated in 62.387501 ms
25/12/15 18:45:21 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2884 bytes result sent to driver
25/12/15 18:45:21 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 2417 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:21 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2841 bytes result sent to driver
25/12/15 18:45:21 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 2497 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:21 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 2.531 s
25/12/15 18:45:21 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 18:45:21 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:21 INFO DAGScheduler: running: Set()
25/12/15 18:45:21 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:21 INFO DAGScheduler: failed: Set()
25/12/15 18:45:21 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:21 INFO CodeGenerator: Code generated in 14.130778 ms
25/12/15 18:45:21 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:21 INFO CodeGenerator: Code generated in 26.745972 ms
25/12/15 18:45:21 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:21 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:21 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/15 18:45:21 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:21 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:21 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 56.1 KiB, free 413.6 MiB)
25/12/15 18:45:21 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 413.5 MiB)
25/12/15 18:45:21 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 24.3 KiB, free: 413.8 MiB)
25/12/15 18:45:21 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:21 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/15 18:45:21 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:21 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/15 18:45:21 INFO CodeGenerator: Code generated in 10.004405 ms
25/12/15 18:45:21 INFO ShuffleBlockFetcherIterator: Getting 2 (4.5 KiB) non-empty blocks including 2 (4.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:21 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 14 ms
25/12/15 18:45:21 INFO CodeGenerator: Code generated in 19.748761 ms
25/12/15 18:45:21 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 5883 bytes result sent to driver
25/12/15 18:45:21 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 168 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:21 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/15 18:45:21 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.185 s
25/12/15 18:45:21 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/15 18:45:21 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.205913 s
25/12/15 18:45:21 INFO CodeGenerator: Code generated in 8.722986 ms
25/12/15 18:45:21 INFO CodeGenerator: Code generated in 9.650986 ms
+----------------------------+-----------+
|carrier_name                |total_delay|
+----------------------------+-----------+
|Southwest Airlines Co.      |197589768  |
|American Airlines Inc.      |158749715  |
|SkyWest Airlines Inc.       |126613903  |
|Delta Air Lines Inc.        |125894776  |
|United Air Lines Inc.       |114178620  |
|ExpressJet Airlines Inc.    |98092859   |
|American Eagle Airlines Inc.|64419820   |
|JetBlue Airways             |62841558   |
|US Airways Inc.             |48308565   |
|Atlantic Southeast Airlines |36380279   |
+----------------------------+-----------+
only showing top 10 rows

25/12/15 18:45:21 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:21 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:22 INFO CodeGenerator: Code generated in 82.085871 ms
25/12/15 18:45:22 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.3 MiB)
25/12/15 18:45:22 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.3 MiB)
25/12/15 18:45:22 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:22 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:22 INFO DAGScheduler: Registering RDD 21 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
25/12/15 18:45:22 INFO DAGScheduler: Got map stage job 4 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:22 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:22 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:22 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:22 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:22 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 56.9 KiB, free 413.3 MiB)
25/12/15 18:45:22 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 413.2 MiB)
25/12/15 18:45:22 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 23.9 KiB, free: 413.8 MiB)
25/12/15 18:45:22 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:22 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:22 INFO TaskSchedulerImpl: Adding task set 5.0 with 2 tasks resource profile 0
25/12/15 18:45:22 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:22 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 7) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:22 INFO Executor: Running task 1.0 in stage 5.0 (TID 7)
25/12/15 18:45:22 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/15 18:45:22 INFO CodeGenerator: Code generated in 78.725582 ms
25/12/15 18:45:22 INFO CodeGenerator: Code generated in 9.428514 ms
25/12/15 18:45:22 INFO CodeGenerator: Code generated in 10.826386 ms
25/12/15 18:45:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:22 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 24.3 KiB, free: 413.8 MiB)
25/12/15 18:45:23 INFO Executor: Finished task 1.0 in stage 5.0 (TID 7). 2841 bytes result sent to driver
25/12/15 18:45:23 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 7) in 1661 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:23 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 2841 bytes result sent to driver
25/12/15 18:45:23 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 1736 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:23 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/15 18:45:23 INFO DAGScheduler: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 1.754 s
25/12/15 18:45:23 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:23 INFO DAGScheduler: running: Set()
25/12/15 18:45:23 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:23 INFO DAGScheduler: failed: Set()
25/12/15 18:45:23 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:23 INFO CodeGenerator: Code generated in 14.335223 ms
25/12/15 18:45:23 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:23 INFO CodeGenerator: Code generated in 19.117772 ms
25/12/15 18:45:24 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:24 INFO DAGScheduler: Got job 5 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:24 INFO DAGScheduler: Final stage: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:24 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/12/15 18:45:24 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:24 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:24 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 57.9 KiB, free 413.3 MiB)
25/12/15 18:45:24 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 413.2 MiB)
25/12/15 18:45:24 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 24.9 KiB, free: 413.8 MiB)
25/12/15 18:45:24 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:24 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:24 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/12/15 18:45:24 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 8) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:24 INFO Executor: Running task 0.0 in stage 7.0 (TID 8)
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 8.611514 ms
25/12/15 18:45:24 INFO ShuffleBlockFetcherIterator: Getting 2 (59.8 KiB) non-empty blocks including 2 (59.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:24 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 15.334253 ms
25/12/15 18:45:24 INFO Executor: Finished task 0.0 in stage 7.0 (TID 8). 6090 bytes result sent to driver
25/12/15 18:45:24 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 8) in 85 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:24 INFO DAGScheduler: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0) finished in 0.103 s
25/12/15 18:45:24 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/12/15 18:45:24 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/12/15 18:45:24 INFO DAGScheduler: Job 5 finished: showString at NativeMethodAccessorImpl.java:0, took 0.124872 s
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 8.737222 ms
+------------------------------------------------------+------------------+
|airport_name                                          |avg_delay         |
+------------------------------------------------------+------------------+
|Chicago, IL: Chicago O'Hare International             |31867.799072091362|
|Atlanta, GA: Hartsfield-Jackson Atlanta International |27830.672919508866|
|Dallas/Fort Worth, TX: Dallas/Fort Worth International|20571.237798546208|
|Newark, NJ: Newark Liberty International              |17511.09181784524 |
|San Francisco, CA: San Francisco International        |16140.159023668639|
|Sanford, FL: Orlando Sanford International            |16041.452830188678|
|Denver, CO: Denver International                      |15025.973445143256|
|New York, NY: John F. Kennedy International           |14642.515225933203|
|Los Angeles, CA: Los Angeles International            |13589.449129852745|
|Houston, TX: George Bush Intercontinental/Houston     |13375.582714118107|
+------------------------------------------------------+------------------+
only showing top 10 rows

25/12/15 18:45:24 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:24 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 56.447385 ms
25/12/15 18:45:24 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 199.5 KiB, free 413.0 MiB)
25/12/15 18:45:24 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.0 MiB)
25/12/15 18:45:24 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:24 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:24 INFO DAGScheduler: Registering RDD 29 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/12/15 18:45:24 INFO DAGScheduler: Got map stage job 6 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:24 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:24 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:24 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:24 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:24 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 55.2 KiB, free 412.9 MiB)
25/12/15 18:45:24 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 23.2 KiB, free 412.9 MiB)
25/12/15 18:45:24 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 23.2 KiB, free: 413.7 MiB)
25/12/15 18:45:24 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:24 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:24 INFO TaskSchedulerImpl: Adding task set 8.0 with 2 tasks resource profile 0
25/12/15 18:45:24 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 9) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:24 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 10) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:24 INFO Executor: Running task 1.0 in stage 8.0 (TID 10)
25/12/15 18:45:24 INFO Executor: Running task 0.0 in stage 8.0 (TID 9)
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 55.900848 ms
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 21.831059 ms
25/12/15 18:45:24 INFO BlockManagerInfo: Removed broadcast_9_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 24.9 KiB, free: 413.8 MiB)
25/12/15 18:45:24 INFO CodeGenerator: Code generated in 11.861401 ms
25/12/15 18:45:24 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:24 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:25 INFO Executor: Finished task 1.0 in stage 8.0 (TID 10). 2841 bytes result sent to driver
25/12/15 18:45:25 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 10) in 1492 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:25 INFO Executor: Finished task 0.0 in stage 8.0 (TID 9). 2841 bytes result sent to driver
25/12/15 18:45:25 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 9) in 1589 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:25 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/12/15 18:45:25 INFO DAGScheduler: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0) finished in 1.600 s
25/12/15 18:45:25 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:25 INFO DAGScheduler: running: Set()
25/12/15 18:45:25 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:25 INFO DAGScheduler: failed: Set()
25/12/15 18:45:25 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 6.121506 ms
25/12/15 18:45:26 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 19.412766 ms
25/12/15 18:45:26 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:26 INFO DAGScheduler: Got job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:26 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:26 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/12/15 18:45:26 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:26 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:26 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 56.0 KiB, free 413.0 MiB)
25/12/15 18:45:26 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 24.2 KiB, free 412.9 MiB)
25/12/15 18:45:26 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 24.2 KiB, free: 413.7 MiB)
25/12/15 18:45:26 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:26 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/12/15 18:45:26 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 11) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:26 INFO Executor: Running task 0.0 in stage 10.0 (TID 11)
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 6.686621 ms
25/12/15 18:45:26 INFO ShuffleBlockFetcherIterator: Getting 2 (1386.0 B) non-empty blocks including 2 (1386.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:26 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 24.815786 ms
25/12/15 18:45:26 INFO Executor: Finished task 0.0 in stage 10.0 (TID 11). 5576 bytes result sent to driver
25/12/15 18:45:26 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 11) in 68 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:26 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/12/15 18:45:26 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.088 s
25/12/15 18:45:26 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/12/15 18:45:26 INFO DAGScheduler: Job 7 finished: showString at NativeMethodAccessorImpl.java:0, took 0.098548 s
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 9.024588 ms
+----+------------+
|year|yearly_delay|
+----+------------+
|2003|32535792    |
|2004|73088325    |
|2005|76476224    |
|2006|87187039    |
|2007|100965732   |
|2008|86637993    |
|2009|66005819    |
|2010|63257498    |
|2011|61670561    |
|2012|56916692    |
+----+------------+
only showing top 10 rows

25/12/15 18:45:26 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:26 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 49.914459 ms
25/12/15 18:45:26 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 199.5 KiB, free 412.7 MiB)
25/12/15 18:45:26 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.7 MiB)
25/12/15 18:45:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.7 MiB)
25/12/15 18:45:26 INFO SparkContext: Created broadcast 13 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:26 INFO DAGScheduler: Registering RDD 37 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/12/15 18:45:26 INFO DAGScheduler: Got map stage job 8 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:26 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:26 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:26 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:26 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:26 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 55.2 KiB, free 412.6 MiB)
25/12/15 18:45:26 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 23.2 KiB, free 412.6 MiB)
25/12/15 18:45:26 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 23.2 KiB, free: 413.7 MiB)
25/12/15 18:45:26 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:26 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:26 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
25/12/15 18:45:26 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 12) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:26 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 13) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:26 INFO Executor: Running task 1.0 in stage 11.0 (TID 13)
25/12/15 18:45:26 INFO Executor: Running task 0.0 in stage 11.0 (TID 12)
25/12/15 18:45:26 INFO CodeGenerator: Code generated in 33.192375 ms
25/12/15 18:45:26 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:26 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:26 INFO BlockManagerInfo: Removed broadcast_12_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 24.2 KiB, free: 413.7 MiB)
25/12/15 18:45:27 INFO Executor: Finished task 1.0 in stage 11.0 (TID 13). 2841 bytes result sent to driver
25/12/15 18:45:27 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 13) in 1207 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:27 INFO Executor: Finished task 0.0 in stage 11.0 (TID 12). 2841 bytes result sent to driver
25/12/15 18:45:27 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 12) in 1401 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:27 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
25/12/15 18:45:27 INFO DAGScheduler: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 1.414 s
25/12/15 18:45:27 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:27 INFO DAGScheduler: running: Set()
25/12/15 18:45:27 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:27 INFO DAGScheduler: failed: Set()
25/12/15 18:45:27 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:27 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:27 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:27 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:27 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:27 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
25/12/15 18:45:27 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:27 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:27 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 56.0 KiB, free 412.6 MiB)
25/12/15 18:45:27 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 412.6 MiB)
25/12/15 18:45:27 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 24.3 KiB, free: 413.7 MiB)
25/12/15 18:45:27 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:27 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
25/12/15 18:45:27 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:27 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
25/12/15 18:45:27 INFO ShuffleBlockFetcherIterator: Getting 2 (1584.0 B) non-empty blocks including 2 (1584.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:27 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 4 ms
25/12/15 18:45:27 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5576 bytes result sent to driver
25/12/15 18:45:27 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 32 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:27 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
25/12/15 18:45:27 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.048 s
25/12/15 18:45:27 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
25/12/15 18:45:27 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.059076 s
+-----+-------------+
|month|monthly_delay|
+-----+-------------+
|1    |110991145    |
|2    |103189056    |
|3    |109732760    |
|4    |99452911     |
|5    |108496590    |
|6    |142912106    |
|7    |147857638    |
|8    |128590594    |
|9    |78557928     |
|10   |89932256     |
+-----+-------------+
only showing top 10 rows

25/12/15 18:45:27 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:27 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:28 INFO BlockManagerInfo: Removed broadcast_15_piece0 on ip-172-31-64-111.ec2.internal:42143 in memory (size: 24.3 KiB, free: 413.7 MiB)
25/12/15 18:45:28 INFO CodeGenerator: Code generated in 56.406759 ms
25/12/15 18:45:28 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 199.5 KiB, free 412.5 MiB)
25/12/15 18:45:28 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.5 MiB)
25/12/15 18:45:28 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 34.3 KiB, free: 413.7 MiB)
25/12/15 18:45:28 INFO SparkContext: Created broadcast 16 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:28 INFO DAGScheduler: Registering RDD 45 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 4
25/12/15 18:45:28 INFO DAGScheduler: Got map stage job 10 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:28 INFO DAGScheduler: Final stage: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:28 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:28 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:28 INFO DAGScheduler: Submitting ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:28 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 56.9 KiB, free 412.4 MiB)
25/12/15 18:45:28 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 412.4 MiB)
25/12/15 18:45:28 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 23.9 KiB, free: 413.6 MiB)
25/12/15 18:45:28 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:28 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:28 INFO TaskSchedulerImpl: Adding task set 14.0 with 2 tasks resource profile 0
25/12/15 18:45:28 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 15) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:28 INFO TaskSetManager: Starting task 1.0 in stage 14.0 (TID 16) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:28 INFO Executor: Running task 1.0 in stage 14.0 (TID 16)
25/12/15 18:45:28 INFO Executor: Running task 0.0 in stage 14.0 (TID 15)
25/12/15 18:45:28 INFO CodeGenerator: Code generated in 53.936645 ms
25/12/15 18:45:28 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:28 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:29 INFO Executor: Finished task 1.0 in stage 14.0 (TID 16). 2841 bytes result sent to driver
25/12/15 18:45:29 INFO TaskSetManager: Finished task 1.0 in stage 14.0 (TID 16) in 1573 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:30 INFO Executor: Finished task 0.0 in stage 14.0 (TID 15). 2841 bytes result sent to driver
25/12/15 18:45:30 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 15) in 1862 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:30 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
25/12/15 18:45:30 INFO DAGScheduler: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 1.872 s
25/12/15 18:45:30 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:30 INFO DAGScheduler: running: Set()
25/12/15 18:45:30 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:30 INFO DAGScheduler: failed: Set()
25/12/15 18:45:30 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:30 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:30 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:30 INFO DAGScheduler: Got job 11 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:30 INFO DAGScheduler: Final stage: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 15)
25/12/15 18:45:30 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:30 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:30 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 57.9 KiB, free 412.3 MiB)
25/12/15 18:45:30 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 412.3 MiB)
25/12/15 18:45:30 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on ip-172-31-64-111.ec2.internal:42143 (size: 24.9 KiB, free: 413.6 MiB)
25/12/15 18:45:30 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:30 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
25/12/15 18:45:30 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 17) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:30 INFO Executor: Running task 0.0 in stage 16.0 (TID 17)
25/12/15 18:45:30 INFO ShuffleBlockFetcherIterator: Getting 2 (4.6 KiB) non-empty blocks including 2 (4.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:30 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 18:45:30 INFO Executor: Finished task 0.0 in stage 16.0 (TID 17). 5840 bytes result sent to driver
25/12/15 18:45:30 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 17) in 31 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:30 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/12/15 18:45:30 INFO DAGScheduler: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.052 s
25/12/15 18:45:30 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
25/12/15 18:45:30 INFO DAGScheduler: Job 11 finished: showString at NativeMethodAccessorImpl.java:0, took 0.058978 s
+----------------------------+------------------+
|carrier_name                |avg_carrier_delay |
+----------------------------+------------------+
|Southwest Airlines Co.      |11242.021392808376|
|American Airlines Inc.      |8029.828780981285 |
|United Air Lines Inc.       |5979.190406367826 |
|JetBlue Airways             |5430.483753888697 |
|Delta Air Lines Inc.        |4574.997310851079 |
|US Airways Inc.             |4518.197250280584 |
|Continental Air Lines Inc.  |4342.791835552982 |
|Spirit Air Lines            |4336.106388595565 |
|American Eagle Airlines Inc.|4183.37684265212  |
|ExpressJet Airlines Inc.    |4005.9157512149304|
+----------------------------+------------------+
only showing top 10 rows

25/12/15 18:45:30 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 18:45:30 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 18:45:30 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 18:45:30 INFO MemoryStore: MemoryStore cleared
25/12/15 18:45:30 INFO BlockManager: BlockManager stopped
25/12/15 18:45:30 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 18:45:30 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 18:45:30 INFO SparkContext: Successfully stopped SparkContext
25/12/15 18:45:30 INFO ShutdownHookManager: Shutdown hook called
25/12/15 18:45:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-a42dfa1e-5db1-4604-ade8-965a04c6bdfa/pyspark-376e58ed-68ac-4936-adfc-83b533cae90d
25/12/15 18:45:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-6de2e38d-f40f-4310-a56e-08cb1c4f103a
25/12/15 18:45:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-a42dfa1e-5db1-4604-ade8-965a04c6bdfa
[4/5] Running Spark SQL analysis...
25/12/15 18:45:33 INFO SparkContext: Running Spark version 3.5.1
25/12/15 18:45:33 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:45:33 INFO SparkContext: Java version 17.0.17
25/12/15 18:45:34 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 18:45:34 INFO ResourceUtils: ==============================================================
25/12/15 18:45:34 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 18:45:34 INFO ResourceUtils: ==============================================================
25/12/15 18:45:34 INFO SparkContext: Submitted application: Airline SQL
25/12/15 18:45:34 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 18:45:34 INFO ResourceProfile: Limiting resource is cpu
25/12/15 18:45:34 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 18:45:34 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 18:45:34 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 18:45:34 INFO SecurityManager: Changing view acls groups to: 
25/12/15 18:45:34 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 18:45:34 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 18:45:34 INFO Utils: Successfully started service 'sparkDriver' on port 37507.
25/12/15 18:45:34 INFO SparkEnv: Registering MapOutputTracker
25/12/15 18:45:34 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 18:45:34 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 18:45:34 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 18:45:34 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 18:45:34 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-73214690-1f6c-4255-aac5-61291e3a5f50
25/12/15 18:45:34 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 18:45:34 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 18:45:35 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 18:45:35 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 18:45:35 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 18:45:35 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:45:35 INFO Executor: Java version 17.0.17
25/12/15 18:45:35 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 18:45:35 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 18:45:35 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 43529.
25/12/15 18:45:35 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:43529
25/12/15 18:45:35 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 18:45:35 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43529, None)
25/12/15 18:45:35 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:43529 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43529, None)
25/12/15 18:45:35 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43529, None)
25/12/15 18:45:35 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43529, None)
25/12/15 18:45:36 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 18:45:36 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 18:45:37 INFO InMemoryFileIndex: It took 75 ms to list leaf files for 1 paths.
25/12/15 18:45:37 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
25/12/15 18:45:40 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:40 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 18:45:40 INFO CodeGenerator: Code generated in 229.470282 ms
25/12/15 18:45:40 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 18:45:41 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.7 MiB)
25/12/15 18:45:41 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:41 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:41 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:41 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:41 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:41 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:41 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:41 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:41 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:41 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 18:45:41 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 18:45:41 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 18:45:41 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:41 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:41 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 18:45:41 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:41 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 18:45:41 INFO CodeGenerator: Code generated in 32.65699 ms
25/12/15 18:45:41 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:41 INFO CodeGenerator: Code generated in 25.905487 ms
25/12/15 18:45:41 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 18:45:41 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 382 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:41 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 18:45:41 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.537 s
25/12/15 18:45:41 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:41 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 18:45:41 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.593772 s
25/12/15 18:45:41 INFO CodeGenerator: Code generated in 15.892229 ms
25/12/15 18:45:41 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:41 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:45:41 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 18:45:42 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/15 18:45:42 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:42 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:42 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:42 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:45:42 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:42 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:42 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:42 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:42 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:42 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 18:45:42 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 18:45:42 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:45:42 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:42 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:42 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 18:45:42 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:42 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:45:42 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 18:45:42 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 18:45:42 INFO CodeGenerator: Code generated in 16.939234 ms
25/12/15 18:45:42 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:42 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:44 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 18:45:44 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1944 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:44 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 18:45:44 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2127 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:44 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 18:45:44 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.194 s
25/12/15 18:45:44 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 18:45:44 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.205491 s
25/12/15 18:45:44 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:44 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:45 INFO CodeGenerator: Code generated in 186.759678 ms
25/12/15 18:45:45 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 18:45:45 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 18:45:45 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:45 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:45 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:45 INFO DAGScheduler: Registering RDD 13 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/15 18:45:45 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:45 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:45 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:45 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:45 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:45 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 53.2 KiB, free 413.1 MiB)
25/12/15 18:45:45 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 22.4 KiB, free 413.1 MiB)
25/12/15 18:45:45 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 22.4 KiB, free: 413.8 MiB)
25/12/15 18:45:45 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:45 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:45 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 18:45:45 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:45 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:45 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 18:45:45 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 18:45:45 INFO CodeGenerator: Code generated in 123.250066 ms
25/12/15 18:45:45 INFO CodeGenerator: Code generated in 11.323892 ms
25/12/15 18:45:45 INFO CodeGenerator: Code generated in 8.783765 ms
25/12/15 18:45:45 INFO CodeGenerator: Code generated in 8.793886 ms
25/12/15 18:45:45 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:45 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:45 INFO CodeGenerator: Code generated in 171.969547 ms
25/12/15 18:45:45 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:45 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:45:45 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/15 18:45:45 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:47 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2884 bytes result sent to driver
25/12/15 18:45:47 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 2722 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:48 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2841 bytes result sent to driver
25/12/15 18:45:48 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 2854 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:48 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 18:45:48 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 2.880 s
25/12/15 18:45:48 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:48 INFO DAGScheduler: running: Set()
25/12/15 18:45:48 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:48 INFO DAGScheduler: failed: Set()
25/12/15 18:45:48 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 20.791323 ms
25/12/15 18:45:48 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 38.386908 ms
25/12/15 18:45:48 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:48 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:48 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:48 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/15 18:45:48 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:48 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:48 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 54.0 KiB, free 413.6 MiB)
25/12/15 18:45:48 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 23.7 KiB, free 413.5 MiB)
25/12/15 18:45:48 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 23.7 KiB, free: 413.8 MiB)
25/12/15 18:45:48 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:48 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:48 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/15 18:45:48 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:48 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 13.437436 ms
25/12/15 18:45:48 INFO ShuffleBlockFetcherIterator: Getting 2 (4.5 KiB) non-empty blocks including 2 (4.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 12 ms
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 37.535057 ms
25/12/15 18:45:48 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 5840 bytes result sent to driver
25/12/15 18:45:48 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 173 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:48 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/15 18:45:48 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.203 s
25/12/15 18:45:48 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:48 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/15 18:45:48 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.230496 s
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 8.900372 ms
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 8.316479 ms
+----------------------------+-------------------+
|carrier_name                |total_arrival_delay|
+----------------------------+-------------------+
|Southwest Airlines Co.      |197589768          |
|American Airlines Inc.      |158749715          |
|SkyWest Airlines Inc.       |126613903          |
|Delta Air Lines Inc.        |125895285          |
|United Air Lines Inc.       |114178620          |
|ExpressJet Airlines Inc.    |98092859           |
|American Eagle Airlines Inc.|64419820           |
|JetBlue Airways             |62841558           |
|US Airways Inc.             |48308565           |
|Atlantic Southeast Airlines |36380279           |
+----------------------------+-------------------+
only showing top 10 rows

25/12/15 18:45:48 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:48 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:48 INFO CodeGenerator: Code generated in 81.566173 ms
25/12/15 18:45:48 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.4 MiB)
25/12/15 18:45:48 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.3 MiB)
25/12/15 18:45:48 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:48 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:48 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:48 INFO DAGScheduler: Registering RDD 21 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
25/12/15 18:45:48 INFO DAGScheduler: Got map stage job 4 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:48 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:48 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:48 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:48 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:48 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 54.6 KiB, free 413.3 MiB)
25/12/15 18:45:48 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.0 KiB, free 413.2 MiB)
25/12/15 18:45:48 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 23.0 KiB, free: 413.8 MiB)
25/12/15 18:45:48 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:48 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:48 INFO TaskSchedulerImpl: Adding task set 5.0 with 2 tasks resource profile 0
25/12/15 18:45:48 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:48 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 7) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:48 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/15 18:45:48 INFO Executor: Running task 1.0 in stage 5.0 (TID 7)
25/12/15 18:45:49 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 23.7 KiB, free: 413.8 MiB)
25/12/15 18:45:49 INFO CodeGenerator: Code generated in 66.061805 ms
25/12/15 18:45:49 INFO CodeGenerator: Code generated in 11.618015 ms
25/12/15 18:45:49 INFO CodeGenerator: Code generated in 12.849186 ms
25/12/15 18:45:49 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:49 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:50 INFO Executor: Finished task 1.0 in stage 5.0 (TID 7). 2841 bytes result sent to driver
25/12/15 18:45:50 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 7) in 1474 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:50 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 2841 bytes result sent to driver
25/12/15 18:45:50 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 1743 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:50 INFO DAGScheduler: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 1.755 s
25/12/15 18:45:50 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/15 18:45:50 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:50 INFO DAGScheduler: running: Set()
25/12/15 18:45:50 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:50 INFO DAGScheduler: failed: Set()
25/12/15 18:45:50 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:50 INFO CodeGenerator: Code generated in 13.61091 ms
25/12/15 18:45:50 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:50 INFO CodeGenerator: Code generated in 29.646073 ms
25/12/15 18:45:50 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:50 INFO DAGScheduler: Got job 5 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:50 INFO DAGScheduler: Final stage: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:50 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/12/15 18:45:50 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:50 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:50 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 55.8 KiB, free 413.3 MiB)
25/12/15 18:45:50 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.2 KiB, free 413.2 MiB)
25/12/15 18:45:50 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 24.2 KiB, free: 413.8 MiB)
25/12/15 18:45:50 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:50 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:50 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/12/15 18:45:50 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 8) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:50 INFO Executor: Running task 0.0 in stage 7.0 (TID 8)
25/12/15 18:45:50 INFO CodeGenerator: Code generated in 13.067158 ms
25/12/15 18:45:50 INFO ShuffleBlockFetcherIterator: Getting 2 (59.8 KiB) non-empty blocks including 2 (59.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:50 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 3 ms
25/12/15 18:45:50 INFO CodeGenerator: Code generated in 30.84979 ms
25/12/15 18:45:50 INFO Executor: Finished task 0.0 in stage 7.0 (TID 8). 6090 bytes result sent to driver
25/12/15 18:45:50 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 8) in 113 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:50 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/12/15 18:45:50 INFO DAGScheduler: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0) finished in 0.132 s
25/12/15 18:45:50 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:50 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/12/15 18:45:50 INFO DAGScheduler: Job 5 finished: showString at NativeMethodAccessorImpl.java:0, took 0.152632 s
25/12/15 18:45:51 INFO CodeGenerator: Code generated in 8.586095 ms
+------------------------------------------------------+------------------+
|airport_name                                          |avg_arrival_delay |
+------------------------------------------------------+------------------+
|Chicago, IL: Chicago O'Hare International             |31867.799072091362|
|Atlanta, GA: Hartsfield-Jackson Atlanta International |27830.672919508866|
|Dallas/Fort Worth, TX: Dallas/Fort Worth International|20571.237798546208|
|Newark, NJ: Newark Liberty International              |17511.09181784524 |
|San Francisco, CA: San Francisco International        |16140.159023668639|
|Sanford, FL: Orlando Sanford International            |16041.452830188678|
|Denver, CO: Denver International                      |15025.973445143256|
|New York, NY: John F. Kennedy International           |14642.515225933203|
|Los Angeles, CA: Los Angeles International            |13589.449129852745|
|Houston, TX: George Bush Intercontinental/Houston     |13375.582714118107|
+------------------------------------------------------+------------------+
only showing top 10 rows

25/12/15 18:45:51 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:51 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:51 INFO CodeGenerator: Code generated in 64.839097 ms
25/12/15 18:45:51 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 199.5 KiB, free 413.0 MiB)
25/12/15 18:45:51 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.0 MiB)
25/12/15 18:45:51 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:51 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:51 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:51 INFO DAGScheduler: Registering RDD 29 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/12/15 18:45:51 INFO DAGScheduler: Got map stage job 6 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:51 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:51 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:51 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:51 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:51 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 52.9 KiB, free 413.0 MiB)
25/12/15 18:45:51 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 22.2 KiB, free 412.9 MiB)
25/12/15 18:45:51 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 22.2 KiB, free: 413.7 MiB)
25/12/15 18:45:51 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:51 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:51 INFO TaskSchedulerImpl: Adding task set 8.0 with 2 tasks resource profile 0
25/12/15 18:45:51 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 9) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:51 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 10) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:51 INFO Executor: Running task 1.0 in stage 8.0 (TID 10)
25/12/15 18:45:51 INFO Executor: Running task 0.0 in stage 8.0 (TID 9)
25/12/15 18:45:51 INFO CodeGenerator: Code generated in 57.821556 ms
25/12/15 18:45:51 INFO CodeGenerator: Code generated in 9.790401 ms
25/12/15 18:45:51 INFO BlockManagerInfo: Removed broadcast_9_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 24.2 KiB, free: 413.8 MiB)
25/12/15 18:45:51 INFO CodeGenerator: Code generated in 7.40711 ms
25/12/15 18:45:51 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:51 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:52 INFO Executor: Finished task 1.0 in stage 8.0 (TID 10). 2841 bytes result sent to driver
25/12/15 18:45:52 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 10) in 1407 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:52 INFO Executor: Finished task 0.0 in stage 8.0 (TID 9). 2841 bytes result sent to driver
25/12/15 18:45:52 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 9) in 1543 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:52 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/12/15 18:45:52 INFO DAGScheduler: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0) finished in 1.558 s
25/12/15 18:45:52 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:52 INFO DAGScheduler: running: Set()
25/12/15 18:45:52 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:52 INFO DAGScheduler: failed: Set()
25/12/15 18:45:52 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:52 INFO CodeGenerator: Code generated in 4.377343 ms
25/12/15 18:45:52 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:52 INFO CodeGenerator: Code generated in 14.718912 ms
25/12/15 18:45:52 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:52 INFO DAGScheduler: Got job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:52 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:52 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/12/15 18:45:52 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:52 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:52 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 53.9 KiB, free 413.0 MiB)
25/12/15 18:45:52 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 412.9 MiB)
25/12/15 18:45:52 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 18:45:52 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:52 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:52 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/12/15 18:45:52 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 11) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:52 INFO Executor: Running task 0.0 in stage 10.0 (TID 11)
25/12/15 18:45:52 INFO CodeGenerator: Code generated in 4.17454 ms
25/12/15 18:45:52 INFO ShuffleBlockFetcherIterator: Getting 2 (1386.0 B) non-empty blocks including 2 (1386.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:52 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 18:45:52 INFO CodeGenerator: Code generated in 21.763863 ms
25/12/15 18:45:53 INFO Executor: Finished task 0.0 in stage 10.0 (TID 11). 5619 bytes result sent to driver
25/12/15 18:45:53 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 11) in 49 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:53 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.061 s
25/12/15 18:45:53 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/12/15 18:45:53 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:53 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/12/15 18:45:53 INFO DAGScheduler: Job 7 finished: showString at NativeMethodAccessorImpl.java:0, took 0.072470 s
25/12/15 18:45:53 INFO CodeGenerator: Code generated in 9.118701 ms
+----+------------+
|year|yearly_delay|
+----+------------+
|2003|32535792    |
|2004|73088325    |
|2005|76476224    |
|2006|87187039    |
|2007|100965732   |
|2008|86637993    |
|2009|66005819    |
|2010|63257498    |
|2011|61670561    |
|2012|56916692    |
+----+------------+
only showing top 10 rows

25/12/15 18:45:53 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:53 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:53 INFO CodeGenerator: Code generated in 34.525041 ms
25/12/15 18:45:53 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 199.5 KiB, free 412.7 MiB)
25/12/15 18:45:53 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.7 MiB)
25/12/15 18:45:53 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.7 MiB)
25/12/15 18:45:53 INFO SparkContext: Created broadcast 13 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:53 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:53 INFO DAGScheduler: Registering RDD 37 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/12/15 18:45:53 INFO DAGScheduler: Got map stage job 8 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:53 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:53 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:53 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:53 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:53 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 52.9 KiB, free 412.7 MiB)
25/12/15 18:45:53 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 22.2 KiB, free 412.6 MiB)
25/12/15 18:45:53 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 22.2 KiB, free: 413.7 MiB)
25/12/15 18:45:53 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:53 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:53 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
25/12/15 18:45:53 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 12) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:53 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 13) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:53 INFO Executor: Running task 1.0 in stage 11.0 (TID 13)
25/12/15 18:45:53 INFO Executor: Running task 0.0 in stage 11.0 (TID 12)
25/12/15 18:45:53 INFO CodeGenerator: Code generated in 33.720506 ms
25/12/15 18:45:53 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:53 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:53 INFO BlockManagerInfo: Removed broadcast_12_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 18:45:54 INFO Executor: Finished task 1.0 in stage 11.0 (TID 13). 2841 bytes result sent to driver
25/12/15 18:45:54 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 13) in 1313 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:54 INFO Executor: Finished task 0.0 in stage 11.0 (TID 12). 2841 bytes result sent to driver
25/12/15 18:45:54 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 12) in 1496 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:54 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
25/12/15 18:45:54 INFO DAGScheduler: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 1.507 s
25/12/15 18:45:54 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:54 INFO DAGScheduler: running: Set()
25/12/15 18:45:54 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:54 INFO DAGScheduler: failed: Set()
25/12/15 18:45:54 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:54 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:54 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:54 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:54 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:54 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
25/12/15 18:45:54 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:54 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:54 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 53.9 KiB, free 412.7 MiB)
25/12/15 18:45:54 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 412.6 MiB)
25/12/15 18:45:54 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 18:45:54 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:54 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:54 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
25/12/15 18:45:54 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:54 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
25/12/15 18:45:54 INFO ShuffleBlockFetcherIterator: Getting 2 (1584.0 B) non-empty blocks including 2 (1584.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:54 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/12/15 18:45:54 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5576 bytes result sent to driver
25/12/15 18:45:54 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 27 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:54 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
25/12/15 18:45:54 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.041 s
25/12/15 18:45:54 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:54 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
25/12/15 18:45:54 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.046717 s
+-----+-------------+
|month|monthly_delay|
+-----+-------------+
|1    |110991145    |
|2    |103189056    |
|3    |109732780    |
|4    |99452911     |
|5    |108496590    |
|6    |142912106    |
|7    |147857638    |
|8    |128591297    |
|9    |78557928     |
|10   |89932256     |
+-----+-------------+
only showing top 10 rows

25/12/15 18:45:54 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:45:54 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:45:55 INFO CodeGenerator: Code generated in 47.431214 ms
25/12/15 18:45:55 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 199.5 KiB, free 412.4 MiB)
25/12/15 18:45:55 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.4 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 34.3 KiB, free: 413.6 MiB)
25/12/15 18:45:55 INFO SparkContext: Created broadcast 16 from showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:55 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:45:55 INFO DAGScheduler: Registering RDD 45 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 4
25/12/15 18:45:55 INFO DAGScheduler: Got map stage job 10 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:45:55 INFO DAGScheduler: Final stage: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:55 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:45:55 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:55 INFO DAGScheduler: Submitting ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:55 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 50.2 KiB, free 412.4 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_15_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 18:45:55 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 412.4 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 21.4 KiB, free: 413.6 MiB)
25/12/15 18:45:55 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:55 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:45:55 INFO TaskSchedulerImpl: Adding task set 14.0 with 2 tasks resource profile 0
25/12/15 18:45:55 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 15) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:55 INFO TaskSetManager: Starting task 1.0 in stage 14.0 (TID 16) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 18:45:55 INFO Executor: Running task 1.0 in stage 14.0 (TID 16)
25/12/15 18:45:55 INFO Executor: Running task 0.0 in stage 14.0 (TID 15)
25/12/15 18:45:55 INFO CodeGenerator: Code generated in 51.077766 ms
25/12/15 18:45:55 INFO CodeGenerator: Code generated in 9.120623 ms
25/12/15 18:45:55 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:45:55 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_11_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 22.2 KiB, free: 413.7 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_14_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 22.2 KiB, free: 413.7 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_13_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 34.3 KiB, free: 413.7 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_4_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_7_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_5_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 22.4 KiB, free: 413.8 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_8_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 23.0 KiB, free: 413.8 MiB)
25/12/15 18:45:55 INFO BlockManagerInfo: Removed broadcast_10_piece0 on ip-172-31-64-111.ec2.internal:43529 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 18:45:56 INFO Executor: Finished task 1.0 in stage 14.0 (TID 16). 2841 bytes result sent to driver
25/12/15 18:45:56 INFO TaskSetManager: Finished task 1.0 in stage 14.0 (TID 16) in 1537 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:45:56 INFO Executor: Finished task 0.0 in stage 14.0 (TID 15). 2841 bytes result sent to driver
25/12/15 18:45:56 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 15) in 1748 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:45:56 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
25/12/15 18:45:56 INFO DAGScheduler: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 1.769 s
25/12/15 18:45:56 INFO DAGScheduler: looking for newly runnable stages
25/12/15 18:45:56 INFO DAGScheduler: running: Set()
25/12/15 18:45:56 INFO DAGScheduler: waiting: Set()
25/12/15 18:45:56 INFO DAGScheduler: failed: Set()
25/12/15 18:45:56 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 18:45:56 INFO CodeGenerator: Code generated in 9.306991 ms
25/12/15 18:45:56 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 18:45:56 INFO CodeGenerator: Code generated in 16.26725 ms
25/12/15 18:45:56 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 18:45:56 INFO DAGScheduler: Got job 11 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:45:56 INFO DAGScheduler: Final stage: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 18:45:56 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 15)
25/12/15 18:45:56 INFO DAGScheduler: Missing parents: List()
25/12/15 18:45:56 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:45:56 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 50.5 KiB, free 413.6 MiB)
25/12/15 18:45:56 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 22.6 KiB, free 413.6 MiB)
25/12/15 18:45:56 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on ip-172-31-64-111.ec2.internal:43529 (size: 22.6 KiB, free: 413.8 MiB)
25/12/15 18:45:56 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/12/15 18:45:56 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:45:56 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
25/12/15 18:45:56 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 17) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 18:45:56 INFO Executor: Running task 0.0 in stage 16.0 (TID 17)
25/12/15 18:45:56 INFO CodeGenerator: Code generated in 5.214037 ms
25/12/15 18:45:56 INFO ShuffleBlockFetcherIterator: Getting 2 (4.4 KiB) non-empty blocks including 2 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 18:45:56 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/12/15 18:45:56 INFO CodeGenerator: Code generated in 10.753607 ms
25/12/15 18:45:56 INFO Executor: Finished task 0.0 in stage 16.0 (TID 17). 5899 bytes result sent to driver
25/12/15 18:45:56 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 17) in 44 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:45:56 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/12/15 18:45:56 INFO DAGScheduler: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.055 s
25/12/15 18:45:56 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:45:56 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
25/12/15 18:45:56 INFO DAGScheduler: Job 11 finished: showString at NativeMethodAccessorImpl.java:0, took 0.061078 s
25/12/15 18:45:56 INFO CodeGenerator: Code generated in 10.307452 ms
25/12/15 18:45:56 INFO SparkContext: SparkContext is stopping with exitCode 0.
+----------------------------+-------+
|carrier_name                |records|
+----------------------------+-------+
|SkyWest Airlines Inc.       |38038  |
|Delta Air Lines Inc.        |27518  |
|ExpressJet Airlines Inc.    |24487  |
|American Airlines Inc.      |19770  |
|United Air Lines Inc.       |19096  |
|Southwest Airlines Co.      |17576  |
|American Eagle Airlines Inc.|15399  |
|Mesa Airlines Inc.          |14483  |
|Alaska Airlines Inc.        |12933  |
|Frontier Airlines Inc.      |12275  |
+----------------------------+-------+
only showing top 10 rows

25/12/15 18:45:57 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 18:45:57 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 18:45:57 INFO MemoryStore: MemoryStore cleared
25/12/15 18:45:57 INFO BlockManager: BlockManager stopped
25/12/15 18:45:57 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 18:45:57 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 18:45:57 INFO SparkContext: Successfully stopped SparkContext
25/12/15 18:45:57 INFO ShutdownHookManager: Shutdown hook called
25/12/15 18:45:57 INFO ShutdownHookManager: Deleting directory /tmp/spark-d7cf5a66-b4a2-4a43-91ab-8b823c9b2a1e/pyspark-85b00712-fb06-4bc4-b6ea-48af3d7b8d48
25/12/15 18:45:57 INFO ShutdownHookManager: Deleting directory /tmp/spark-fe18efa9-5747-4875-9c69-3134c7879d75
25/12/15 18:45:57 INFO ShutdownHookManager: Deleting directory /tmp/spark-d7cf5a66-b4a2-4a43-91ab-8b823c9b2a1e
[5/5] Saving processed data to S3...
25/12/15 18:46:00 INFO SparkContext: Running Spark version 3.5.1
25/12/15 18:46:00 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:46:00 INFO SparkContext: Java version 17.0.17
25/12/15 18:46:01 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 18:46:01 INFO ResourceUtils: ==============================================================
25/12/15 18:46:01 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 18:46:01 INFO ResourceUtils: ==============================================================
25/12/15 18:46:01 INFO SparkContext: Submitted application: Save Airline Data
25/12/15 18:46:01 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 18:46:01 INFO ResourceProfile: Limiting resource is cpu
25/12/15 18:46:01 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 18:46:01 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 18:46:01 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 18:46:01 INFO SecurityManager: Changing view acls groups to: 
25/12/15 18:46:01 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 18:46:01 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 18:46:01 INFO Utils: Successfully started service 'sparkDriver' on port 38503.
25/12/15 18:46:01 INFO SparkEnv: Registering MapOutputTracker
25/12/15 18:46:01 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 18:46:01 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 18:46:01 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 18:46:01 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 18:46:01 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-096fba1c-51cc-4e09-96e9-59b0bec61bfe
25/12/15 18:46:01 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 18:46:01 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 18:46:01 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 18:46:02 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 18:46:02 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 18:46:02 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 18:46:02 INFO Executor: Java version 17.0.17
25/12/15 18:46:02 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 18:46:02 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 18:46:02 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45007.
25/12/15 18:46:02 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:45007
25/12/15 18:46:02 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 18:46:02 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45007, None)
25/12/15 18:46:02 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:45007 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45007, None)
25/12/15 18:46:02 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45007, None)
25/12/15 18:46:02 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45007, None)
25/12/15 18:46:02 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 18:46:02 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 18:46:04 INFO InMemoryFileIndex: It took 64 ms to list leaf files for 1 paths.
25/12/15 18:46:04 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/15 18:46:06 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:46:06 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 18:46:07 INFO CodeGenerator: Code generated in 295.605955 ms
25/12/15 18:46:07 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 18:46:07 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/15 18:46:07 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 18:46:07 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:46:07 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:46:07 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:46:07 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 18:46:07 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:46:07 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:46:07 INFO DAGScheduler: Missing parents: List()
25/12/15 18:46:07 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:46:08 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 18:46:08 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 18:46:08 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 18:46:08 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 18:46:08 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 18:46:08 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 18:46:08 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:08 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 18:46:08 INFO CodeGenerator: Code generated in 20.254464 ms
25/12/15 18:46:08 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:46:08 INFO CodeGenerator: Code generated in 16.533365 ms
25/12/15 18:46:08 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 18:46:08 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 250 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 18:46:08 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 18:46:08 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.434 s
25/12/15 18:46:08 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:46:08 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 18:46:08 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.511566 s
25/12/15 18:46:08 INFO CodeGenerator: Code generated in 16.330877 ms
25/12/15 18:46:08 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:46:08 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 18:46:08 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 18:46:08 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/15 18:46:08 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 18:46:08 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:46:08 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:46:08 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:46:08 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:46:08 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:46:08 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:46:08 INFO DAGScheduler: Missing parents: List()
25/12/15 18:46:08 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:46:08 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 18:46:08 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 18:46:08 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 18:46:08 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 18:46:08 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:46:08 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 18:46:08 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:08 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:08 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 18:46:08 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 18:46:08 INFO CodeGenerator: Code generated in 19.790956 ms
25/12/15 18:46:08 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:46:08 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:46:11 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 18:46:11 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2645 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:46:11 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 18:46:11 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2748 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:46:11 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 18:46:11 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.798 s
25/12/15 18:46:11 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:46:11 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 18:46:11 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.811787 s
25/12/15 18:46:11 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:46:11 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:46:11 INFO ParquetUtils: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:11 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:11 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:11 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:11 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:11 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:11 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:12 INFO CodeGenerator: Code generated in 87.77617 ms
25/12/15 18:46:12 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 18:46:12 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 18:46:12 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:46:12 INFO SparkContext: Created broadcast 4 from parquet at NativeMethodAccessorImpl.java:0
25/12/15 18:46:12 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:46:12 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
25/12/15 18:46:12 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:46:12 INFO DAGScheduler: Final stage: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0)
25/12/15 18:46:12 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:46:12 INFO DAGScheduler: Missing parents: List()
25/12/15 18:46:12 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:46:12 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 231.5 KiB, free 413.0 MiB)
25/12/15 18:46:12 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 81.6 KiB, free 412.9 MiB)
25/12/15 18:46:12 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 81.6 KiB, free: 413.7 MiB)
25/12/15 18:46:12 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 18:46:12 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 2 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:46:12 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 18:46:12 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:12 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:12 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 18:46:12 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 18:46:12 INFO CodeGenerator: Code generated in 87.590047 ms
25/12/15 18:46:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:12 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:12 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:12 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:12 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:12 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:12 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:12 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:46:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:12 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:12 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 18:46:12 INFO CodecConfig: Compression: SNAPPY
25/12/15 18:46:12 INFO CodecConfig: Compression: SNAPPY
25/12/15 18:46:12 INFO ParquetOutputFormat: ParquetRecordWriter [block size: 134217728b, row group padding size: 8388608b, validating: false]
25/12/15 18:46:12 INFO CodeGenerator: Code generated in 55.199707 ms
25/12/15 18:46:12 INFO CodecConfig: Compression: SNAPPY
25/12/15 18:46:12 INFO CodecConfig: Compression: SNAPPY
25/12/15 18:46:12 INFO ParquetOutputFormat: ParquetRecordWriter [block size: 134217728b, row group padding size: 8388608b, validating: false]
25/12/15 18:46:12 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "year",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "month",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_flights",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_del15",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_cancelled",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_diverted",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_minutes",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_count",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional int32 year;
  optional int32 month;
  optional binary carrier (STRING);
  optional binary carrier_name (STRING);
  optional binary airport (STRING);
  optional binary airport_name (STRING);
  optional int32 arr_flights;
  optional int32 arr_del15;
  optional double carrier_ct;
  optional double weather_ct;
  optional double nas_ct;
  optional double security_ct;
  optional double late_aircraft_ct;
  optional int32 arr_cancelled;
  optional int32 arr_diverted;
  optional int32 arr_delay;
  optional int32 carrier_delay;
  optional int32 weather_delay;
  optional int32 nas_delay;
  optional int32 security_delay;
  optional int32 late_aircraft_delay;
  optional int32 total_delay_minutes;
  optional double total_delay_count;
}

       
25/12/15 18:46:12 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "year",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "month",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_flights",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_del15",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_cancelled",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_diverted",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_minutes",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_count",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional int32 year;
  optional int32 month;
  optional binary carrier (STRING);
  optional binary carrier_name (STRING);
  optional binary airport (STRING);
  optional binary airport_name (STRING);
  optional int32 arr_flights;
  optional int32 arr_del15;
  optional double carrier_ct;
  optional double weather_ct;
  optional double nas_ct;
  optional double security_ct;
  optional double late_aircraft_ct;
  optional int32 arr_cancelled;
  optional int32 arr_diverted;
  optional int32 arr_delay;
  optional int32 carrier_delay;
  optional int32 weather_delay;
  optional int32 nas_delay;
  optional int32 security_delay;
  optional int32 late_aircraft_delay;
  optional int32 total_delay_minutes;
  optional double total_delay_count;
}

       
25/12/15 18:46:12 INFO CodecPool: Got brand-new compressor [.snappy]
25/12/15 18:46:12 INFO CodecPool: Got brand-new compressor [.snappy]
25/12/15 18:46:12 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:46:13 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:45007 in memory (size: 12.8 KiB, free: 413.7 MiB)
25/12/15 18:46:14 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:45007 in memory (size: 6.4 KiB, free: 413.7 MiB)
25/12/15 18:46:14 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:45007 in memory (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 18:46:14 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:45007 in memory (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 18:46:17 INFO FileOutputCommitter: Saved output of task 'attempt_202512151846124461036607821632520_0002_m_000000_3' to file:/home/ubuntu/airline_project/output/airline_processed_parquet/_temporary/0/task_202512151846124461036607821632520_0002_m_000000
25/12/15 18:46:17 INFO FileOutputCommitter: Saved output of task 'attempt_202512151846124461036607821632520_0002_m_000001_4' to file:/home/ubuntu/airline_project/output/airline_processed_parquet/_temporary/0/task_202512151846124461036607821632520_0002_m_000001
25/12/15 18:46:17 INFO SparkHadoopMapRedUtil: attempt_202512151846124461036607821632520_0002_m_000001_4: Committed. Elapsed time: 1 ms.
25/12/15 18:46:17 INFO SparkHadoopMapRedUtil: attempt_202512151846124461036607821632520_0002_m_000000_3: Committed. Elapsed time: 2 ms.
25/12/15 18:46:17 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2669 bytes result sent to driver
25/12/15 18:46:17 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2669 bytes result sent to driver
25/12/15 18:46:17 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 5157 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:46:17 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 5158 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:46:17 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 18:46:17 INFO DAGScheduler: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0) finished in 5.244 s
25/12/15 18:46:17 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:46:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
25/12/15 18:46:17 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 5.258036 s
25/12/15 18:46:17 INFO FileFormatWriter: Start to commit write Job 2067ea50-c9ef-40db-a40a-46ca80fdaf69.
25/12/15 18:46:17 INFO FileFormatWriter: Write Job 2067ea50-c9ef-40db-a40a-46ca80fdaf69 committed. Elapsed time: 19 ms.
25/12/15 18:46:17 INFO FileFormatWriter: Finished processing stats for write job 2067ea50-c9ef-40db-a40a-46ca80fdaf69.
25/12/15 18:46:17 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 18:46:17 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 18:46:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:17 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/15 18:46:17 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 18:46:17 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 18:46:17 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 18:46:17 INFO SparkContext: Created broadcast 6 from csv at NativeMethodAccessorImpl.java:0
25/12/15 18:46:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 18:46:17 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 18:46:17 INFO DAGScheduler: Got job 3 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 18:46:17 INFO DAGScheduler: Final stage: ResultStage 3 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 18:46:17 INFO DAGScheduler: Parents of final stage: List()
25/12/15 18:46:17 INFO DAGScheduler: Missing parents: List()
25/12/15 18:46:17 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[17] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 18:46:17 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 229.3 KiB, free 412.9 MiB)
25/12/15 18:46:17 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 80.6 KiB, free 412.9 MiB)
25/12/15 18:46:17 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:45007 (size: 80.6 KiB, free: 413.7 MiB)
25/12/15 18:46:17 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1585
25/12/15 18:46:17 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 3 (MapPartitionsRDD[17] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 18:46:17 INFO TaskSchedulerImpl: Adding task set 3.0 with 2 tasks resource profile 0
25/12/15 18:46:17 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:17 INFO TaskSetManager: Starting task 1.0 in stage 3.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 18:46:17 INFO Executor: Running task 1.0 in stage 3.0 (TID 6)
25/12/15 18:46:17 INFO Executor: Running task 0.0 in stage 3.0 (TID 5)
25/12/15 18:46:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:17 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/15 18:46:17 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 18:46:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 18:46:17 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 18:46:17 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/15 18:46:17 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 18:46:19 INFO FileOutputCommitter: Saved output of task 'attempt_202512151846171626327359064578354_0003_m_000001_6' to file:/home/ubuntu/airline_project/output/airline_processed_csv/_temporary/0/task_202512151846171626327359064578354_0003_m_000001
25/12/15 18:46:19 INFO SparkHadoopMapRedUtil: attempt_202512151846171626327359064578354_0003_m_000001_6: Committed. Elapsed time: 3 ms.
25/12/15 18:46:19 INFO Executor: Finished task 1.0 in stage 3.0 (TID 6). 2626 bytes result sent to driver
25/12/15 18:46:19 INFO TaskSetManager: Finished task 1.0 in stage 3.0 (TID 6) in 1760 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 18:46:19 INFO FileOutputCommitter: Saved output of task 'attempt_202512151846171626327359064578354_0003_m_000000_5' to file:/home/ubuntu/airline_project/output/airline_processed_csv/_temporary/0/task_202512151846171626327359064578354_0003_m_000000
25/12/15 18:46:19 INFO SparkHadoopMapRedUtil: attempt_202512151846171626327359064578354_0003_m_000000_5: Committed. Elapsed time: 1 ms.
25/12/15 18:46:19 INFO Executor: Finished task 0.0 in stage 3.0 (TID 5). 2626 bytes result sent to driver
25/12/15 18:46:19 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 5) in 2102 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 18:46:19 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
25/12/15 18:46:19 INFO DAGScheduler: ResultStage 3 (csv at NativeMethodAccessorImpl.java:0) finished in 2.132 s
25/12/15 18:46:19 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 18:46:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
25/12/15 18:46:19 INFO DAGScheduler: Job 3 finished: csv at NativeMethodAccessorImpl.java:0, took 2.142009 s
25/12/15 18:46:19 INFO FileFormatWriter: Start to commit write Job 999c6511-8469-4ff6-b254-f5c92f8b954d.
25/12/15 18:46:19 INFO FileFormatWriter: Write Job 999c6511-8469-4ff6-b254-f5c92f8b954d committed. Elapsed time: 19 ms.
25/12/15 18:46:19 INFO FileFormatWriter: Finished processing stats for write job 999c6511-8469-4ff6-b254-f5c92f8b954d.
25/12/15 18:46:19 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 18:46:19 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 18:46:19 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 18:46:19 INFO MemoryStore: MemoryStore cleared
25/12/15 18:46:19 INFO BlockManager: BlockManager stopped
25/12/15 18:46:19 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 18:46:19 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 18:46:19 INFO SparkContext: Successfully stopped SparkContext
25/12/15 18:46:20 INFO ShutdownHookManager: Shutdown hook called
25/12/15 18:46:20 INFO ShutdownHookManager: Deleting directory /tmp/spark-e4f2f9c5-c860-4c77-a210-8fa8f94bb0af
25/12/15 18:46:20 INFO ShutdownHookManager: Deleting directory /tmp/spark-e4f2f9c5-c860-4c77-a210-8fa8f94bb0af/pyspark-2f126f86-fb0f-4d0e-adb3-779bade71198
25/12/15 18:46:20 INFO ShutdownHookManager: Deleting directory /tmp/spark-24333334-42e8-491c-b866-06aa322a43ec
Uploading logs to S3...
Completed 200.7 KiB/200.7 KiB (1.5 MiB/s) with 1 file(s) remainingupload: ../pipeline/logs/pipeline_2025-12-15_18-44-32.log to s3://rg422-bigdata/processed/analytics/logs/pipeline_2025-12-15_18-44-32.log
{
    "MessageId": "56615e19-0672-51a3-856f-3fa35fb24608"
}
==========================================
âœ… Pipeline completed successfully
==========================================
