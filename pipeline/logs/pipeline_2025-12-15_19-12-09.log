==========================================
ðŸš€ Pipeline started at Mon Dec 15 19:12:09 UTC 2025
==========================================
[1/5] Ingesting raw data...
25/12/15 19:12:13 INFO SparkContext: Running Spark version 3.5.1
25/12/15 19:12:13 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:12:13 INFO SparkContext: Java version 17.0.17
25/12/15 19:12:13 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 19:12:13 INFO ResourceUtils: ==============================================================
25/12/15 19:12:13 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 19:12:13 INFO ResourceUtils: ==============================================================
25/12/15 19:12:13 INFO SparkContext: Submitted application: Airline Delay Analysis
25/12/15 19:12:13 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 19:12:13 INFO ResourceProfile: Limiting resource is cpu
25/12/15 19:12:13 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 19:12:14 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 19:12:14 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 19:12:14 INFO SecurityManager: Changing view acls groups to: 
25/12/15 19:12:14 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 19:12:14 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 19:12:14 INFO Utils: Successfully started service 'sparkDriver' on port 39577.
25/12/15 19:12:14 INFO SparkEnv: Registering MapOutputTracker
25/12/15 19:12:14 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 19:12:14 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 19:12:14 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 19:12:14 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 19:12:14 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-0066ff06-015e-4879-aa6f-0a0a4130a591
25/12/15 19:12:14 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 19:12:14 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 19:12:14 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 19:12:15 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 19:12:15 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 19:12:15 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:12:15 INFO Executor: Java version 17.0.17
25/12/15 19:12:15 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 19:12:15 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 19:12:15 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45979.
25/12/15 19:12:15 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:45979
25/12/15 19:12:15 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 19:12:15 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45979, None)
25/12/15 19:12:15 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:45979 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45979, None)
25/12/15 19:12:15 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45979, None)
25/12/15 19:12:15 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 45979, None)
25/12/15 19:12:16 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 19:12:16 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 19:12:17 INFO InMemoryFileIndex: It took 72 ms to list leaf files for 1 paths.
25/12/15 19:12:17 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/15 19:12:20 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:20 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 19:12:21 INFO CodeGenerator: Code generated in 221.058499 ms
25/12/15 19:12:21 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 19:12:21 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/15 19:12:21 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 19:12:21 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:21 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:21 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:21 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:21 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:21 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:21 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:21 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 19:12:21 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 19:12:21 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 19:12:21 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:21 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 19:12:21 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:21 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 19:12:21 INFO CodeGenerator: Code generated in 32.45152 ms
25/12/15 19:12:21 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:21 INFO CodeGenerator: Code generated in 23.622698 ms
25/12/15 19:12:21 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 19:12:22 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 329 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:22 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 19:12:22 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.513 s
25/12/15 19:12:22 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 19:12:22 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.593619 s
25/12/15 19:12:22 INFO CodeGenerator: Code generated in 16.764279 ms
25/12/15 19:12:22 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:22 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:12:22 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 19:12:22 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/15 19:12:22 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 19:12:22 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:22 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:22 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:12:22 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:22 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:22 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:22 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:22 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 19:12:22 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 19:12:22 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:12:22 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:22 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:12:22 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 19:12:22 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:22 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:22 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 19:12:22 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 19:12:22 INFO CodeGenerator: Code generated in 20.430743 ms
25/12/15 19:12:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:12:24 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 19:12:24 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1868 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:12:24 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 19:12:24 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2044 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:12:24 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 19:12:24 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.109 s
25/12/15 19:12:24 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 19:12:24 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.122187 s
25/12/15 19:12:24 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:24 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:12:24 INFO CodeGenerator: Code generated in 14.884724 ms
25/12/15 19:12:24 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 19:12:24 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.2 MiB)
25/12/15 19:12:24 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 19:12:24 INFO SparkContext: Created broadcast 4 from count at NativeMethodAccessorImpl.java:0
25/12/15 19:12:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:24 INFO DAGScheduler: Registering RDD 13 (count at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/15 19:12:24 INFO DAGScheduler: Got map stage job 2 (count at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:12:24 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:24 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:24 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:24 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:24 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 18.6 KiB, free 413.2 MiB)
25/12/15 19:12:24 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 9.1 KiB, free 413.2 MiB)
25/12/15 19:12:24 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 9.1 KiB, free: 413.8 MiB)
25/12/15 19:12:24 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:24 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:12:24 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 19:12:24 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:12:24 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:12:24 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 19:12:24 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 19:12:24 INFO CodeGenerator: Code generated in 24.224929 ms
25/12/15 19:12:24 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:12:24 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:24 INFO CodeGenerator: Code generated in 17.463734 ms
25/12/15 19:12:25 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2031 bytes result sent to driver
25/12/15 19:12:25 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 1988 bytes result sent to driver
25/12/15 19:12:25 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 475 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:12:25 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 476 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:12:25 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 19:12:25 INFO DAGScheduler: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0) finished in 0.509 s
25/12/15 19:12:25 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:12:25 INFO DAGScheduler: running: Set()
25/12/15 19:12:25 INFO DAGScheduler: waiting: Set()
25/12/15 19:12:25 INFO DAGScheduler: failed: Set()
25/12/15 19:12:25 INFO CodeGenerator: Code generated in 13.455254 ms
25/12/15 19:12:25 INFO SparkContext: Starting job: count at NativeMethodAccessorImpl.java:0
25/12/15 19:12:25 INFO DAGScheduler: Got job 3 (count at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:25 INFO DAGScheduler: Final stage: ResultStage 4 (count at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:25 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/15 19:12:25 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:25 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:25 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 12.5 KiB, free 413.1 MiB)
25/12/15 19:12:25 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 413.1 MiB)
25/12/15 19:12:25 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 5.9 KiB, free: 413.8 MiB)
25/12/15 19:12:25 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:25 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/15 19:12:25 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:12:25 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/15 19:12:25 INFO ShuffleBlockFetcherIterator: Getting 2 (120.0 B) non-empty blocks including 2 (120.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:12:25 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 20 ms
25/12/15 19:12:25 INFO CodeGenerator: Code generated in 12.428348 ms
25/12/15 19:12:25 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 3995 bytes result sent to driver
25/12/15 19:12:25 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 116 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:25 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/15 19:12:25 INFO DAGScheduler: ResultStage 4 (count at NativeMethodAccessorImpl.java:0) finished in 0.135 s
25/12/15 19:12:25 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:25 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/15 19:12:25 INFO DAGScheduler: Job 3 finished: count at NativeMethodAccessorImpl.java:0, took 0.162509 s
Number of rows: 318017
Schema:
root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- carrier_name: string (nullable = true)
 |-- airport: string (nullable = true)
 |-- airport_name: string (nullable = true)
 |-- arr_flights: integer (nullable = true)
 |-- arr_del15: integer (nullable = true)
 |-- carrier_ct: double (nullable = true)
 |-- weather_ct: double (nullable = true)
 |-- nas_ct: double (nullable = true)
 |-- security_ct: double (nullable = true)
 |-- late_aircraft_ct: double (nullable = true)
 |-- arr_cancelled: integer (nullable = true)
 |-- arr_diverted: integer (nullable = true)
 |-- arr_delay: integer (nullable = true)
 |-- carrier_delay: integer (nullable = true)
 |-- weather_delay: integer (nullable = true)
 |-- nas_delay: integer (nullable = true)
 |-- security_delay: integer (nullable = true)
 |-- late_aircraft_delay: integer (nullable = true)

25/12/15 19:12:25 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:25 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:12:25 INFO CodeGenerator: Code generated in 57.674825 ms
25/12/15 19:12:25 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 412.9 MiB)
25/12/15 19:12:25 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 412.9 MiB)
25/12/15 19:12:25 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 19:12:25 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:25 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:25 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:45979 in memory (size: 5.9 KiB, free: 413.8 MiB)
25/12/15 19:12:25 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:25 INFO DAGScheduler: Got job 4 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:25 INFO DAGScheduler: Final stage: ResultStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:25 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:25 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:25 INFO DAGScheduler: Submitting ResultStage 5 (MapPartitionsRDD[20] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:25 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 25.1 KiB, free 412.9 MiB)
25/12/15 19:12:25 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 9.6 KiB, free 412.9 MiB)
25/12/15 19:12:25 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:45979 (size: 9.6 KiB, free: 413.8 MiB)
25/12/15 19:12:25 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 5 (MapPartitionsRDD[20] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:25 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
25/12/15 19:12:25 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:25 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/15 19:12:25 INFO CodeGenerator: Code generated in 41.600109 ms
25/12/15 19:12:25 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:25 INFO CodeGenerator: Code generated in 52.144979 ms
25/12/15 19:12:25 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 3559 bytes result sent to driver
25/12/15 19:12:25 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 153 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:25 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/15 19:12:25 INFO DAGScheduler: ResultStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 0.169 s
25/12/15 19:12:25 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:25 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
25/12/15 19:12:25 INFO DAGScheduler: Job 4 finished: showString at NativeMethodAccessorImpl.java:0, took 0.177292 s
25/12/15 19:12:26 INFO BlockManagerInfo: Removed broadcast_8_piece0 on ip-172-31-64-111.ec2.internal:45979 in memory (size: 9.6 KiB, free: 413.8 MiB)
25/12/15 19:12:26 INFO CodeGenerator: Code generated in 58.557866 ms
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
|year|month|carrier|carrier_name     |airport|airport_name                                               |arr_flights|arr_del15|carrier_ct|weather_ct|nas_ct|security_ct|late_aircraft_ct|arr_cancelled|arr_diverted|arr_delay|carrier_delay|weather_delay|nas_delay|security_delay|late_aircraft_delay|
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
|2022|5    |9E     |Endeavor Air Inc.|ABE    |Allentown/Bethlehem/Easton, PA: Lehigh Valley International|136        |7        |5.95      |0.0       |0.05  |0.0        |1.0             |0            |0           |255      |222          |0            |4        |0             |29                 |
|2022|5    |9E     |Endeavor Air Inc.|ABY    |Albany, GA: Southwest Georgia Regional                     |91         |16       |7.38      |0.0       |2.54  |0.0        |6.09            |0            |0           |884      |351          |0            |81       |0             |452                |
|2022|5    |9E     |Endeavor Air Inc.|ACK    |Nantucket, MA: Nantucket Memorial                          |19         |2        |0.13      |0.0       |1.0   |0.0        |0.88            |1            |0           |138      |4            |0            |106      |0             |28                 |
|2022|5    |9E     |Endeavor Air Inc.|AEX    |Alexandria, LA: Alexandria International                   |88         |14       |7.26      |0.76      |4.35  |0.0        |1.64            |0            |0           |947      |585          |35           |125      |0    25/12/15 19:12:26 INFO SparkContext: SparkContext is stopping with exitCode 0.
         |202                |
|2022|5    |9E     |Endeavor Air Inc.|AGS    |Augusta, GA: Augusta Regional at Bush Field                |181        |19       |13.84     |0.0       |3.07  |0.0        |2.09            |0            |0           |808      |662          |0            |87       |0             |59                 |
|2022|5    |9E     |Endeavor Air Inc.|ALB    |Albany, NY: Albany International                           |134        |18       |4.42      |1.0       |6.48  |0.0        |6.09            |5            |0           |917      |224          |78           |398      |0             |217                |
|2022|5    |9E     |Endeavor Air Inc.|ATL    |Atlanta, GA: Hartsfield-Jackson Atlanta International      |3042       |453      |142.96    |13.53     |106.98|0.0        |189.53          |2            |3           |38397    |20775        |1205         |3610     |0             |12807              |
|2022|5    |9E     |Endeavor Air Inc.|ATW    |Appleton, WI: Appleton International                       |118        |13       |4.83      |0.0       |6.85  |0.0        |1.32            |0            |0           |914      |578          |0            |171      |0             |165                |
|2022|5    |9E     |Endeavor Air Inc.|AUS    |Austin, TX: Austin - Bergstrom International               |53         |8        |5.23      |1.0       |0.89  |0.0        |0.88            |1            |0           |582      |445          |20           |19       |0             |98                 |
|2022|5    |9E     |Endeavor Air Inc.|AVL    |Asheville, NC: Asheville Regional                          |58         |14       |4.54      |0.0       |7.61  |0.0        |1.85            |1            |0           |996      |290          |0            |618      |0             |88                 |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
only showing top 10 rows

25/12/15 19:12:26 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 19:12:26 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 19:12:26 INFO MemoryStore: MemoryStore cleared
25/12/15 19:12:26 INFO BlockManager: BlockManager stopped
25/12/15 19:12:26 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 19:12:26 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 19:12:26 INFO SparkContext: Successfully stopped SparkContext
25/12/15 19:12:26 INFO ShutdownHookManager: Shutdown hook called
25/12/15 19:12:26 INFO ShutdownHookManager: Deleting directory /tmp/spark-d4acd5a3-5a1b-462a-8c94-3eee406e7be9
25/12/15 19:12:26 INFO ShutdownHookManager: Deleting directory /tmp/spark-d4acd5a3-5a1b-462a-8c94-3eee406e7be9/pyspark-77caef32-6ef0-41f3-b007-727f18dc2585
25/12/15 19:12:26 INFO ShutdownHookManager: Deleting directory /tmp/spark-08f8817f-027f-41e3-93c8-2d0bff07a7a1
[2/5] Transforming data...
25/12/15 19:12:29 INFO SparkContext: Running Spark version 3.5.1
25/12/15 19:12:29 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:12:29 INFO SparkContext: Java version 17.0.17
25/12/15 19:12:29 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 19:12:29 INFO ResourceUtils: ==============================================================
25/12/15 19:12:29 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 19:12:29 INFO ResourceUtils: ==============================================================
25/12/15 19:12:29 INFO SparkContext: Submitted application: Airline Transform
25/12/15 19:12:29 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 19:12:29 INFO ResourceProfile: Limiting resource is cpu
25/12/15 19:12:29 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 19:12:29 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 19:12:29 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 19:12:29 INFO SecurityManager: Changing view acls groups to: 
25/12/15 19:12:29 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 19:12:29 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 19:12:30 INFO Utils: Successfully started service 'sparkDriver' on port 40001.
25/12/15 19:12:30 INFO SparkEnv: Registering MapOutputTracker
25/12/15 19:12:30 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 19:12:30 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 19:12:30 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 19:12:30 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 19:12:30 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-ac7b3524-d3aa-4f12-9932-2695d231415f
25/12/15 19:12:30 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 19:12:30 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 19:12:30 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 19:12:30 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 19:12:30 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 19:12:30 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:12:30 INFO Executor: Java version 17.0.17
25/12/15 19:12:30 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 19:12:30 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 19:12:30 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 43863.
25/12/15 19:12:30 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:43863
25/12/15 19:12:30 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 19:12:30 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43863, None)
25/12/15 19:12:30 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:43863 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43863, None)
25/12/15 19:12:30 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43863, None)
25/12/15 19:12:30 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 43863, None)
25/12/15 19:12:31 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 19:12:31 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 19:12:32 INFO InMemoryFileIndex: It took 43 ms to list leaf files for 1 paths.
25/12/15 19:12:32 INFO InMemoryFileIndex: It took 5 ms to list leaf files for 1 paths.
25/12/15 19:12:35 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:35 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 19:12:35 INFO CodeGenerator: Code generated in 293.62064 ms
25/12/15 19:12:35 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 19:12:35 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/15 19:12:35 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:43863 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 19:12:35 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:35 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:36 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:36 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:36 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:36 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:36 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:36 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:36 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 19:12:36 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 19:12:36 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:43863 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 19:12:36 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:36 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:36 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 19:12:36 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:36 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 19:12:36 INFO CodeGenerator: Code generated in 18.43862 ms
25/12/15 19:12:36 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:36 INFO CodeGenerator: Code generated in 23.165634 ms
25/12/15 19:12:36 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 19:12:36 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 323 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:36 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 19:12:36 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.481 s
25/12/15 19:12:36 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:36 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 19:12:36 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.548173 s
25/12/15 19:12:36 INFO CodeGenerator: Code generated in 22.544033 ms
25/12/15 19:12:36 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:36 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:12:36 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 19:12:36 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/15 19:12:36 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:43863 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 19:12:36 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:36 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:37 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:37 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:12:37 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:37 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:37 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:37 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:37 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 19:12:37 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 19:12:37 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:43863 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:12:37 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:37 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:12:37 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 19:12:37 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:37 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:37 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 19:12:37 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 19:12:37 INFO CodeGenerator: Code generated in 20.157121 ms
25/12/15 19:12:37 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:12:37 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:39 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 19:12:39 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2588 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:12:39 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 19:12:39 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2808 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:12:39 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 19:12:39 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.868 s
25/12/15 19:12:39 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:39 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 19:12:39 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.882922 s
root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- carrier_name: string (nullable = true)
 |-- airport: string (nullable = true)
 |-- airport_name: string (nullable = true)
 |-- arr_flights: integer (nullable = true)
 |-- arr_del15: integer (nullable = true)
 |-- carrier_ct: double (nullable = true)
 |-- weather_ct: double (nullable = true)
 |-- nas_ct: double (nullable = true)
 |-- security_ct: double (nullable = true)
 |-- late_aircraft_ct: double (nullable = true)
 |-- arr_cancelled: integer (nullable = true)
 |-- arr_diverted: integer (nullable = true)
 |-- arr_delay: integer (nullable = true)
 |-- carrier_delay: integer (nullable = true)
 |-- weather_delay: integer (nullable = true)
 |-- nas_delay: integer (nullable = true)
 |-- security_delay: integer (nullable = true)
 |-- late_aircraft_delay: integer (nullable = true)
 |-- total_delay_minutes: integer (nullable = true)
 |-- total_delay_count: double (nullable = true)

25/12/15 19:12:40 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:40 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:12:40 INFO CodeGenerator: Code generated in 131.53488 ms
25/12/15 19:12:40 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 19:12:40 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 19:12:40 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:43863 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:12:40 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:40 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:40 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:40 INFO DAGScheduler: Got job 2 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:40 INFO DAGScheduler: Final stage: ResultStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:40 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:40 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:40 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:40 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 30.4 KiB, free 413.2 MiB)
25/12/15 19:12:40 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 10.5 KiB, free 413.1 MiB)
25/12/15 19:12:40 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:43863 (size: 10.5 KiB, free: 413.8 MiB)
25/12/15 19:12:40 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:40 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:40 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks resource profile 0
25/12/15 19:12:40 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:40 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 19:12:40 INFO CodeGenerator: Code generated in 94.233288 ms
25/12/15 19:12:40 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:40 INFO CodeGenerator: Code generated in 49.291907 ms
25/12/15 19:12:40 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 3854 bytes result sent to driver
25/12/15 19:12:40 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 256 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:40 INFO DAGScheduler: ResultStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 0.271 s
25/12/15 19:12:40 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:40 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 19:12:40 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
25/12/15 19:12:40 INFO DAGScheduler: Job 2 finished: showString at NativeMethodAccessorImpl.java:0, took 0.278464 s
25/12/15 19:12:40 INFO CodeGenerator: Code generated in 37.943665 ms
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
|year|month|carrier|carrier_name     |airport|airport_name                                               |arr_flights|arr_del15|carrier_ct|weather_ct|nas_ct|security_ct|late_aircraft_ct|arr_cancelled|arr_diverted|arr_delay|carrier_delay|weather_delay|nas_delay|security_delay|late_aircraft_delay|total_delay_minutes|total_delay_count |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
|2022|5    |9E     |Endeavor Air Inc.|ABE    |Allentown/Bethlehem/Easton, PA: Lehigh Valley International|136        |7        |5.95      |0.0       |0.05  |0.0        |1.0             |0            |0           |255      |222          |0            |4        |0             |29                 |255                |7.0               |
|2022|5    |9E     |Endeavor Air Inc.|ABY    |Albany, GA: Southwest Georgia Regional                     |91         |16       |7.38      |0.0       |2.54  |0.0        |6.09            |0            |0           |884      |351          |0            |81       |0             |452                |884                |16.009999999999998|
|2022|5    |9E     |Endeavor Air Inc.|ACK    |Nantucket, MA: Nantucket Memorial                          |19         |2        |0.13      |0.0       |1.0   |0.0        |0.88            |1            |0           |138      |4            |0            |106      |0             |28                 |138                |2.01              |
|2022|5    |9E     |Endeavor Air Inc.|AEX    |Alexandria, LA: Alexandria International                   |88         |14       |7.26      |0.76      |4.35  |0.0        |1.64            |0            |0           |947      |585          |35           |125      |0             |202                |947                |14.01             |
|2022|5    |9E     |Endeavor Air Inc.|AGS    |Augusta, GA: Augusta Regional at Bush Field                |181        |19       |13.84     |0.0       |3.07  |0.0        |2.09            |0            |0           |808      |662          |0            |87       |0             |59                 |808                |19.0              |
|2022|5    |9E     |Endeavor Air Inc.|ALB    |Albany, NY: Albany International                           |134        |18       |4.42      |1.0       |6.48  |0.0        |6.09            |5            |0           |917      |224          |78           |398      |0             |217                |917                |17.990000000000002|
|2022|5    |9E     |Endeavor Air Inc.|ATL    |Atlanta, GA: Hartsfield-Jackson Atlanta International      |3042       |453      |142.96    |13.53     |106.98|0.0        |189.53          |2            |3           |38397    |20775        |1205         |3610     |0             |12807              |38397              |453.0             |
|2022|5    |9E     |Endeavor Air Inc.|ATW    |Appleton, WI: Appleton International                       |118        |13       |4.83      |0.0       |6.85  |0.0        |1.32            |0            |0           |914      |578          |0            |171      |0             |165                |914                |13.0              |
|2022|5    |9E     |Endeavor Air Inc.|AUS    |Austin, TX: Austin - Bergstrom International               |53         |8        |5.23      |1.0       |0.89  |0.0        |0.88            |1            |0           |582      |445          |20           |19       |0             |98                 |582                |8.0               |
|2022|5    |9E     |Endeavor Air Inc.|AVL    |Asheville, NC: Asheville Regional                          |58         |14       |4.54      |0.0       |7.61  |0.0        |1.85            |1            |0           |996      |290          |0            |618      |0             |88                 |996                |14.0              |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
only showing top 10 rows

25/12/15 19:12:40 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 19:12:40 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 19:12:40 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 19:12:40 INFO MemoryStore: MemoryStore cleared
25/12/15 19:12:40 INFO BlockManager: BlockManager stopped
25/12/15 19:12:40 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 19:12:40 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 19:12:41 INFO SparkContext: Successfully stopped SparkContext
25/12/15 19:12:41 INFO ShutdownHookManager: Shutdown hook called
25/12/15 19:12:41 INFO ShutdownHookManager: Deleting directory /tmp/spark-11d846e4-b439-4191-a56f-b71ba41cb358
25/12/15 19:12:41 INFO ShutdownHookManager: Deleting directory /tmp/spark-fb2b3ea7-89df-426a-a645-ca6ad0919b8c
25/12/15 19:12:41 INFO ShutdownHookManager: Deleting directory /tmp/spark-fb2b3ea7-89df-426a-a645-ca6ad0919b8c/pyspark-f79bc23d-d2cc-423f-9ca5-ec04ec2991c6
[3/5] Computing metrics...
25/12/15 19:12:44 INFO SparkContext: Running Spark version 3.5.1
25/12/15 19:12:44 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:12:44 INFO SparkContext: Java version 17.0.17
25/12/15 19:12:44 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 19:12:44 INFO ResourceUtils: ==============================================================
25/12/15 19:12:44 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 19:12:44 INFO ResourceUtils: ==============================================================
25/12/15 19:12:44 INFO SparkContext: Submitted application: Airline Metrics
25/12/15 19:12:44 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 19:12:44 INFO ResourceProfile: Limiting resource is cpu
25/12/15 19:12:44 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 19:12:44 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 19:12:44 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 19:12:44 INFO SecurityManager: Changing view acls groups to: 
25/12/15 19:12:44 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 19:12:44 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 19:12:45 INFO Utils: Successfully started service 'sparkDriver' on port 38415.
25/12/15 19:12:45 INFO SparkEnv: Registering MapOutputTracker
25/12/15 19:12:45 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 19:12:45 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 19:12:45 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 19:12:45 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 19:12:45 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-129340c5-6413-4aeb-90a9-8ef7905db266
25/12/15 19:12:45 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 19:12:45 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 19:12:45 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 19:12:45 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 19:12:45 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 19:12:45 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:12:45 INFO Executor: Java version 17.0.17
25/12/15 19:12:45 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 19:12:45 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 19:12:45 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 39769.
25/12/15 19:12:45 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:39769
25/12/15 19:12:45 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 19:12:45 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 39769, None)
25/12/15 19:12:45 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:39769 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 39769, None)
25/12/15 19:12:45 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 39769, None)
25/12/15 19:12:45 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 39769, None)
25/12/15 19:12:46 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 19:12:46 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 19:12:47 INFO InMemoryFileIndex: It took 42 ms to list leaf files for 1 paths.
25/12/15 19:12:47 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/15 19:12:50 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:50 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 19:12:50 INFO CodeGenerator: Code generated in 254.181528 ms
25/12/15 19:12:50 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 19:12:50 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.7 MiB)
25/12/15 19:12:50 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 19:12:50 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:50 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:51 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:51 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:51 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:51 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:51 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:51 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:51 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 19:12:51 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 19:12:51 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 19:12:51 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:51 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:51 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 19:12:51 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:51 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 19:12:51 INFO CodeGenerator: Code generated in 31.937829 ms
25/12/15 19:12:51 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:51 INFO CodeGenerator: Code generated in 28.41768 ms
25/12/15 19:12:51 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 19:12:51 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 345 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:51 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 19:12:51 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.553 s
25/12/15 19:12:51 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:51 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 19:12:51 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.632401 s
25/12/15 19:12:51 INFO CodeGenerator: Code generated in 19.395095 ms
25/12/15 19:12:51 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:51 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:12:51 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 19:12:51 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/15 19:12:51 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 19:12:51 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:51 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:52 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:12:52 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:12:52 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:52 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:52 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:52 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:52 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 19:12:52 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 19:12:52 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:12:52 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:52 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:12:52 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 19:12:52 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:52 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:12:52 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 19:12:52 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 19:12:52 INFO CodeGenerator: Code generated in 20.477281 ms
25/12/15 19:12:52 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:52 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:12:54 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 19:12:54 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2538 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:12:54 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 19:12:54 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2752 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:12:54 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 19:12:54 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.814 s
25/12/15 19:12:54 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:54 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 19:12:54 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.827035 s
25/12/15 19:12:55 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:55 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:12:55 INFO CodeGenerator: Code generated in 107.733438 ms
25/12/15 19:12:55 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 19:12:55 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 19:12:55 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:12:55 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:55 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:55 INFO DAGScheduler: Registering RDD 13 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/15 19:12:55 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:12:55 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:55 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:55 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:55 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:55 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 55.5 KiB, free 413.1 MiB)
25/12/15 19:12:55 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 23.4 KiB, free 413.1 MiB)
25/12/15 19:12:55 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 23.4 KiB, free: 413.8 MiB)
25/12/15 19:12:55 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:55 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:12:55 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 19:12:55 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:12:55 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:12:55 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 19:12:55 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 19:12:55 INFO CodeGenerator: Code generated in 86.439853 ms
25/12/15 19:12:55 INFO CodeGenerator: Code generated in 23.585094 ms
25/12/15 19:12:56 INFO CodeGenerator: Code generated in 8.472529 ms
25/12/15 19:12:56 INFO CodeGenerator: Code generated in 15.073075 ms
25/12/15 19:12:56 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:12:56 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:12:56 INFO CodeGenerator: Code generated in 23.890341 ms
25/12/15 19:12:56 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:12:56 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:12:56 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/15 19:12:56 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 19:12:58 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2884 bytes result sent to driver
25/12/15 19:12:58 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 2264 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:12:58 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2841 bytes result sent to driver
25/12/15 19:12:58 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 2286 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:12:58 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 2.319 s
25/12/15 19:12:58 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 19:12:58 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:12:58 INFO DAGScheduler: running: Set()
25/12/15 19:12:58 INFO DAGScheduler: waiting: Set()
25/12/15 19:12:58 INFO DAGScheduler: failed: Set()
25/12/15 19:12:58 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 19.593992 ms
25/12/15 19:12:58 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 31.874758 ms
25/12/15 19:12:58 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:58 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:12:58 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:58 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/15 19:12:58 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:58 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:58 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 56.1 KiB, free 413.6 MiB)
25/12/15 19:12:58 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 413.5 MiB)
25/12/15 19:12:58 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 24.3 KiB, free: 413.8 MiB)
25/12/15 19:12:58 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:58 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:12:58 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/15 19:12:58 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:12:58 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 12.870095 ms
25/12/15 19:12:58 INFO ShuffleBlockFetcherIterator: Getting 2 (4.5 KiB) non-empty blocks including 2 (4.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:12:58 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 12 ms
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 36.315998 ms
25/12/15 19:12:58 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 5840 bytes result sent to driver
25/12/15 19:12:58 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 170 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:12:58 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/15 19:12:58 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.195 s
25/12/15 19:12:58 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:12:58 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/15 19:12:58 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.216816 s
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 18.686417 ms
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 16.85234 ms
+----------------------------+-----------+
|carrier_name                |total_delay|
+----------------------------+-----------+
|Southwest Airlines Co.      |197589768  |
|American Airlines Inc.      |158749715  |
|SkyWest Airlines Inc.       |126613903  |
|Delta Air Lines Inc.        |125894776  |
|United Air Lines Inc.       |114178620  |
|ExpressJet Airlines Inc.    |98092859   |
|American Eagle Airlines Inc.|64419820   |
|JetBlue Airways             |62841558   |
|US Airways Inc.             |48308565   |
|Atlantic Southeast Airlines |36380279   |
+----------------------------+-----------+
only showing top 10 rows

25/12/15 19:12:58 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:12:58 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 76.649303 ms
25/12/15 19:12:58 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.3 MiB)
25/12/15 19:12:58 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.3 MiB)
25/12/15 19:12:58 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:12:58 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:12:58 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:12:58 INFO DAGScheduler: Registering RDD 21 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
25/12/15 19:12:58 INFO DAGScheduler: Got map stage job 4 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:12:58 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:12:58 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:12:58 INFO DAGScheduler: Missing parents: List()
25/12/15 19:12:58 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:12:58 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 56.9 KiB, free 413.3 MiB)
25/12/15 19:12:58 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 413.2 MiB)
25/12/15 19:12:58 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 23.9 KiB, free: 413.8 MiB)
25/12/15 19:12:58 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/15 19:12:58 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:12:58 INFO TaskSchedulerImpl: Adding task set 5.0 with 2 tasks resource profile 0
25/12/15 19:12:58 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:12:58 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 7) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:12:58 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/15 19:12:58 INFO Executor: Running task 1.0 in stage 5.0 (TID 7)
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 70.705339 ms
25/12/15 19:12:58 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 24.3 KiB, free: 413.8 MiB)
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 19.013369 ms
25/12/15 19:12:58 INFO CodeGenerator: Code generated in 9.354043 ms
25/12/15 19:12:58 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:12:58 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:00 INFO Executor: Finished task 1.0 in stage 5.0 (TID 7). 2841 bytes result sent to driver
25/12/15 19:13:00 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 7) in 1547 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:00 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 2841 bytes result sent to driver
25/12/15 19:13:00 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 1766 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:00 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/15 19:13:00 INFO DAGScheduler: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 1.778 s
25/12/15 19:13:00 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:00 INFO DAGScheduler: running: Set()
25/12/15 19:13:00 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:00 INFO DAGScheduler: failed: Set()
25/12/15 19:13:00 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:00 INFO CodeGenerator: Code generated in 19.300177 ms
25/12/15 19:13:00 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:00 INFO CodeGenerator: Code generated in 22.661335 ms
25/12/15 19:13:00 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:00 INFO DAGScheduler: Got job 5 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:00 INFO DAGScheduler: Final stage: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:00 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/12/15 19:13:00 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:00 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:00 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 57.9 KiB, free 413.3 MiB)
25/12/15 19:13:00 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 413.2 MiB)
25/12/15 19:13:00 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 24.9 KiB, free: 413.8 MiB)
25/12/15 19:13:00 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:00 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:00 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/12/15 19:13:00 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 8) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:00 INFO Executor: Running task 0.0 in stage 7.0 (TID 8)
25/12/15 19:13:00 INFO CodeGenerator: Code generated in 8.653205 ms
25/12/15 19:13:00 INFO ShuffleBlockFetcherIterator: Getting 2 (59.8 KiB) non-empty blocks including 2 (59.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:00 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:00 INFO CodeGenerator: Code generated in 14.643932 ms
25/12/15 19:13:00 INFO Executor: Finished task 0.0 in stage 7.0 (TID 8). 6090 bytes result sent to driver
25/12/15 19:13:00 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 8) in 67 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:00 INFO DAGScheduler: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0) finished in 0.079 s
25/12/15 19:13:00 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/12/15 19:13:00 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:00 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/12/15 19:13:00 INFO DAGScheduler: Job 5 finished: showString at NativeMethodAccessorImpl.java:0, took 0.098806 s
25/12/15 19:13:00 INFO CodeGenerator: Code generated in 7.483571 ms
+------------------------------------------------------+------------------+
|airport_name                                          |avg_delay         |
+------------------------------------------------------+------------------+
|Chicago, IL: Chicago O'Hare International             |31867.799072091362|
|Atlanta, GA: Hartsfield-Jackson Atlanta International |27830.672919508866|
|Dallas/Fort Worth, TX: Dallas/Fort Worth International|20571.237798546208|
|Newark, NJ: Newark Liberty International              |17511.09181784524 |
|San Francisco, CA: San Francisco International        |16140.159023668639|
|Sanford, FL: Orlando Sanford International            |16041.452830188678|
|Denver, CO: Denver International                      |15025.973445143256|
|New York, NY: John F. Kennedy International           |14642.515225933203|
|Los Angeles, CA: Los Angeles International            |13589.449129852745|
|Houston, TX: George Bush Intercontinental/Houston     |13375.582714118107|
+------------------------------------------------------+------------------+
only showing top 10 rows

25/12/15 19:13:00 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:00 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:00 INFO BlockManagerInfo: Removed broadcast_9_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 24.9 KiB, free: 413.8 MiB)
25/12/15 19:13:01 INFO CodeGenerator: Code generated in 56.044303 ms
25/12/15 19:13:01 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 199.5 KiB, free 413.1 MiB)
25/12/15 19:13:01 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.1 MiB)
25/12/15 19:13:01 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:01 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:01 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:01 INFO DAGScheduler: Registering RDD 29 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/12/15 19:13:01 INFO DAGScheduler: Got map stage job 6 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:01 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:01 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:01 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:01 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:01 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 55.2 KiB, free 413.0 MiB)
25/12/15 19:13:01 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 23.2 KiB, free 413.0 MiB)
25/12/15 19:13:01 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 23.2 KiB, free: 413.8 MiB)
25/12/15 19:13:01 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:01 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:01 INFO TaskSchedulerImpl: Adding task set 8.0 with 2 tasks resource profile 0
25/12/15 19:13:01 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 9) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:01 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 10) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:01 INFO Executor: Running task 1.0 in stage 8.0 (TID 10)
25/12/15 19:13:01 INFO Executor: Running task 0.0 in stage 8.0 (TID 9)
25/12/15 19:13:01 INFO CodeGenerator: Code generated in 50.067688 ms
25/12/15 19:13:01 INFO CodeGenerator: Code generated in 13.067451 ms
25/12/15 19:13:01 INFO CodeGenerator: Code generated in 7.238967 ms
25/12/15 19:13:01 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:01 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:02 INFO Executor: Finished task 1.0 in stage 8.0 (TID 10). 2841 bytes result sent to driver
25/12/15 19:13:02 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 10) in 1628 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:02 INFO Executor: Finished task 0.0 in stage 8.0 (TID 9). 2841 bytes result sent to driver
25/12/15 19:13:02 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 9) in 1690 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:02 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/12/15 19:13:02 INFO DAGScheduler: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0) finished in 1.706 s
25/12/15 19:13:02 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:02 INFO DAGScheduler: running: Set()
25/12/15 19:13:02 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:02 INFO DAGScheduler: failed: Set()
25/12/15 19:13:02 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:02 INFO CodeGenerator: Code generated in 5.697863 ms
25/12/15 19:13:02 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:02 INFO CodeGenerator: Code generated in 19.796773 ms
25/12/15 19:13:02 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:02 INFO DAGScheduler: Got job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:02 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:02 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/12/15 19:13:02 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:02 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:02 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 56.0 KiB, free 413.0 MiB)
25/12/15 19:13:02 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 24.2 KiB, free 412.9 MiB)
25/12/15 19:13:02 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 24.2 KiB, free: 413.7 MiB)
25/12/15 19:13:02 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:02 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:02 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/12/15 19:13:02 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 11) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:02 INFO Executor: Running task 0.0 in stage 10.0 (TID 11)
25/12/15 19:13:02 INFO CodeGenerator: Code generated in 9.227304 ms
25/12/15 19:13:02 INFO ShuffleBlockFetcherIterator: Getting 2 (1386.0 B) non-empty blocks including 2 (1386.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:02 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:02 INFO CodeGenerator: Code generated in 23.622125 ms
25/12/15 19:13:02 INFO Executor: Finished task 0.0 in stage 10.0 (TID 11). 5576 bytes result sent to driver
25/12/15 19:13:02 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 11) in 75 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:02 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/12/15 19:13:02 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.095 s
25/12/15 19:13:02 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:02 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/12/15 19:13:02 INFO DAGScheduler: Job 7 finished: showString at NativeMethodAccessorImpl.java:0, took 0.109328 s
25/12/15 19:13:02 INFO CodeGenerator: Code generated in 13.788227 ms
+----+------------+
|year|yearly_delay|
+----+------------+
|2003|32535792    |
|2004|73088325    |
|2005|76476224    |
|2006|87187039    |
|2007|100965732   |
|2008|86637993    |
|2009|66005819    |
|2010|63257498    |
|2011|61670561    |
|2012|56916692    |
+----+------------+
only showing top 10 rows

25/12/15 19:13:03 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:03 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:03 INFO CodeGenerator: Code generated in 51.249596 ms
25/12/15 19:13:03 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 199.5 KiB, free 412.7 MiB)
25/12/15 19:13:03 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.7 MiB)
25/12/15 19:13:03 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.7 MiB)
25/12/15 19:13:03 INFO SparkContext: Created broadcast 13 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:03 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:03 INFO DAGScheduler: Registering RDD 37 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/12/15 19:13:03 INFO DAGScheduler: Got map stage job 8 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:03 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:03 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:03 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:03 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:03 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 55.2 KiB, free 412.6 MiB)
25/12/15 19:13:03 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 23.2 KiB, free 412.6 MiB)
25/12/15 19:13:03 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 23.2 KiB, free: 413.7 MiB)
25/12/15 19:13:03 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:03 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:03 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
25/12/15 19:13:03 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 12) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:03 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 13) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:03 INFO Executor: Running task 0.0 in stage 11.0 (TID 12)
25/12/15 19:13:03 INFO Executor: Running task 1.0 in stage 11.0 (TID 13)
25/12/15 19:13:03 INFO CodeGenerator: Code generated in 55.810049 ms
25/12/15 19:13:03 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:03 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:03 INFO BlockManagerInfo: Removed broadcast_12_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 24.2 KiB, free: 413.7 MiB)
25/12/15 19:13:04 INFO Executor: Finished task 1.0 in stage 11.0 (TID 13). 2841 bytes result sent to driver
25/12/15 19:13:04 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 13) in 1311 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:04 INFO Executor: Finished task 0.0 in stage 11.0 (TID 12). 2841 bytes result sent to driver
25/12/15 19:13:04 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 12) in 1397 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:04 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
25/12/15 19:13:04 INFO DAGScheduler: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 1.409 s
25/12/15 19:13:04 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:04 INFO DAGScheduler: running: Set()
25/12/15 19:13:04 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:04 INFO DAGScheduler: failed: Set()
25/12/15 19:13:04 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:04 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:04 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:04 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:04 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:04 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
25/12/15 19:13:04 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:04 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:04 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 56.0 KiB, free 412.6 MiB)
25/12/15 19:13:04 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 412.6 MiB)
25/12/15 19:13:04 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 24.3 KiB, free: 413.7 MiB)
25/12/15 19:13:04 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:04 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:04 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
25/12/15 19:13:04 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:04 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
25/12/15 19:13:04 INFO ShuffleBlockFetcherIterator: Getting 2 (1584.0 B) non-empty blocks including 2 (1584.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:04 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:04 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5576 bytes result sent to driver
25/12/15 19:13:04 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 35 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:04 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
25/12/15 19:13:04 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.048 s
25/12/15 19:13:04 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:04 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
25/12/15 19:13:04 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.057174 s
+-----+-------------+
|month|monthly_delay|
+-----+-------------+
|1    |110991145    |
|2    |103189056    |
|3    |109732760    |
|4    |99452911     |
|5    |108496590    |
|6    |142912106    |
|7    |147857638    |
|8    |128590594    |
|9    |78557928     |
|10   |89932256     |
+-----+-------------+
only showing top 10 rows

25/12/15 19:13:04 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:04 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:04 INFO CodeGenerator: Code generated in 56.410278 ms
25/12/15 19:13:04 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 199.5 KiB, free 412.4 MiB)
25/12/15 19:13:04 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.4 MiB)
25/12/15 19:13:04 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 34.3 KiB, free: 413.6 MiB)
25/12/15 19:13:04 INFO SparkContext: Created broadcast 16 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:04 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:04 INFO DAGScheduler: Registering RDD 45 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 4
25/12/15 19:13:04 INFO DAGScheduler: Got map stage job 10 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:04 INFO DAGScheduler: Final stage: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:04 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:04 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:04 INFO DAGScheduler: Submitting ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:04 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 56.9 KiB, free 412.3 MiB)
25/12/15 19:13:04 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 412.3 MiB)
25/12/15 19:13:04 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 23.9 KiB, free: 413.6 MiB)
25/12/15 19:13:04 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:04 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:04 INFO TaskSchedulerImpl: Adding task set 14.0 with 2 tasks resource profile 0
25/12/15 19:13:04 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 15) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:04 INFO TaskSetManager: Starting task 1.0 in stage 14.0 (TID 16) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:04 INFO Executor: Running task 0.0 in stage 14.0 (TID 15)
25/12/15 19:13:04 INFO Executor: Running task 1.0 in stage 14.0 (TID 16)
25/12/15 19:13:05 INFO CodeGenerator: Code generated in 52.121633 ms
25/12/15 19:13:05 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:05 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:05 INFO BlockManagerInfo: Removed broadcast_15_piece0 on ip-172-31-64-111.ec2.internal:39769 in memory (size: 24.3 KiB, free: 413.6 MiB)
25/12/15 19:13:06 INFO Executor: Finished task 1.0 in stage 14.0 (TID 16). 2841 bytes result sent to driver
25/12/15 19:13:06 INFO TaskSetManager: Finished task 1.0 in stage 14.0 (TID 16) in 1266 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:06 INFO Executor: Finished task 0.0 in stage 14.0 (TID 15). 2841 bytes result sent to driver
25/12/15 19:13:06 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 15) in 1381 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:06 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
25/12/15 19:13:06 INFO DAGScheduler: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 1.392 s
25/12/15 19:13:06 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:06 INFO DAGScheduler: running: Set()
25/12/15 19:13:06 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:06 INFO DAGScheduler: failed: Set()
25/12/15 19:13:06 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:06 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:06 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:06 INFO DAGScheduler: Got job 11 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:06 INFO DAGScheduler: Final stage: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:06 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 15)
25/12/15 19:13:06 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:06 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:06 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 57.9 KiB, free 412.3 MiB)
25/12/15 19:13:06 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 412.3 MiB)
25/12/15 19:13:06 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on ip-172-31-64-111.ec2.internal:39769 (size: 24.9 KiB, free: 413.6 MiB)
25/12/15 19:13:06 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:06 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:06 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
25/12/15 19:13:06 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 17) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:06 INFO Executor: Running task 0.0 in stage 16.0 (TID 17)
25/12/15 19:13:06 INFO ShuffleBlockFetcherIterator: Getting 2 (4.6 KiB) non-empty blocks including 2 (4.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:06 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:06 INFO Executor: Finished task 0.0 in stage 16.0 (TID 17). 5840 bytes result sent to driver
25/12/15 19:13:06 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 17) in 22 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:06 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/12/15 19:13:06 INFO DAGScheduler: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.039 s
25/12/15 19:13:06 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:06 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
25/12/15 19:13:06 INFO DAGScheduler: Job 11 finished: showString at NativeMethodAccessorImpl.java:0, took 0.050137 s
+----------------------------+------------------+
|carrier_name                |avg_carrier_delay |
+----------------------------+------------------+
|Southwest Airlines Co.      |11242.021392808376|
|American Airlines Inc.      |8029.828780981285 |
|United Air Lines Inc.       |5979.190406367826 |
|JetBlue Airways             |5430.483753888697 |
|Delta Air Lines Inc.        |4574.997310851079 |
|US Airways Inc.             |4518.197250280584 |
|Continental Air Lines Inc.  |4342.791835552982 |
|Spirit Air Lines            |4336.106388595565 |
|American Eagle Airlines Inc.|4183.37684265212  |
|ExpressJet Airlines Inc.    |4005.9157512149304|
+----------------------------+------------------+
only showing top 10 rows

25/12/15 19:13:06 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 19:13:06 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 19:13:06 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 19:13:06 INFO MemoryStore: MemoryStore cleared
25/12/15 19:13:06 INFO BlockManager: BlockManager stopped
25/12/15 19:13:06 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 19:13:06 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 19:13:06 INFO SparkContext: Successfully stopped SparkContext
25/12/15 19:13:06 INFO ShutdownHookManager: Shutdown hook called
25/12/15 19:13:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-bf2fb546-d7a0-4946-a592-239612ed9edd/pyspark-fbea2b6e-6a1b-44f1-9989-96eae47bbbaf
25/12/15 19:13:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-27da490c-d4aa-43fc-a7e7-097605cd6b49
25/12/15 19:13:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-bf2fb546-d7a0-4946-a592-239612ed9edd
[4/5] Running Spark SQL analysis...
25/12/15 19:13:10 INFO SparkContext: Running Spark version 3.5.1
25/12/15 19:13:10 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:13:10 INFO SparkContext: Java version 17.0.17
25/12/15 19:13:10 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 19:13:10 INFO ResourceUtils: ==============================================================
25/12/15 19:13:10 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 19:13:10 INFO ResourceUtils: ==============================================================
25/12/15 19:13:10 INFO SparkContext: Submitted application: Airline SQL
25/12/15 19:13:10 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 19:13:10 INFO ResourceProfile: Limiting resource is cpu
25/12/15 19:13:10 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 19:13:10 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 19:13:10 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 19:13:10 INFO SecurityManager: Changing view acls groups to: 
25/12/15 19:13:10 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 19:13:10 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 19:13:10 INFO Utils: Successfully started service 'sparkDriver' on port 45827.
25/12/15 19:13:11 INFO SparkEnv: Registering MapOutputTracker
25/12/15 19:13:11 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 19:13:11 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 19:13:11 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 19:13:11 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 19:13:11 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-fc32fe35-f837-4e8f-9d79-6caef06ab915
25/12/15 19:13:11 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 19:13:11 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 19:13:11 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 19:13:11 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 19:13:11 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 19:13:11 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:13:11 INFO Executor: Java version 17.0.17
25/12/15 19:13:11 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 19:13:11 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/15 19:13:11 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 34665.
25/12/15 19:13:11 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:34665
25/12/15 19:13:11 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 19:13:11 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 34665, None)
25/12/15 19:13:11 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:34665 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 34665, None)
25/12/15 19:13:11 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 34665, None)
25/12/15 19:13:11 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 34665, None)
25/12/15 19:13:12 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 19:13:12 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 19:13:13 INFO InMemoryFileIndex: It took 66 ms to list leaf files for 1 paths.
25/12/15 19:13:13 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/15 19:13:16 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:16 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 19:13:17 INFO CodeGenerator: Code generated in 265.673108 ms
25/12/15 19:13:17 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 19:13:17 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.7 MiB)
25/12/15 19:13:17 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 19:13:17 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:17 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:17 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:17 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:17 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:17 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:17 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:17 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 19:13:17 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 19:13:17 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 19:13:17 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:17 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:17 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 19:13:17 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:17 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 19:13:17 INFO CodeGenerator: Code generated in 20.892926 ms
25/12/15 19:13:17 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:17 INFO CodeGenerator: Code generated in 10.084458 ms
25/12/15 19:13:17 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 19:13:17 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 222 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:17 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 19:13:17 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.346 s
25/12/15 19:13:17 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 19:13:17 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.397256 s
25/12/15 19:13:17 INFO CodeGenerator: Code generated in 12.653426 ms
25/12/15 19:13:18 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:18 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:13:18 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 19:13:18 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/15 19:13:18 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 19:13:18 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:18 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:18 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:18 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:18 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:18 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:18 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:18 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 19:13:18 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 19:13:18 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:13:18 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:18 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:18 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 19:13:18 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:18 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:18 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 19:13:18 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 19:13:18 INFO CodeGenerator: Code generated in 19.155029 ms
25/12/15 19:13:18 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:18 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:20 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 19:13:20 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2056 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:20 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 19:13:20 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2224 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:20 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.272 s
25/12/15 19:13:20 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 19:13:20 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:20 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 19:13:20 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.282813 s
25/12/15 19:13:20 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:20 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:21 INFO CodeGenerator: Code generated in 107.826519 ms
25/12/15 19:13:21 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 19:13:21 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 19:13:21 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:21 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:21 INFO DAGScheduler: Registering RDD 13 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/15 19:13:21 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:21 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:21 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:21 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:21 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:21 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 53.2 KiB, free 413.1 MiB)
25/12/15 19:13:21 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 22.4 KiB, free 413.1 MiB)
25/12/15 19:13:21 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 22.4 KiB, free: 413.8 MiB)
25/12/15 19:13:21 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:21 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:21 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 19:13:21 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:21 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:21 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 19:13:21 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 19:13:21 INFO CodeGenerator: Code generated in 38.73403 ms
25/12/15 19:13:21 INFO CodeGenerator: Code generated in 9.101191 ms
25/12/15 19:13:21 INFO CodeGenerator: Code generated in 6.10505 ms
25/12/15 19:13:21 INFO CodeGenerator: Code generated in 7.110623 ms
25/12/15 19:13:21 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:21 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:21 INFO CodeGenerator: Code generated in 23.92041 ms
25/12/15 19:13:21 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:21 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:13:21 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/15 19:13:21 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/15 19:13:23 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2884 bytes result sent to driver
25/12/15 19:13:23 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 2039 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:23 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2841 bytes result sent to driver
25/12/15 19:13:23 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 2318 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:23 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 2.341 s
25/12/15 19:13:23 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 19:13:23 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:23 INFO DAGScheduler: running: Set()
25/12/15 19:13:23 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:23 INFO DAGScheduler: failed: Set()
25/12/15 19:13:23 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:23 INFO CodeGenerator: Code generated in 24.7215 ms
25/12/15 19:13:23 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:23 INFO CodeGenerator: Code generated in 44.785107 ms
25/12/15 19:13:23 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:23 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:23 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:23 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/15 19:13:23 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:23 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:23 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 54.0 KiB, free 413.6 MiB)
25/12/15 19:13:23 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 23.7 KiB, free 413.5 MiB)
25/12/15 19:13:23 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 23.7 KiB, free: 413.8 MiB)
25/12/15 19:13:23 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:23 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/15 19:13:23 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:23 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/15 19:13:23 INFO CodeGenerator: Code generated in 19.557613 ms
25/12/15 19:13:23 INFO ShuffleBlockFetcherIterator: Getting 2 (4.5 KiB) non-empty blocks including 2 (4.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:23 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 13 ms
25/12/15 19:13:23 INFO CodeGenerator: Code generated in 28.474352 ms
25/12/15 19:13:23 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 5840 bytes result sent to driver
25/12/15 19:13:23 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 170 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:23 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/15 19:13:23 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.189 s
25/12/15 19:13:23 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/15 19:13:23 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.216353 s
25/12/15 19:13:24 INFO CodeGenerator: Code generated in 18.025263 ms
25/12/15 19:13:24 INFO CodeGenerator: Code generated in 15.783663 ms
+----------------------------+-------------------+
|carrier_name                |total_arrival_delay|
+----------------------------+-------------------+
|Southwest Airlines Co.      |197589768          |
|American Airlines Inc.      |158749715          |
|SkyWest Airlines Inc.       |126613903          |
|Delta Air Lines Inc.        |125895285          |
|United Air Lines Inc.       |114178620          |
|ExpressJet Airlines Inc.    |98092859           |
|American Eagle Airlines Inc.|64419820           |
|JetBlue Airways             |62841558           |
|US Airways Inc.             |48308565           |
|Atlantic Southeast Airlines |36380279           |
+----------------------------+-------------------+
only showing top 10 rows

25/12/15 19:13:24 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:24 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:24 INFO CodeGenerator: Code generated in 72.200539 ms
25/12/15 19:13:24 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.4 MiB)
25/12/15 19:13:24 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 23.7 KiB, free: 413.9 MiB)
25/12/15 19:13:24 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/15 19:13:24 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:24 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:24 INFO DAGScheduler: Registering RDD 21 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
25/12/15 19:13:24 INFO DAGScheduler: Got map stage job 4 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:24 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:24 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:24 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:24 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:24 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 54.6 KiB, free 413.3 MiB)
25/12/15 19:13:24 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.0 KiB, free 413.3 MiB)
25/12/15 19:13:24 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 23.0 KiB, free: 413.8 MiB)
25/12/15 19:13:24 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:24 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:24 INFO TaskSchedulerImpl: Adding task set 5.0 with 2 tasks resource profile 0
25/12/15 19:13:24 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:24 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 7) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:24 INFO Executor: Running task 1.0 in stage 5.0 (TID 7)
25/12/15 19:13:24 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/15 19:13:24 INFO CodeGenerator: Code generated in 50.394729 ms
25/12/15 19:13:24 INFO CodeGenerator: Code generated in 8.505276 ms
25/12/15 19:13:24 INFO CodeGenerator: Code generated in 7.424341 ms
25/12/15 19:13:24 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:24 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:25 INFO Executor: Finished task 1.0 in stage 5.0 (TID 7). 2841 bytes result sent to driver
25/12/15 19:13:25 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 7) in 1474 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:26 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 2841 bytes result sent to driver
25/12/15 19:13:26 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 1661 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:26 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/15 19:13:26 INFO DAGScheduler: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 1.678 s
25/12/15 19:13:26 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:26 INFO DAGScheduler: running: Set()
25/12/15 19:13:26 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:26 INFO DAGScheduler: failed: Set()
25/12/15 19:13:26 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 9.103782 ms
25/12/15 19:13:26 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 29.056362 ms
25/12/15 19:13:26 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:26 INFO DAGScheduler: Got job 5 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:26 INFO DAGScheduler: Final stage: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:26 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/12/15 19:13:26 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:26 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:26 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 55.8 KiB, free 413.3 MiB)
25/12/15 19:13:26 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.2 KiB, free 413.2 MiB)
25/12/15 19:13:26 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 24.2 KiB, free: 413.8 MiB)
25/12/15 19:13:26 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:26 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/12/15 19:13:26 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 8) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:26 INFO Executor: Running task 0.0 in stage 7.0 (TID 8)
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 11.070261 ms
25/12/15 19:13:26 INFO ShuffleBlockFetcherIterator: Getting 2 (59.8 KiB) non-empty blocks including 2 (59.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:26 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 4 ms
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 25.998803 ms
25/12/15 19:13:26 INFO Executor: Finished task 0.0 in stage 7.0 (TID 8). 6090 bytes result sent to driver
25/12/15 19:13:26 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 8) in 107 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:26 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/12/15 19:13:26 INFO DAGScheduler: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0) finished in 0.123 s
25/12/15 19:13:26 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/12/15 19:13:26 INFO DAGScheduler: Job 5 finished: showString at NativeMethodAccessorImpl.java:0, took 0.145538 s
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 14.496283 ms
+------------------------------------------------------+------------------+
|airport_name                                          |avg_arrival_delay |
+------------------------------------------------------+------------------+
|Chicago, IL: Chicago O'Hare International             |31867.799072091362|
|Atlanta, GA: Hartsfield-Jackson Atlanta International |27830.672919508866|
|Dallas/Fort Worth, TX: Dallas/Fort Worth International|20571.237798546208|
|Newark, NJ: Newark Liberty International              |17511.09181784524 |
|San Francisco, CA: San Francisco International        |16140.159023668639|
|Sanford, FL: Orlando Sanford International            |16041.452830188678|
|Denver, CO: Denver International                      |15025.973445143256|
|New York, NY: John F. Kennedy International           |14642.515225933203|
|Los Angeles, CA: Los Angeles International            |13589.449129852745|
|Houston, TX: George Bush Intercontinental/Houston     |13375.582714118107|
+------------------------------------------------------+------------------+
only showing top 10 rows

25/12/15 19:13:26 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:26 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 59.46231 ms
25/12/15 19:13:26 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 199.5 KiB, free 413.0 MiB)
25/12/15 19:13:26 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.0 MiB)
25/12/15 19:13:26 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:26 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:26 INFO DAGScheduler: Registering RDD 29 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/12/15 19:13:26 INFO DAGScheduler: Got map stage job 6 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:26 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:26 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:26 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:26 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:26 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 52.9 KiB, free 413.0 MiB)
25/12/15 19:13:26 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 22.2 KiB, free 412.9 MiB)
25/12/15 19:13:26 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 22.2 KiB, free: 413.7 MiB)
25/12/15 19:13:26 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:26 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:26 INFO TaskSchedulerImpl: Adding task set 8.0 with 2 tasks resource profile 0
25/12/15 19:13:26 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 9) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:26 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 10) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:26 INFO Executor: Running task 1.0 in stage 8.0 (TID 10)
25/12/15 19:13:26 INFO Executor: Running task 0.0 in stage 8.0 (TID 9)
25/12/15 19:13:26 INFO BlockManagerInfo: Removed broadcast_9_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 24.2 KiB, free: 413.8 MiB)
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 65.26948 ms
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 12.902121 ms
25/12/15 19:13:26 INFO CodeGenerator: Code generated in 13.099466 ms
25/12/15 19:13:26 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:26 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:28 INFO Executor: Finished task 1.0 in stage 8.0 (TID 10). 2841 bytes result sent to driver
25/12/15 19:13:28 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 10) in 1900 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:28 INFO Executor: Finished task 0.0 in stage 8.0 (TID 9). 2841 bytes result sent to driver
25/12/15 19:13:28 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 9) in 2065 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:28 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/12/15 19:13:28 INFO DAGScheduler: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0) finished in 2.076 s
25/12/15 19:13:28 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:28 INFO DAGScheduler: running: Set()
25/12/15 19:13:28 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:28 INFO DAGScheduler: failed: Set()
25/12/15 19:13:28 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:28 INFO CodeGenerator: Code generated in 5.858102 ms
25/12/15 19:13:28 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:28 INFO CodeGenerator: Code generated in 27.820792 ms
25/12/15 19:13:28 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:28 INFO DAGScheduler: Got job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:28 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:28 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/12/15 19:13:28 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:28 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:28 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 53.9 KiB, free 413.0 MiB)
25/12/15 19:13:28 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 412.9 MiB)
25/12/15 19:13:28 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 19:13:28 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:28 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/12/15 19:13:28 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 11) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:28 INFO Executor: Running task 0.0 in stage 10.0 (TID 11)
25/12/15 19:13:28 INFO CodeGenerator: Code generated in 8.573704 ms
25/12/15 19:13:28 INFO ShuffleBlockFetcherIterator: Getting 2 (1386.0 B) non-empty blocks including 2 (1386.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:28 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:28 INFO CodeGenerator: Code generated in 14.603873 ms
25/12/15 19:13:28 INFO Executor: Finished task 0.0 in stage 10.0 (TID 11). 5576 bytes result sent to driver
25/12/15 19:13:28 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 11) in 58 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:28 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/12/15 19:13:28 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.078 s
25/12/15 19:13:28 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/12/15 19:13:28 INFO DAGScheduler: Job 7 finished: showString at NativeMethodAccessorImpl.java:0, took 0.093550 s
25/12/15 19:13:28 INFO CodeGenerator: Code generated in 9.586441 ms
+----+------------+
|year|yearly_delay|
+----+------------+
|2003|32535792    |
|2004|73088325    |
|2005|76476224    |
|2006|87187039    |
|2007|100965732   |
|2008|86637993    |
|2009|66005819    |
|2010|63257498    |
|2011|61670561    |
|2012|56916692    |
+----+------------+
only showing top 10 rows

25/12/15 19:13:28 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:28 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:29 INFO CodeGenerator: Code generated in 30.734489 ms
25/12/15 19:13:29 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 199.5 KiB, free 412.7 MiB)
25/12/15 19:13:29 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.7 MiB)
25/12/15 19:13:29 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.7 MiB)
25/12/15 19:13:29 INFO SparkContext: Created broadcast 13 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:29 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:29 INFO DAGScheduler: Registering RDD 37 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/12/15 19:13:29 INFO DAGScheduler: Got map stage job 8 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:29 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:29 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:29 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:29 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:29 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 52.9 KiB, free 412.7 MiB)
25/12/15 19:13:29 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 22.2 KiB, free 412.6 MiB)
25/12/15 19:13:29 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 22.2 KiB, free: 413.7 MiB)
25/12/15 19:13:29 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:29 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:29 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
25/12/15 19:13:29 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 12) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:29 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 13) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:29 INFO Executor: Running task 1.0 in stage 11.0 (TID 13)
25/12/15 19:13:29 INFO Executor: Running task 0.0 in stage 11.0 (TID 12)
25/12/15 19:13:29 INFO CodeGenerator: Code generated in 56.331073 ms
25/12/15 19:13:29 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:29 INFO BlockManagerInfo: Removed broadcast_12_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 19:13:29 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:30 INFO Executor: Finished task 1.0 in stage 11.0 (TID 13). 2841 bytes result sent to driver
25/12/15 19:13:30 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 13) in 1381 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:30 INFO Executor: Finished task 0.0 in stage 11.0 (TID 12). 2841 bytes result sent to driver
25/12/15 19:13:30 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 12) in 1538 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:30 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
25/12/15 19:13:30 INFO DAGScheduler: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 1.549 s
25/12/15 19:13:30 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:30 INFO DAGScheduler: running: Set()
25/12/15 19:13:30 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:30 INFO DAGScheduler: failed: Set()
25/12/15 19:13:30 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:30 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:30 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:30 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:30 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
25/12/15 19:13:30 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:30 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:30 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 53.9 KiB, free 412.7 MiB)
25/12/15 19:13:30 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 412.6 MiB)
25/12/15 19:13:30 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 19:13:30 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:30 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
25/12/15 19:13:30 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:30 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
25/12/15 19:13:30 INFO ShuffleBlockFetcherIterator: Getting 2 (1584.0 B) non-empty blocks including 2 (1584.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:30 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:30 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5576 bytes result sent to driver
25/12/15 19:13:30 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 22 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:30 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
25/12/15 19:13:30 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.038 s
25/12/15 19:13:30 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
25/12/15 19:13:30 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.044983 s
+-----+-------------+
|month|monthly_delay|
+-----+-------------+
|1    |110991145    |
|2    |103189056    |
|3    |109732780    |
|4    |99452911     |
|5    |108496590    |
|6    |142912106    |
|7    |147857638    |
|8    |128591297    |
|9    |78557928     |
|10   |89932256     |
+-----+-------------+
only showing top 10 rows

25/12/15 19:13:30 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:30 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:30 INFO CodeGenerator: Code generated in 34.76473 ms
25/12/15 19:13:30 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 199.5 KiB, free 412.4 MiB)
25/12/15 19:13:30 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.4 MiB)
25/12/15 19:13:30 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 34.3 KiB, free: 413.6 MiB)
25/12/15 19:13:30 INFO SparkContext: Created broadcast 16 from showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:30 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:30 INFO BlockManagerInfo: Removed broadcast_15_piece0 on ip-172-31-64-111.ec2.internal:34665 in memory (size: 23.6 KiB, free: 413.7 MiB)
25/12/15 19:13:30 INFO DAGScheduler: Registering RDD 45 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 4
25/12/15 19:13:30 INFO DAGScheduler: Got map stage job 10 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:30 INFO DAGScheduler: Final stage: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:30 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:30 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:30 INFO DAGScheduler: Submitting ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:30 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 50.2 KiB, free 412.4 MiB)
25/12/15 19:13:30 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 412.4 MiB)
25/12/15 19:13:30 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 21.4 KiB, free: 413.6 MiB)
25/12/15 19:13:30 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:30 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:30 INFO TaskSchedulerImpl: Adding task set 14.0 with 2 tasks resource profile 0
25/12/15 19:13:30 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 15) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:30 INFO TaskSetManager: Starting task 1.0 in stage 14.0 (TID 16) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/15 19:13:30 INFO Executor: Running task 0.0 in stage 14.0 (TID 15)
25/12/15 19:13:30 INFO Executor: Running task 1.0 in stage 14.0 (TID 16)
25/12/15 19:13:31 INFO CodeGenerator: Code generated in 54.813397 ms
25/12/15 19:13:31 INFO CodeGenerator: Code generated in 11.611287 ms
25/12/15 19:13:31 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:31 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:32 INFO Executor: Finished task 1.0 in stage 14.0 (TID 16). 2841 bytes result sent to driver
25/12/15 19:13:32 INFO TaskSetManager: Finished task 1.0 in stage 14.0 (TID 16) in 1423 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:32 INFO Executor: Finished task 0.0 in stage 14.0 (TID 15). 2884 bytes result sent to driver
25/12/15 19:13:32 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 15) in 1551 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:32 INFO DAGScheduler: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 1.563 s
25/12/15 19:13:32 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
25/12/15 19:13:32 INFO DAGScheduler: looking for newly runnable stages
25/12/15 19:13:32 INFO DAGScheduler: running: Set()
25/12/15 19:13:32 INFO DAGScheduler: waiting: Set()
25/12/15 19:13:32 INFO DAGScheduler: failed: Set()
25/12/15 19:13:32 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/15 19:13:32 INFO CodeGenerator: Code generated in 6.344844 ms
25/12/15 19:13:32 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/15 19:13:32 INFO CodeGenerator: Code generated in 11.128365 ms
25/12/15 19:13:32 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/15 19:13:32 INFO DAGScheduler: Got job 11 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:32 INFO DAGScheduler: Final stage: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:32 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 15)
25/12/15 19:13:32 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:32 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:32 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 50.5 KiB, free 412.4 MiB)
25/12/15 19:13:32 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 22.6 KiB, free 412.3 MiB)
25/12/15 19:13:32 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on ip-172-31-64-111.ec2.internal:34665 (size: 22.6 KiB, free: 413.6 MiB)
25/12/15 19:13:32 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:32 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
25/12/15 19:13:32 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 17) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/15 19:13:32 INFO Executor: Running task 0.0 in stage 16.0 (TID 17)
25/12/15 19:13:32 INFO CodeGenerator: Code generated in 5.374704 ms
25/12/15 19:13:32 INFO ShuffleBlockFetcherIterator: Getting 2 (4.4 KiB) non-empty blocks including 2 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/15 19:13:32 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/15 19:13:32 INFO CodeGenerator: Code generated in 10.98486 ms
25/12/15 19:13:32 INFO Executor: Finished task 0.0 in stage 16.0 (TID 17). 5856 bytes result sent to driver
25/12/15 19:13:32 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 17) in 44 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:32 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/12/15 19:13:32 INFO DAGScheduler: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.054 s
25/12/15 19:13:32 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:32 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
25/12/15 19:13:32 INFO DAGScheduler: Job 11 finished: showString at NativeMethodAccessorImpl.java:0, took 0.063433 s
25/12/15 19:13:32 INFO CodeGenerator: Code generated in 6.926073 ms
+----------------------------+-------+
|carrier_name                |records|
+----------------------------+-------+
|SkyWest Airlines Inc.       |38038  |
|Delta Air Lines Inc.        |27518  |
|ExpressJet Airlines Inc.    |24487  |
|American Airlines Inc.      |19770  |
|United Air Lines Inc.       |19096  |
|Southwest Airlines Co.      |17576  |
|American Eagle Airlines Inc.|15399  |
|Mesa Airlines Inc.          |14483  |
|Alaska Airlines Inc.        |12933  |
|Frontier Airlines Inc.      |12275  |
+----------------------------+-------+
only showing top 10 rows

25/12/15 19:13:32 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 19:13:32 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 19:13:32 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 19:13:32 INFO MemoryStore: MemoryStore cleared
25/12/15 19:13:32 INFO BlockManager: BlockManager stopped
25/12/15 19:13:32 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 19:13:32 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 19:13:32 INFO SparkContext: Successfully stopped SparkContext
25/12/15 19:13:33 INFO ShutdownHookManager: Shutdown hook called
25/12/15 19:13:33 INFO ShutdownHookManager: Deleting directory /tmp/spark-8619b308-ccab-4473-9fc4-1db9e1ac866e
25/12/15 19:13:33 INFO ShutdownHookManager: Deleting directory /tmp/spark-8619b308-ccab-4473-9fc4-1db9e1ac866e/pyspark-bb5c9be1-2f13-4689-9371-020edf8db7c9
25/12/15 19:13:33 INFO ShutdownHookManager: Deleting directory /tmp/spark-28fe9e8a-a1eb-433c-aa72-7ef9093496e6
[5/5] Saving processed data to S3...
25/12/15 19:13:36 INFO SparkContext: Running Spark version 3.5.1
25/12/15 19:13:36 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:13:36 INFO SparkContext: Java version 17.0.17
25/12/15 19:13:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/15 19:13:36 INFO ResourceUtils: ==============================================================
25/12/15 19:13:36 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/15 19:13:36 INFO ResourceUtils: ==============================================================
25/12/15 19:13:36 INFO SparkContext: Submitted application: Save Airline Data
25/12/15 19:13:37 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/15 19:13:37 INFO ResourceProfile: Limiting resource is cpu
25/12/15 19:13:37 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/15 19:13:37 INFO SecurityManager: Changing view acls to: ubuntu
25/12/15 19:13:37 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/15 19:13:37 INFO SecurityManager: Changing view acls groups to: 
25/12/15 19:13:37 INFO SecurityManager: Changing modify acls groups to: 
25/12/15 19:13:37 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/15 19:13:37 INFO Utils: Successfully started service 'sparkDriver' on port 43413.
25/12/15 19:13:37 INFO SparkEnv: Registering MapOutputTracker
25/12/15 19:13:37 INFO SparkEnv: Registering BlockManagerMaster
25/12/15 19:13:37 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/15 19:13:37 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/15 19:13:37 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/15 19:13:37 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-664a9ac9-8a94-42e6-af7a-60b3045b3e86
25/12/15 19:13:37 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/15 19:13:37 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/15 19:13:37 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/15 19:13:37 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/15 19:13:38 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/15 19:13:38 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/15 19:13:38 INFO Executor: Java version 17.0.17
25/12/15 19:13:38 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/15 19:13:38 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@39a4a45f for default.
25/12/15 19:13:38 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38067.
25/12/15 19:13:38 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:38067
25/12/15 19:13:38 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/15 19:13:38 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 38067, None)
25/12/15 19:13:38 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:38067 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 38067, None)
25/12/15 19:13:38 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 38067, None)
25/12/15 19:13:38 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 38067, None)
25/12/15 19:13:38 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/15 19:13:38 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/15 19:13:39 INFO InMemoryFileIndex: It took 53 ms to list leaf files for 1 paths.
25/12/15 19:13:39 INFO InMemoryFileIndex: It took 4 ms to list leaf files for 1 paths.
25/12/15 19:13:42 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:42 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/15 19:13:43 INFO CodeGenerator: Code generated in 297.454665 ms
25/12/15 19:13:43 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/15 19:13:43 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/15 19:13:43 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 19:13:43 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:43 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:43 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:43 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/15 19:13:43 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:43 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:43 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:43 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:43 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/15 19:13:43 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/15 19:13:43 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 6.4 KiB, free: 413.9 MiB)
25/12/15 19:13:43 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:43 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/15 19:13:43 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/15 19:13:44 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:44 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/15 19:13:44 INFO CodeGenerator: Code generated in 30.010908 ms
25/12/15 19:13:44 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:44 INFO CodeGenerator: Code generated in 14.948591 ms
25/12/15 19:13:44 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/15 19:13:44 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 336 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/15 19:13:44 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/15 19:13:44 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.508 s
25/12/15 19:13:44 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/15 19:13:44 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.567844 s
25/12/15 19:13:44 INFO CodeGenerator: Code generated in 11.106571 ms
25/12/15 19:13:44 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:44 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/15 19:13:44 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/15 19:13:44 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/15 19:13:44 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 34.4 KiB, free: 413.9 MiB)
25/12/15 19:13:44 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:44 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:44 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:44 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:44 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:44 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:44 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:44 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:44 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/15 19:13:44 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/15 19:13:44 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 12.8 KiB, free: 413.8 MiB)
25/12/15 19:13:44 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:44 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:44 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/15 19:13:44 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:44 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:44 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/15 19:13:44 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/15 19:13:44 INFO CodeGenerator: Code generated in 20.864433 ms
25/12/15 19:13:44 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:44 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:47 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/15 19:13:47 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2435 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:47 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/15 19:13:47 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2534 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:47 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/15 19:13:47 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.591 s
25/12/15 19:13:47 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:47 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/15 19:13:47 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.607246 s
25/12/15 19:13:47 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:47 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:47 INFO ParquetUtils: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO CodeGenerator: Code generated in 47.225764 ms
25/12/15 19:13:47 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 19:13:47 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 19:13:47 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:47 INFO SparkContext: Created broadcast 4 from parquet at NativeMethodAccessorImpl.java:0
25/12/15 19:13:47 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:47 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
25/12/15 19:13:47 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:47 INFO DAGScheduler: Final stage: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:47 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:47 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:47 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:47 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 231.5 KiB, free 413.0 MiB)
25/12/15 19:13:47 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 81.5 KiB, free 412.9 MiB)
25/12/15 19:13:47 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 81.5 KiB, free: 413.7 MiB)
25/12/15 19:13:47 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:47 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 2 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:47 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/15 19:13:47 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:47 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:47 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/15 19:13:47 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/15 19:13:47 INFO CodeGenerator: Code generated in 38.152141 ms
25/12/15 19:13:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:47 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/15 19:13:47 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:47 INFO CodecConfig: Compression: SNAPPY
25/12/15 19:13:47 INFO CodecConfig: Compression: SNAPPY
25/12/15 19:13:48 INFO ParquetOutputFormat: ParquetRecordWriter [block size: 134217728b, row group padding size: 8388608b, validating: false]
25/12/15 19:13:48 INFO CodeGenerator: Code generated in 54.788051 ms
25/12/15 19:13:48 INFO CodecConfig: Compression: SNAPPY
25/12/15 19:13:48 INFO CodecConfig: Compression: SNAPPY
25/12/15 19:13:48 INFO ParquetOutputFormat: ParquetRecordWriter [block size: 134217728b, row group padding size: 8388608b, validating: false]
25/12/15 19:13:48 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "year",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "month",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_flights",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_del15",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_cancelled",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_diverted",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_minutes",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_count",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional int32 year;
  optional int32 month;
  optional binary carrier (STRING);
  optional binary carrier_name (STRING);
  optional binary airport (STRING);
  optional binary airport_name (STRING);
  optional int32 arr_flights;
  optional int32 arr_del15;
  optional double carrier_ct;
  optional double weather_ct;
  optional double nas_ct;
  optional double security_ct;
  optional double late_aircraft_ct;
  optional int32 arr_cancelled;
  optional int32 arr_diverted;
  optional int32 arr_delay;
  optional int32 carrier_delay;
  optional int32 weather_delay;
  optional int32 nas_delay;
  optional int32 security_delay;
  optional int32 late_aircraft_delay;
  optional int32 total_delay_minutes;
  optional double total_delay_count;
}

       
25/12/15 19:13:48 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "year",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "month",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_flights",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_del15",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_cancelled",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_diverted",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_minutes",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_count",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional int32 year;
  optional int32 month;
  optional binary carrier (STRING);
  optional binary carrier_name (STRING);
  optional binary airport (STRING);
  optional binary airport_name (STRING);
  optional int32 arr_flights;
  optional int32 arr_del15;
  optional double carrier_ct;
  optional double weather_ct;
  optional double nas_ct;
  optional double security_ct;
  optional double late_aircraft_ct;
  optional int32 arr_cancelled;
  optional int32 arr_diverted;
  optional int32 arr_delay;
  optional int32 carrier_delay;
  optional int32 weather_delay;
  optional int32 nas_delay;
  optional int32 security_delay;
  optional int32 late_aircraft_delay;
  optional int32 total_delay_minutes;
  optional double total_delay_count;
}

       
25/12/15 19:13:48 INFO CodecPool: Got brand-new compressor [.snappy]
25/12/15 19:13:48 INFO CodecPool: Got brand-new compressor [.snappy]
25/12/15 19:13:48 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:49 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:38067 in memory (size: 12.8 KiB, free: 413.7 MiB)
25/12/15 19:13:49 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:38067 in memory (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 19:13:49 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:38067 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/15 19:13:49 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:38067 in memory (size: 34.4 KiB, free: 413.8 MiB)
25/12/15 19:13:53 INFO FileOutputCommitter: Saved output of task 'attempt_202512151913473746852560383254470_0002_m_000000_3' to file:/home/ubuntu/airline_project/output/airline_processed_parquet/_temporary/0/task_202512151913473746852560383254470_0002_m_000000
25/12/15 19:13:53 INFO SparkHadoopMapRedUtil: attempt_202512151913473746852560383254470_0002_m_000000_3: Committed. Elapsed time: 3 ms.
25/12/15 19:13:53 INFO FileOutputCommitter: Saved output of task 'attempt_202512151913473746852560383254470_0002_m_000001_4' to file:/home/ubuntu/airline_project/output/airline_processed_parquet/_temporary/0/task_202512151913473746852560383254470_0002_m_000001
25/12/15 19:13:53 INFO SparkHadoopMapRedUtil: attempt_202512151913473746852560383254470_0002_m_000001_4: Committed. Elapsed time: 6 ms.
25/12/15 19:13:53 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2669 bytes result sent to driver
25/12/15 19:13:53 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2669 bytes result sent to driver
25/12/15 19:13:53 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 5358 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:53 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 5359 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:53 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/15 19:13:53 INFO DAGScheduler: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0) finished in 5.402 s
25/12/15 19:13:53 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:53 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
25/12/15 19:13:53 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 5.408981 s
25/12/15 19:13:53 INFO FileFormatWriter: Start to commit write Job cfd11870-ef11-4ea1-9d9e-7bfce14b77dd.
25/12/15 19:13:53 INFO FileFormatWriter: Write Job cfd11870-ef11-4ea1-9d9e-7bfce14b77dd committed. Elapsed time: 17 ms.
25/12/15 19:13:53 INFO FileFormatWriter: Finished processing stats for write job cfd11870-ef11-4ea1-9d9e-7bfce14b77dd.
25/12/15 19:13:53 INFO FileSourceStrategy: Pushed Filters: 
25/12/15 19:13:53 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/15 19:13:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/15 19:13:53 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/15 19:13:53 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/15 19:13:53 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 34.3 KiB, free: 413.8 MiB)
25/12/15 19:13:53 INFO SparkContext: Created broadcast 6 from csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:53 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/15 19:13:53 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/15 19:13:53 INFO DAGScheduler: Got job 3 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/15 19:13:53 INFO DAGScheduler: Final stage: ResultStage 3 (csv at NativeMethodAccessorImpl.java:0)
25/12/15 19:13:53 INFO DAGScheduler: Parents of final stage: List()
25/12/15 19:13:53 INFO DAGScheduler: Missing parents: List()
25/12/15 19:13:53 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[17] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/15 19:13:53 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 229.3 KiB, free 412.9 MiB)
25/12/15 19:13:53 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 80.5 KiB, free 412.9 MiB)
25/12/15 19:13:53 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:38067 (size: 80.5 KiB, free: 413.7 MiB)
25/12/15 19:13:53 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1585
25/12/15 19:13:53 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 3 (MapPartitionsRDD[17] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/15 19:13:53 INFO TaskSchedulerImpl: Adding task set 3.0 with 2 tasks resource profile 0
25/12/15 19:13:53 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:53 INFO TaskSetManager: Starting task 1.0 in stage 3.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/15 19:13:53 INFO Executor: Running task 0.0 in stage 3.0 (TID 5)
25/12/15 19:13:53 INFO Executor: Running task 1.0 in stage 3.0 (TID 6)
25/12/15 19:13:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/15 19:13:53 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/15 19:13:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/15 19:13:53 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/15 19:13:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/15 19:13:53 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/15 19:13:55 INFO FileOutputCommitter: Saved output of task 'attempt_202512151913532203179099025503616_0003_m_000001_6' to file:/home/ubuntu/airline_project/output/airline_processed_csv/_temporary/0/task_202512151913532203179099025503616_0003_m_000001
25/12/15 19:13:55 INFO SparkHadoopMapRedUtil: attempt_202512151913532203179099025503616_0003_m_000001_6: Committed. Elapsed time: 4 ms.
25/12/15 19:13:55 INFO Executor: Finished task 1.0 in stage 3.0 (TID 6). 2626 bytes result sent to driver
25/12/15 19:13:55 INFO TaskSetManager: Finished task 1.0 in stage 3.0 (TID 6) in 2039 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/15 19:13:55 INFO FileOutputCommitter: Saved output of task 'attempt_202512151913532203179099025503616_0003_m_000000_5' to file:/home/ubuntu/airline_project/output/airline_processed_csv/_temporary/0/task_202512151913532203179099025503616_0003_m_000000
25/12/15 19:13:55 INFO SparkHadoopMapRedUtil: attempt_202512151913532203179099025503616_0003_m_000000_5: Committed. Elapsed time: 1 ms.
25/12/15 19:13:55 INFO Executor: Finished task 0.0 in stage 3.0 (TID 5). 2626 bytes result sent to driver
25/12/15 19:13:55 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 5) in 2299 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/15 19:13:55 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
25/12/15 19:13:55 INFO DAGScheduler: ResultStage 3 (csv at NativeMethodAccessorImpl.java:0) finished in 2.333 s
25/12/15 19:13:55 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/15 19:13:55 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
25/12/15 19:13:55 INFO DAGScheduler: Job 3 finished: csv at NativeMethodAccessorImpl.java:0, took 2.341133 s
25/12/15 19:13:55 INFO FileFormatWriter: Start to commit write Job 7d7e2899-fad7-4db3-8208-4888d588f57f.
25/12/15 19:13:55 INFO FileFormatWriter: Write Job 7d7e2899-fad7-4db3-8208-4888d588f57f committed. Elapsed time: 22 ms.
25/12/15 19:13:55 INFO FileFormatWriter: Finished processing stats for write job 7d7e2899-fad7-4db3-8208-4888d588f57f.
25/12/15 19:13:55 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/15 19:13:55 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/15 19:13:55 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/15 19:13:55 INFO MemoryStore: MemoryStore cleared
25/12/15 19:13:55 INFO BlockManager: BlockManager stopped
25/12/15 19:13:55 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/15 19:13:55 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/15 19:13:55 INFO SparkContext: Successfully stopped SparkContext
25/12/15 19:13:56 INFO ShutdownHookManager: Shutdown hook called
25/12/15 19:13:56 INFO ShutdownHookManager: Deleting directory /tmp/spark-cb4148ff-8acd-4cec-a618-1c9c59dec0b8/pyspark-da564f3e-99f9-457f-8b93-7e0d40a9e36a
25/12/15 19:13:56 INFO ShutdownHookManager: Deleting directory /tmp/spark-3900a9b1-0ca6-43d2-bc4d-8b4d9444ddbf
25/12/15 19:13:56 INFO ShutdownHookManager: Deleting directory /tmp/spark-cb4148ff-8acd-4cec-a618-1c9c59dec0b8
Uploading logs to S3...
Completed 199.6 KiB/199.6 KiB (1.7 MiB/s) with 1 file(s) remainingupload: ../pipeline/logs/pipeline_2025-12-15_19-12-09.log to s3://rg422-bigdata/processed/analytics/logs/pipeline_2025-12-15_19-12-09.log
{
    "MessageId": "04e14a39-860d-5422-8da5-2b83e635f8c2"
}
==========================================
âœ… Pipeline completed successfully
==========================================
