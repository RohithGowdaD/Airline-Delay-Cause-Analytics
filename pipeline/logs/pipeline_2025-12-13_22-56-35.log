==========================================
ðŸš€ Pipeline started at Sat Dec 13 22:56:35 UTC 2025
==========================================
[1/5] Ingesting raw data...
25/12/13 22:56:39 INFO SparkContext: Running Spark version 3.5.1
25/12/13 22:56:39 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:56:39 INFO SparkContext: Java version 17.0.17
25/12/13 22:56:39 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/13 22:56:39 INFO ResourceUtils: ==============================================================
25/12/13 22:56:39 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/13 22:56:39 INFO ResourceUtils: ==============================================================
25/12/13 22:56:39 INFO SparkContext: Submitted application: Airline Delay Analysis
25/12/13 22:56:39 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/13 22:56:39 INFO ResourceProfile: Limiting resource is cpu
25/12/13 22:56:39 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/13 22:56:39 INFO SecurityManager: Changing view acls to: ubuntu
25/12/13 22:56:39 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/13 22:56:39 INFO SecurityManager: Changing view acls groups to: 
25/12/13 22:56:39 INFO SecurityManager: Changing modify acls groups to: 
25/12/13 22:56:39 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/13 22:56:39 INFO Utils: Successfully started service 'sparkDriver' on port 37185.
25/12/13 22:56:39 INFO SparkEnv: Registering MapOutputTracker
25/12/13 22:56:39 INFO SparkEnv: Registering BlockManagerMaster
25/12/13 22:56:39 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/13 22:56:39 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/13 22:56:39 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/13 22:56:40 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7f1bddd9-e503-4c08-9ea5-573b6bd6d7f6
25/12/13 22:56:40 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/13 22:56:40 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/13 22:56:40 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/13 22:56:40 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/13 22:56:40 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/13 22:56:40 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:56:40 INFO Executor: Java version 17.0.17
25/12/13 22:56:40 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/13 22:56:40 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/13 22:56:40 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 44475.
25/12/13 22:56:40 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:44475
25/12/13 22:56:40 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/13 22:56:40 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 44475, None)
25/12/13 22:56:40 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:44475 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 44475, None)
25/12/13 22:56:40 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 44475, None)
25/12/13 22:56:40 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 44475, None)
25/12/13 22:56:41 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/13 22:56:41 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/13 22:56:42 INFO InMemoryFileIndex: It took 63 ms to list leaf files for 1 paths.
25/12/13 22:56:42 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
25/12/13 22:56:45 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:56:45 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/13 22:56:46 INFO CodeGenerator: Code generated in 273.144649 ms
25/12/13 22:56:46 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/13 22:56:46 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/13 22:56:46 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 34.4 KiB, free: 413.9 MiB)
25/12/13 22:56:46 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:56:46 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:56:47 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:56:47 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:56:47 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:56:47 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:56:47 INFO DAGScheduler: Missing parents: List()
25/12/13 22:56:47 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:56:47 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/13 22:56:47 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/13 22:56:47 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 6.4 KiB, free: 413.9 MiB)
25/12/13 22:56:47 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/13 22:56:47 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:56:47 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/13 22:56:47 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:56:47 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/13 22:56:47 INFO CodeGenerator: Code generated in 21.911196 ms
25/12/13 22:56:47 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:56:47 INFO CodeGenerator: Code generated in 22.642408 ms
25/12/13 22:56:47 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/13 22:56:47 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 353 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:56:47 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/13 22:56:47 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.528 s
25/12/13 22:56:47 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:56:47 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/13 22:56:47 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.610088 s
25/12/13 22:56:47 INFO CodeGenerator: Code generated in 14.753386 ms
25/12/13 22:56:47 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:56:47 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:56:47 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/13 22:56:47 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/13 22:56:47 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 34.4 KiB, free: 413.9 MiB)
25/12/13 22:56:47 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:56:47 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:56:48 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:56:48 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:56:48 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:56:48 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:56:48 INFO DAGScheduler: Missing parents: List()
25/12/13 22:56:48 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:56:48 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/13 22:56:48 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/13 22:56:48 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:56:48 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/13 22:56:48 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:56:48 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/13 22:56:48 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:56:48 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:56:48 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/13 22:56:48 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/13 22:56:48 INFO CodeGenerator: Code generated in 21.584504 ms
25/12/13 22:56:48 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:56:48 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:56:50 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/13 22:56:50 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2074 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:56:50 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/13 22:56:50 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2265 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:56:50 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/13 22:56:50 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.332 s
25/12/13 22:56:50 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:56:50 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/13 22:56:50 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.346937 s
25/12/13 22:56:50 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:56:50 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:56:50 INFO CodeGenerator: Code generated in 15.907045 ms
25/12/13 22:56:50 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/13 22:56:50 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.2 MiB)
25/12/13 22:56:50 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 34.4 KiB, free: 413.8 MiB)
25/12/13 22:56:50 INFO SparkContext: Created broadcast 4 from count at NativeMethodAccessorImpl.java:0
25/12/13 22:56:50 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:56:50 INFO DAGScheduler: Registering RDD 13 (count at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/13 22:56:50 INFO DAGScheduler: Got map stage job 2 (count at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:56:50 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0)
25/12/13 22:56:50 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:56:50 INFO DAGScheduler: Missing parents: List()
25/12/13 22:56:50 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:56:50 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 18.6 KiB, free 413.2 MiB)
25/12/13 22:56:50 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 9.1 KiB, free 413.2 MiB)
25/12/13 22:56:50 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 9.1 KiB, free: 413.8 MiB)
25/12/13 22:56:50 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/13 22:56:50 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:56:50 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/13 22:56:50 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:56:50 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:56:50 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/13 22:56:50 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/13 22:56:50 INFO CodeGenerator: Code generated in 12.35865 ms
25/12/13 22:56:50 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:56:50 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:56:50 INFO CodeGenerator: Code generated in 8.369156 ms
25/12/13 22:56:51 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 1988 bytes result sent to driver
25/12/13 22:56:51 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2031 bytes result sent to driver
25/12/13 22:56:51 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 467 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:56:51 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 468 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:56:51 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/13 22:56:51 INFO DAGScheduler: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0) finished in 0.506 s
25/12/13 22:56:51 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:56:51 INFO DAGScheduler: running: Set()
25/12/13 22:56:51 INFO DAGScheduler: waiting: Set()
25/12/13 22:56:51 INFO DAGScheduler: failed: Set()
25/12/13 22:56:51 INFO CodeGenerator: Code generated in 12.126367 ms
25/12/13 22:56:51 INFO SparkContext: Starting job: count at NativeMethodAccessorImpl.java:0
25/12/13 22:56:51 INFO DAGScheduler: Got job 3 (count at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:56:51 INFO DAGScheduler: Final stage: ResultStage 4 (count at NativeMethodAccessorImpl.java:0)
25/12/13 22:56:51 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/13 22:56:51 INFO DAGScheduler: Missing parents: List()
25/12/13 22:56:51 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:56:51 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 12.5 KiB, free 413.2 MiB)
25/12/13 22:56:51 INFO BlockManagerInfo: Removed broadcast_5_piece0 on ip-172-31-64-111.ec2.internal:44475 in memory (size: 9.1 KiB, free: 413.8 MiB)
25/12/13 22:56:51 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 413.2 MiB)
25/12/13 22:56:51 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 5.9 KiB, free: 413.8 MiB)
25/12/13 22:56:51 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/13 22:56:51 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:56:51 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/13 22:56:51 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:56:51 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/13 22:56:51 INFO ShuffleBlockFetcherIterator: Getting 2 (120.0 B) non-empty blocks including 2 (120.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:56:51 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 14 ms
25/12/13 22:56:51 INFO CodeGenerator: Code generated in 26.934779 ms
25/12/13 22:56:51 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 3995 bytes result sent to driver
25/12/13 22:56:51 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 104 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:56:51 INFO DAGScheduler: ResultStage 4 (count at NativeMethodAccessorImpl.java:0) finished in 0.126 s
25/12/13 22:56:51 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:56:51 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/13 22:56:51 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/13 22:56:51 INFO DAGScheduler: Job 3 finished: count at NativeMethodAccessorImpl.java:0, took 0.149162 s
Number of rows: 318017
Schema:
root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- carrier_name: string (nullable = true)
 |-- airport: string (nullable = true)
 |-- airport_name: string (nullable = true)
 |-- arr_flights: integer (nullable = true)
 |-- arr_del15: integer (nullable = true)
 |-- carrier_ct: double (nullable = true)
 |-- weather_ct: double (nullable = true)
 |-- nas_ct: double (nullable = true)
 |-- security_ct: double (nullable = true)
 |-- late_aircraft_ct: double (nullable = true)
 |-- arr_cancelled: integer (nullable = true)
 |-- arr_diverted: integer (nullable = true)
 |-- arr_delay: integer (nullable = true)
 |-- carrier_delay: integer (nullable = true)
 |-- weather_delay: integer (nullable = true)
 |-- nas_delay: integer (nullable = true)
 |-- security_delay: integer (nullable = true)
 |-- late_aircraft_delay: integer (nullable = true)

25/12/13 22:56:51 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:56:51 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:56:51 INFO CodeGenerator: Code generated in 77.164556 ms
25/12/13 22:56:51 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.0 MiB)
25/12/13 22:56:51 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:44475 in memory (size: 5.9 KiB, free: 413.8 MiB)
25/12/13 22:56:51 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.0 MiB)
25/12/13 22:56:51 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 34.4 KiB, free: 413.8 MiB)
25/12/13 22:56:51 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:56:51 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:56:51 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:56:51 INFO DAGScheduler: Got job 4 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:56:51 INFO DAGScheduler: Final stage: ResultStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:56:51 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:56:51 INFO DAGScheduler: Missing parents: List()
25/12/13 22:56:51 INFO DAGScheduler: Submitting ResultStage 5 (MapPartitionsRDD[20] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:56:51 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 25.1 KiB, free 412.9 MiB)
25/12/13 22:56:51 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 9.6 KiB, free 412.9 MiB)
25/12/13 22:56:51 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:44475 (size: 9.6 KiB, free: 413.8 MiB)
25/12/13 22:56:51 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/13 22:56:51 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 5 (MapPartitionsRDD[20] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:56:51 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
25/12/13 22:56:51 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:56:51 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/13 22:56:51 INFO CodeGenerator: Code generated in 45.69059 ms
25/12/13 22:56:51 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:56:52 INFO CodeGenerator: Code generated in 49.25925 ms
25/12/13 22:56:52 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 3559 bytes result sent to driver
25/12/13 22:56:52 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 163 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:56:52 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/13 22:56:52 INFO DAGScheduler: ResultStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 0.179 s
25/12/13 22:56:52 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:56:52 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
25/12/13 22:56:52 INFO DAGScheduler: Job 4 finished: showString at NativeMethodAccessorImpl.java:0, took 0.186250 s
25/12/13 22:56:52 INFO BlockManagerInfo: Removed broadcast_8_piece0 on ip-172-31-64-111.ec2.internal:44475 in memory (size: 9.6 KiB, free: 413.8 MiB)
25/12/13 22:56:52 INFO CodeGenerator: Code generated in 41.968268 ms
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
|year|month|carrier|carrier_name     |airport|airport_name                                               |arr_flights|arr_del15|carrier_ct|weather_ct|nas_ct|security_ct|late_aircraft_ct|arr_cancelled|arr_diverted|arr_delay|carrier_delay|weather_delay|nas_delay|security_delay|late_aircraft_delay|
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
|2022|5    |9E     |Endeavor Air Inc.|ABE    |Allentown/Bethlehem/Easton, PA: Lehigh Valley International|136        |7        |5.95      |0.0       |0.05  |0.0        |1.0             |0            |0           |255      |222          |0            |4        |0             |29                 |
|2022|5    |9E     |Endeavor Air Inc.|ABY    |Albany, GA: Southwest Georgia Regional                     |91         |16       |7.38      |0.0       |2.54  |0.0        |6.09            |0            |0           |884      |351          |0            |81       |0             |452                |
|2022|5    |9E     |Endeavor Air Inc.|ACK    |Nantucket, MA: Nantucket Memorial                          |19         |2        |0.13      |0.0       |1.0   |0.0        |0.88            |1            |0           |138      |4            |0            |106      |0             |28                 |
|2022|5    |9E     |Endeavor Air Inc.|AEX    |Alexandria, LA: Alexandria International                   |88         |14       |7.26      |0.76      |4.35  |0.0        |1.64            |0            |0           |947      |585          |35           |125      |0             |202                |
|2022|5    |9E     |Endeavor Air Inc.|AGS    |Augusta, GA: Augusta Regional at Bush Field                |181        |19       |13.84     |0.0       |3.07  |0.0        |2.09            |0            |0           |808      |662          |0            |87       |0             |59                 |
|2022|5    |9E     |Endeavor Air Inc.|ALB    |Albany, NY: Albany International                           |134        |18       |4.42      |1.0       |6.48  |0.0        |6.09            |5            |0           |917      |224          |78           |398      |0             |217                |
|2022|5    |9E     |Endeavor Air Inc.|ATL    |Atlanta, GA: Hartsfield-Jackson Atlanta International      |3042       |453      |142.96    |13.53     |106.98|0.0        |189.53          |2            |3           |38397    |20775        |1205         |3610     |0             |12807              |
|2022|5    |9E     |Endeavor Air Inc.|ATW    |Appleton, WI: Appleton International                       |118        |13       |4.83      |0.0       |6.85  |0.0        |1.32            |0            |0           |914      |578          |0            |171      |0             |165                |
|2022|5    |9E     |Endeavor Air Inc.|AUS    |Austin, TX: Austin - Bergstrom International               |53         |8        |5.23      |1.0       |0.89  |0.0        |0.88            |1            |0           |582      |445          |20           |19       |0             |98                 |
|2022|5    |9E     |Endeavor Air Inc.|AVL    |Asheville, NC: Asheville Regional                          |58         |14       |4.54      |0.0       |7.61  |0.0        |1.85            |1            |0           |996      |290          |0            |618      |0             |88                 |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+
only showing top 10 rows

25/12/13 22:56:52 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/13 22:56:52 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/13 22:56:52 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/13 22:56:52 INFO MemoryStore: MemoryStore cleared
25/12/13 22:56:52 INFO BlockManager: BlockManager stopped
25/12/13 22:56:52 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/13 22:56:52 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/13 22:56:52 INFO SparkContext: Successfully stopped SparkContext
25/12/13 22:56:52 INFO ShutdownHookManager: Shutdown hook called
25/12/13 22:56:52 INFO ShutdownHookManager: Deleting directory /tmp/spark-75751347-45e1-45b6-976c-95ee07f43030
25/12/13 22:56:52 INFO ShutdownHookManager: Deleting directory /tmp/spark-75751347-45e1-45b6-976c-95ee07f43030/pyspark-096a81e5-9dbc-48dd-9a9c-bf19c9884757
25/12/13 22:56:52 INFO ShutdownHookManager: Deleting directory /tmp/spark-d1710cc6-ebad-4eba-bd4f-723d5347183f
[2/5] Transforming data...
25/12/13 22:56:56 INFO SparkContext: Running Spark version 3.5.1
25/12/13 22:56:56 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:56:56 INFO SparkContext: Java version 17.0.17
25/12/13 22:56:57 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/13 22:56:57 INFO ResourceUtils: ==============================================================
25/12/13 22:56:57 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/13 22:56:57 INFO ResourceUtils: ==============================================================
25/12/13 22:56:57 INFO SparkContext: Submitted application: Airline Transform
25/12/13 22:56:57 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/13 22:56:57 INFO ResourceProfile: Limiting resource is cpu
25/12/13 22:56:57 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/13 22:56:57 INFO SecurityManager: Changing view acls to: ubuntu
25/12/13 22:56:57 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/13 22:56:57 INFO SecurityManager: Changing view acls groups to: 
25/12/13 22:56:57 INFO SecurityManager: Changing modify acls groups to: 
25/12/13 22:56:57 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/13 22:56:57 INFO Utils: Successfully started service 'sparkDriver' on port 35537.
25/12/13 22:56:57 INFO SparkEnv: Registering MapOutputTracker
25/12/13 22:56:57 INFO SparkEnv: Registering BlockManagerMaster
25/12/13 22:56:57 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/13 22:56:57 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/13 22:56:57 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/13 22:56:58 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-c8a33ff5-86c0-4ee6-9b8f-77922e5ebcc3
25/12/13 22:56:58 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/13 22:56:58 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/13 22:56:58 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/13 22:56:58 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/13 22:56:58 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/13 22:56:58 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:56:58 INFO Executor: Java version 17.0.17
25/12/13 22:56:58 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/13 22:56:58 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@2b04731f for default.
25/12/13 22:56:58 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 36975.
25/12/13 22:56:58 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:36975
25/12/13 22:56:58 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/13 22:56:58 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36975, None)
25/12/13 22:56:58 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:36975 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36975, None)
25/12/13 22:56:58 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36975, None)
25/12/13 22:56:58 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36975, None)
25/12/13 22:56:59 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/13 22:56:59 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/13 22:57:00 INFO InMemoryFileIndex: It took 59 ms to list leaf files for 1 paths.
25/12/13 22:57:01 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/13 22:57:04 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:04 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/13 22:57:05 INFO CodeGenerator: Code generated in 281.050167 ms
25/12/13 22:57:05 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/13 22:57:05 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/13 22:57:05 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:36975 (size: 34.4 KiB, free: 413.9 MiB)
25/12/13 22:57:05 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:05 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:05 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:05 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:05 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:05 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:05 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:05 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:05 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/13 22:57:05 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/13 22:57:05 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:36975 (size: 6.4 KiB, free: 413.9 MiB)
25/12/13 22:57:05 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:05 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:05 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/13 22:57:05 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:05 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/13 22:57:05 INFO CodeGenerator: Code generated in 17.748032 ms
25/12/13 22:57:05 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:05 INFO CodeGenerator: Code generated in 20.474793 ms
25/12/13 22:57:06 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/13 22:57:06 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 314 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:06 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/13 22:57:06 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.476 s
25/12/13 22:57:06 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:06 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/13 22:57:06 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.538977 s
25/12/13 22:57:06 INFO CodeGenerator: Code generated in 11.999268 ms
25/12/13 22:57:06 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:06 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:57:06 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/13 22:57:06 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/13 22:57:06 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:36975 (size: 34.4 KiB, free: 413.9 MiB)
25/12/13 22:57:06 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:06 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:06 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:06 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:06 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:06 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:06 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:06 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:06 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/13 22:57:06 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/13 22:57:06 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:36975 (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:57:06 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:06 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:06 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/13 22:57:06 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:06 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:06 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/13 22:57:06 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/13 22:57:06 INFO CodeGenerator: Code generated in 10.720132 ms
25/12/13 22:57:06 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:06 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:08 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/13 22:57:09 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2621 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:09 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/13 22:57:09 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2784 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:09 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/13 22:57:09 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.847 s
25/12/13 22:57:09 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:09 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/13 22:57:09 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.862346 s
root
 |-- year: integer (nullable = true)
 |-- month: integer (nullable = true)
 |-- carrier: string (nullable = true)
 |-- carrier_name: string (nullable = true)
 |-- airport: string (nullable = true)
 |-- airport_name: string (nullable = true)
 |-- arr_flights: integer (nullable = true)
 |-- arr_del15: integer (nullable = true)
 |-- carrier_ct: double (nullable = true)
 |-- weather_ct: double (nullable = true)
 |-- nas_ct: double (nullable = true)
 |-- security_ct: double (nullable = true)
 |-- late_aircraft_ct: double (nullable = true)
 |-- arr_cancelled: integer (nullable = true)
 |-- arr_diverted: integer (nullable = true)
 |-- arr_delay: integer (nullable = true)
 |-- carrier_delay: integer (nullable = true)
 |-- weather_delay: integer (nullable = true)
 |-- nas_delay: integer (nullable = true)
 |-- security_delay: integer (nullable = true)
 |-- late_aircraft_delay: integer (nullable = true)
 |-- total_delay_minutes: integer (nullable = true)
 |-- total_delay_count: double (nullable = true)

25/12/13 22:57:09 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:09 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:09 INFO CodeGenerator: Code generated in 134.076283 ms
25/12/13 22:57:09 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/13 22:57:09 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/13 22:57:09 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:36975 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:09 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:09 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:09 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:09 INFO DAGScheduler: Got job 2 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:09 INFO DAGScheduler: Final stage: ResultStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:09 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:09 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:09 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:09 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 30.4 KiB, free 413.2 MiB)
25/12/13 22:57:09 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 10.5 KiB, free 413.1 MiB)
25/12/13 22:57:09 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:36975 (size: 10.5 KiB, free: 413.8 MiB)
25/12/13 22:57:09 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:09 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:09 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks resource profile 0
25/12/13 22:57:09 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:09 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/13 22:57:09 INFO CodeGenerator: Code generated in 95.43323 ms
25/12/13 22:57:09 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:10 INFO CodeGenerator: Code generated in 54.082106 ms
25/12/13 22:57:10 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 3854 bytes result sent to driver
25/12/13 22:57:10 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 256 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:10 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/13 22:57:10 INFO DAGScheduler: ResultStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 0.282 s
25/12/13 22:57:10 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:10 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
25/12/13 22:57:10 INFO DAGScheduler: Job 2 finished: showString at NativeMethodAccessorImpl.java:0, took 0.294451 s
25/12/13 22:57:10 INFO CodeGenerator: Code generated in 52.962291 ms
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
|year|month|carrier|carrier_name     |airport|airport_name                                               |arr_flights|arr_del15|carrier_ct|weather_ct|nas_ct|security_ct|late_aircraft_ct|arr_cancelled|arr_diverted|arr_delay|carrier_delay|weather_delay|nas_delay|security_delay|late_aircraft_delay|total_delay_minutes|total_delay_count |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
|2022|5    |9E     |Endeavor Air Inc.|ABE    |Allentown/Bethlehem/Easton, PA: Lehigh Valley International|136        |7        |5.95      |0.0       |0.05  |0.0        |1.0             |0            |0           |255      |222          |0            |4        |0             |29                 |255                |7.0               |
|2022|5    |9E     |Endeavor Air Inc.|ABY    |Albany, GA: Southwest Georgia Regional                     |91         |16       |7.38      |0.0       |2.54  |0.0        |6.09            |0            |0           |884      |351          |0            |81       |0             |452                |884                |16.009999999999998|
|2022|5    |9E     |Endeavor Air Inc.|ACK    |Nantucket, MA: Nantucket Memorial                          |19         |2        |0.13      |0.0       |1.0   |0.0        |0.88            |1            |0           |138      |4            |0            |106      |0             |28                 |138                |2.01              |
|2022|5    |9E     |Endeavor Air Inc.|AEX    |Alexandria, LA: Alexandria International                   |88         |14       |7.26      |0.76      |4.35  |0.0        |1.64            |0            |0           |947      |585          |35           |125      |0             |202                |947                |14.01             |
|2022|5    |9E     |Endeavor Air Inc.|AGS    |Augusta, GA: Augusta Regional at Bush Field                |181        |19       |13.84     |0.0       |3.07  |0.0        |2.09            |0            |0           |808      |662          |0            |87       |0             |59                 |808                |19.0              |
|2022|5    |9E     |Endeavor Air Inc.|ALB    |Albany, NY: Albany International                           |134        |18       |4.42      |1.0       |6.48  |0.0        |6.09            |5            |0           |917      |224          |78           |398      |0             |217                |917                |17.990000000000002|
|2022|5    |9E     |Endeavor Air Inc.|ATL    |Atlanta, GA: Hartsfield-Jackson Atlanta International      |3042       |453      |142.96    |13.53     |106.98|0.0        |189.53          |2            |3           |38397    |20775        |1205         |3610     |0             |12807              |38397              |453.0             |
|2022|5    |9E     |Endeavor Air Inc.|ATW    |Appleton, WI: Appleton International                       |118        |13       |4.83      |0.0       |6.85  |0.0        |1.32            |0            |0           |914      |578          |0            |171      |0             |165                |914                |13.0              |
|2022|5    |9E     |Endeavor Air Inc.|AUS    |Austin, TX: Austin - Bergstrom International               |53         |8        |5.23      |1.0       |0.89  |0.0        |0.88            |1            |0           |582      |445          |20           |19       |0             |98                 |582                |8.0               |
|2022|5    |9E     |Endeavor Air Inc.|AVL    |Asheville, NC: Ash25/12/13 22:57:10 INFO SparkContext: SparkContext is stopping with exitCode 0.
eville Regional                          |58         |14       |4.54      |0.0       |7.61  |0.0        |1.85            |1            |0           |996      |290          |0            |618      |0             |88                 |996                |14.0              |
+----+-----+-------+-----------------+-------+-----------------------------------------------------------+-----------+---------+----------+----------+------+-----------+----------------+-------------+------------+---------+-------------+-------------+---------+--------------+-------------------+-------------------+------------------+
only showing top 10 rows

25/12/13 22:57:10 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/13 22:57:10 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/13 22:57:10 INFO MemoryStore: MemoryStore cleared
25/12/13 22:57:10 INFO BlockManager: BlockManager stopped
25/12/13 22:57:10 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/13 22:57:10 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/13 22:57:10 INFO SparkContext: Successfully stopped SparkContext
25/12/13 22:57:10 INFO ShutdownHookManager: Shutdown hook called
25/12/13 22:57:10 INFO ShutdownHookManager: Deleting directory /tmp/spark-92f77086-0324-43f3-adce-1b435ecabe41
25/12/13 22:57:10 INFO ShutdownHookManager: Deleting directory /tmp/spark-92f77086-0324-43f3-adce-1b435ecabe41/pyspark-f7a23d3b-0824-4777-a809-a209ec0fccae
25/12/13 22:57:10 INFO ShutdownHookManager: Deleting directory /tmp/spark-c49d73da-4cf5-4040-92cc-f4d271388472
[3/5] Computing metrics...
25/12/13 22:57:14 INFO SparkContext: Running Spark version 3.5.1
25/12/13 22:57:14 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:57:14 INFO SparkContext: Java version 17.0.17
25/12/13 22:57:14 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/13 22:57:14 INFO ResourceUtils: ==============================================================
25/12/13 22:57:14 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/13 22:57:14 INFO ResourceUtils: ==============================================================
25/12/13 22:57:14 INFO SparkContext: Submitted application: Airline Metrics
25/12/13 22:57:14 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/13 22:57:14 INFO ResourceProfile: Limiting resource is cpu
25/12/13 22:57:14 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/13 22:57:15 INFO SecurityManager: Changing view acls to: ubuntu
25/12/13 22:57:15 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/13 22:57:15 INFO SecurityManager: Changing view acls groups to: 
25/12/13 22:57:15 INFO SecurityManager: Changing modify acls groups to: 
25/12/13 22:57:15 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/13 22:57:15 INFO Utils: Successfully started service 'sparkDriver' on port 41815.
25/12/13 22:57:15 INFO SparkEnv: Registering MapOutputTracker
25/12/13 22:57:15 INFO SparkEnv: Registering BlockManagerMaster
25/12/13 22:57:15 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/13 22:57:15 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/13 22:57:15 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/13 22:57:15 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-60fd501f-a65b-49f0-bb83-467603fcfbe8
25/12/13 22:57:15 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/13 22:57:15 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/13 22:57:15 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/13 22:57:16 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/13 22:57:16 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/13 22:57:16 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:57:16 INFO Executor: Java version 17.0.17
25/12/13 22:57:16 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/13 22:57:16 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/13 22:57:16 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 36671.
25/12/13 22:57:16 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:36671
25/12/13 22:57:16 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/13 22:57:16 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36671, None)
25/12/13 22:57:16 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:36671 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36671, None)
25/12/13 22:57:16 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36671, None)
25/12/13 22:57:16 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 36671, None)
25/12/13 22:57:17 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/13 22:57:17 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/13 22:57:18 INFO InMemoryFileIndex: It took 69 ms to list leaf files for 1 paths.
25/12/13 22:57:18 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
25/12/13 22:57:21 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:21 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/13 22:57:22 INFO CodeGenerator: Code generated in 225.150421 ms
25/12/13 22:57:22 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/13 22:57:22 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.7 MiB)
25/12/13 22:57:22 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.9 MiB)
25/12/13 22:57:22 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:22 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:22 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:22 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:22 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:22 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:22 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:22 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:22 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/13 22:57:22 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/13 22:57:22 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 6.4 KiB, free: 413.9 MiB)
25/12/13 22:57:22 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:22 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/13 22:57:22 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:22 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/13 22:57:22 INFO CodeGenerator: Code generated in 20.333706 ms
25/12/13 22:57:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:22 INFO CodeGenerator: Code generated in 10.315365 ms
25/12/13 22:57:22 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/13 22:57:22 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 279 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:22 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/13 22:57:22 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.434 s
25/12/13 22:57:22 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/13 22:57:22 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.493068 s
25/12/13 22:57:22 INFO CodeGenerator: Code generated in 13.455209 ms
25/12/13 22:57:23 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:23 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:57:23 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/13 22:57:23 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/13 22:57:23 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.9 MiB)
25/12/13 22:57:23 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:23 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:23 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:23 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:23 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:23 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:23 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:23 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/13 22:57:23 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/13 22:57:23 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:57:23 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:23 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:23 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/13 22:57:23 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:23 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:23 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/13 22:57:23 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/13 22:57:23 INFO CodeGenerator: Code generated in 10.159816 ms
25/12/13 22:57:23 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:23 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:25 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/13 22:57:25 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2665 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:26 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/13 22:57:26 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2791 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:26 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/13 22:57:26 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.854 s
25/12/13 22:57:26 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/13 22:57:26 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.868089 s
25/12/13 22:57:26 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:26 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:26 INFO CodeGenerator: Code generated in 113.278596 ms
25/12/13 22:57:26 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/13 22:57:26 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/13 22:57:26 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:26 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:27 INFO DAGScheduler: Registering RDD 13 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/13 22:57:27 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:27 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:27 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:27 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:27 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:27 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 55.5 KiB, free 413.1 MiB)
25/12/13 22:57:27 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 23.4 KiB, free 413.1 MiB)
25/12/13 22:57:27 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 23.4 KiB, free: 413.8 MiB)
25/12/13 22:57:27 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:27 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:27 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/13 22:57:27 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:27 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:27 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/13 22:57:27 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/13 22:57:27 INFO CodeGenerator: Code generated in 111.465168 ms
25/12/13 22:57:27 INFO CodeGenerator: Code generated in 25.053671 ms
25/12/13 22:57:27 INFO CodeGenerator: Code generated in 24.968102 ms
25/12/13 22:57:27 INFO CodeGenerator: Code generated in 14.297592 ms
25/12/13 22:57:27 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:27 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:27 INFO CodeGenerator: Code generated in 43.284322 ms
25/12/13 22:57:27 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:27 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:57:27 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/13 22:57:27 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/13 22:57:29 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2884 bytes result sent to driver
25/12/13 22:57:29 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 2387 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:29 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2841 bytes result sent to driver
25/12/13 22:57:29 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 2482 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:29 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/13 22:57:29 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 2.518 s
25/12/13 22:57:29 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:29 INFO DAGScheduler: running: Set()
25/12/13 22:57:29 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:29 INFO DAGScheduler: failed: Set()
25/12/13 22:57:29 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:29 INFO CodeGenerator: Code generated in 18.846931 ms
25/12/13 22:57:29 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:29 INFO CodeGenerator: Code generated in 40.108791 ms
25/12/13 22:57:29 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:29 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:29 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:29 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/13 22:57:29 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:29 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:29 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 56.1 KiB, free 413.6 MiB)
25/12/13 22:57:29 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 413.5 MiB)
25/12/13 22:57:29 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 24.3 KiB, free: 413.8 MiB)
25/12/13 22:57:29 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:29 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:29 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/13 22:57:29 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:29 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/13 22:57:29 INFO CodeGenerator: Code generated in 12.571475 ms
25/12/13 22:57:29 INFO ShuffleBlockFetcherIterator: Getting 2 (4.5 KiB) non-empty blocks including 2 (4.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:29 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 16 ms
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 31.624029 ms
25/12/13 22:57:30 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 5840 bytes result sent to driver
25/12/13 22:57:30 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 201 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:30 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/13 22:57:30 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.228 s
25/12/13 22:57:30 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/13 22:57:30 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.266362 s
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 8.257481 ms
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 7.722273 ms
+----------------------------+-----------+
|carrier_name                |total_delay|
+----------------------------+-----------+
|Southwest Airlines Co.      |197589768  |
|American Airlines Inc.      |158749715  |
|SkyWest Airlines Inc.       |126613903  |
|Delta Air Lines Inc.        |125894776  |
|United Air Lines Inc.       |114178620  |
|ExpressJet Airlines Inc.    |98092859   |
|American Eagle Airlines Inc.|64419820   |
|JetBlue Airways             |62841558   |
|US Airways Inc.             |48308565   |
|Atlantic Southeast Airlines |36380279   |
+----------------------------+-----------+
only showing top 10 rows

25/12/13 22:57:30 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:30 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 80.936719 ms
25/12/13 22:57:30 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.3 MiB)
25/12/13 22:57:30 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.3 MiB)
25/12/13 22:57:30 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:30 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:30 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:30 INFO DAGScheduler: Registering RDD 21 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
25/12/13 22:57:30 INFO DAGScheduler: Got map stage job 4 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:30 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:30 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:30 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:30 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:30 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 56.9 KiB, free 413.3 MiB)
25/12/13 22:57:30 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 413.2 MiB)
25/12/13 22:57:30 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 23.9 KiB, free: 413.8 MiB)
25/12/13 22:57:30 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:30 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:30 INFO TaskSchedulerImpl: Adding task set 5.0 with 2 tasks resource profile 0
25/12/13 22:57:30 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:30 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 7) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:30 INFO Executor: Running task 1.0 in stage 5.0 (TID 7)
25/12/13 22:57:30 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/13 22:57:30 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 24.3 KiB, free: 413.8 MiB)
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 95.035011 ms
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 9.062502 ms
25/12/13 22:57:30 INFO CodeGenerator: Code generated in 8.728676 ms
25/12/13 22:57:30 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:30 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:31 INFO Executor: Finished task 1.0 in stage 5.0 (TID 7). 2841 bytes result sent to driver
25/12/13 22:57:31 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 7) in 1491 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:32 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 2841 bytes result sent to driver
25/12/13 22:57:32 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 1683 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:32 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/13 22:57:32 INFO DAGScheduler: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 1.701 s
25/12/13 22:57:32 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:32 INFO DAGScheduler: running: Set()
25/12/13 22:57:32 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:32 INFO DAGScheduler: failed: Set()
25/12/13 22:57:32 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 9.423671 ms
25/12/13 22:57:32 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 17.241672 ms
25/12/13 22:57:32 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:32 INFO DAGScheduler: Got job 5 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:32 INFO DAGScheduler: Final stage: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:32 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/12/13 22:57:32 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:32 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:32 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 57.9 KiB, free 413.3 MiB)
25/12/13 22:57:32 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 413.2 MiB)
25/12/13 22:57:32 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 24.9 KiB, free: 413.8 MiB)
25/12/13 22:57:32 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:32 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/12/13 22:57:32 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 8) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:32 INFO Executor: Running task 0.0 in stage 7.0 (TID 8)
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 11.010107 ms
25/12/13 22:57:32 INFO ShuffleBlockFetcherIterator: Getting 2 (59.8 KiB) non-empty blocks including 2 (59.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:32 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 4 ms
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 19.75277 ms
25/12/13 22:57:32 INFO Executor: Finished task 0.0 in stage 7.0 (TID 8). 6090 bytes result sent to driver
25/12/13 22:57:32 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 8) in 102 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:32 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/12/13 22:57:32 INFO DAGScheduler: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0) finished in 0.123 s
25/12/13 22:57:32 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:32 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/12/13 22:57:32 INFO DAGScheduler: Job 5 finished: showString at NativeMethodAccessorImpl.java:0, took 0.145341 s
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 8.615785 ms
+------------------------------------------------------+------------------+
|airport_name                                          |avg_delay         |
+------------------------------------------------------+------------------+
|Chicago, IL: Chicago O'Hare International             |31867.799072091362|
|Atlanta, GA: Hartsfield-Jackson Atlanta International |27830.672919508866|
|Dallas/Fort Worth, TX: Dallas/Fort Worth International|20571.237798546208|
|Newark, NJ: Newark Liberty International              |17511.09181784524 |
|San Francisco, CA: San Francisco International        |16140.159023668639|
|Sanford, FL: Orlando Sanford International            |16041.452830188678|
|Denver, CO: Denver International                      |15025.973445143256|
|New York, NY: John F. Kennedy International           |14642.515225933203|
|Los Angeles, CA: Los Angeles International            |13589.449129852745|
|Houston, TX: George Bush Intercontinental/Houston     |13375.582714118107|
+------------------------------------------------------+------------------+
only showing top 10 rows

25/12/13 22:57:32 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:32 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:32 INFO BlockManagerInfo: Removed broadcast_9_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 24.9 KiB, free: 413.8 MiB)
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 52.016502 ms
25/12/13 22:57:32 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 199.5 KiB, free 413.1 MiB)
25/12/13 22:57:32 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.1 MiB)
25/12/13 22:57:32 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:32 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:32 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:32 INFO DAGScheduler: Registering RDD 29 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/12/13 22:57:32 INFO DAGScheduler: Got map stage job 6 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:32 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:32 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:32 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:32 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:32 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 55.2 KiB, free 413.0 MiB)
25/12/13 22:57:32 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 23.2 KiB, free 413.0 MiB)
25/12/13 22:57:32 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 23.2 KiB, free: 413.8 MiB)
25/12/13 22:57:32 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:32 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:32 INFO TaskSchedulerImpl: Adding task set 8.0 with 2 tasks resource profile 0
25/12/13 22:57:32 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 9) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:32 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 10) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:32 INFO Executor: Running task 1.0 in stage 8.0 (TID 10)
25/12/13 22:57:32 INFO Executor: Running task 0.0 in stage 8.0 (TID 9)
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 32.416996 ms
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 8.378373 ms
25/12/13 22:57:32 INFO CodeGenerator: Code generated in 5.645266 ms
25/12/13 22:57:32 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:32 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:33 INFO Executor: Finished task 1.0 in stage 8.0 (TID 10). 2841 bytes result sent to driver
25/12/13 22:57:33 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 10) in 1330 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:33 INFO Executor: Finished task 0.0 in stage 8.0 (TID 9). 2841 bytes result sent to driver
25/12/13 22:57:33 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 9) in 1419 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:33 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/12/13 22:57:33 INFO DAGScheduler: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0) finished in 1.432 s
25/12/13 22:57:33 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:33 INFO DAGScheduler: running: Set()
25/12/13 22:57:33 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:33 INFO DAGScheduler: failed: Set()
25/12/13 22:57:33 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 11.752546 ms
25/12/13 22:57:34 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 26.109578 ms
25/12/13 22:57:34 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:34 INFO DAGScheduler: Got job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:34 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:34 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/12/13 22:57:34 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:34 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:34 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 56.0 KiB, free 413.0 MiB)
25/12/13 22:57:34 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 24.2 KiB, free 412.9 MiB)
25/12/13 22:57:34 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 24.2 KiB, free: 413.7 MiB)
25/12/13 22:57:34 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:34 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:34 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/12/13 22:57:34 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 11) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:34 INFO Executor: Running task 0.0 in stage 10.0 (TID 11)
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 5.679748 ms
25/12/13 22:57:34 INFO ShuffleBlockFetcherIterator: Getting 2 (1386.0 B) non-empty blocks including 2 (1386.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:34 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 13.393869 ms
25/12/13 22:57:34 INFO Executor: Finished task 0.0 in stage 10.0 (TID 11). 5576 bytes result sent to driver
25/12/13 22:57:34 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 11) in 46 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:34 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/12/13 22:57:34 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.061 s
25/12/13 22:57:34 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:34 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/12/13 22:57:34 INFO DAGScheduler: Job 7 finished: showString at NativeMethodAccessorImpl.java:0, took 0.068411 s
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 7.715821 ms
+----+------------+
|year|yearly_delay|
+----+------------+
|2003|32535792    |
|2004|73088325    |
|2005|76476224    |
|2006|87187039    |
|2007|100965732   |
|2008|86637993    |
|2009|66005819    |
|2010|63257498    |
|2011|61670561    |
|2012|56916692    |
+----+------------+
only showing top 10 rows

25/12/13 22:57:34 INFO BlockManagerInfo: Removed broadcast_12_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 24.2 KiB, free: 413.8 MiB)
25/12/13 22:57:34 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:34 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 43.329067 ms
25/12/13 22:57:34 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 199.5 KiB, free 412.8 MiB)
25/12/13 22:57:34 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.8 MiB)
25/12/13 22:57:34 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.7 MiB)
25/12/13 22:57:34 INFO SparkContext: Created broadcast 13 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:34 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:34 INFO DAGScheduler: Registering RDD 37 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/12/13 22:57:34 INFO DAGScheduler: Got map stage job 8 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:34 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:34 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:34 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:34 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:34 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 55.2 KiB, free 412.7 MiB)
25/12/13 22:57:34 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 23.2 KiB, free 412.7 MiB)
25/12/13 22:57:34 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 23.2 KiB, free: 413.7 MiB)
25/12/13 22:57:34 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:34 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:34 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
25/12/13 22:57:34 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 12) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:34 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 13) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:34 INFO Executor: Running task 0.0 in stage 11.0 (TID 12)
25/12/13 22:57:34 INFO Executor: Running task 1.0 in stage 11.0 (TID 13)
25/12/13 22:57:34 INFO CodeGenerator: Code generated in 50.329006 ms
25/12/13 22:57:34 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:34 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:35 INFO Executor: Finished task 1.0 in stage 11.0 (TID 13). 2841 bytes result sent to driver
25/12/13 22:57:35 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 13) in 1199 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:35 INFO Executor: Finished task 0.0 in stage 11.0 (TID 12). 2841 bytes result sent to driver
25/12/13 22:57:35 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 12) in 1294 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:35 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
25/12/13 22:57:35 INFO DAGScheduler: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 1.307 s
25/12/13 22:57:35 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:35 INFO DAGScheduler: running: Set()
25/12/13 22:57:35 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:35 INFO DAGScheduler: failed: Set()
25/12/13 22:57:35 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:35 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:35 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:35 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:35 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:35 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
25/12/13 22:57:35 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:35 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:35 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 56.0 KiB, free 412.6 MiB)
25/12/13 22:57:35 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 412.6 MiB)
25/12/13 22:57:35 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 24.3 KiB, free: 413.7 MiB)
25/12/13 22:57:35 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:35 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:35 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
25/12/13 22:57:35 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:35 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
25/12/13 22:57:35 INFO ShuffleBlockFetcherIterator: Getting 2 (1584.0 B) non-empty blocks including 2 (1584.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:35 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/13 22:57:35 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5576 bytes result sent to driver
25/12/13 22:57:35 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 26 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:35 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
25/12/13 22:57:35 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.038 s
25/12/13 22:57:35 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:35 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
25/12/13 22:57:35 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.045320 s
+-----+-------------+
|month|monthly_delay|
+-----+-------------+
|1    |110991145    |
|2    |103189056    |
|3    |109732760    |
|4    |99452911     |
|5    |108496590    |
|6    |142912106    |
|7    |147857638    |
|8    |128590594    |
|9    |78557928     |
|10   |89932256     |
+-----+-------------+
only showing top 10 rows

25/12/13 22:57:35 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:35 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:35 INFO BlockManagerInfo: Removed broadcast_15_piece0 on ip-172-31-64-111.ec2.internal:36671 in memory (size: 24.3 KiB, free: 413.7 MiB)
25/12/13 22:57:35 INFO CodeGenerator: Code generated in 42.106467 ms
25/12/13 22:57:35 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 199.5 KiB, free 412.5 MiB)
25/12/13 22:57:35 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.5 MiB)
25/12/13 22:57:35 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 34.3 KiB, free: 413.7 MiB)
25/12/13 22:57:35 INFO SparkContext: Created broadcast 16 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:35 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:35 INFO DAGScheduler: Registering RDD 45 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 4
25/12/13 22:57:35 INFO DAGScheduler: Got map stage job 10 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:35 INFO DAGScheduler: Final stage: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:35 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:35 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:35 INFO DAGScheduler: Submitting ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:35 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 56.9 KiB, free 412.4 MiB)
25/12/13 22:57:35 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 412.4 MiB)
25/12/13 22:57:35 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 23.9 KiB, free: 413.6 MiB)
25/12/13 22:57:35 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:35 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:35 INFO TaskSchedulerImpl: Adding task set 14.0 with 2 tasks resource profile 0
25/12/13 22:57:35 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 15) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:35 INFO TaskSetManager: Starting task 1.0 in stage 14.0 (TID 16) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:35 INFO Executor: Running task 1.0 in stage 14.0 (TID 16)
25/12/13 22:57:35 INFO Executor: Running task 0.0 in stage 14.0 (TID 15)
25/12/13 22:57:36 INFO CodeGenerator: Code generated in 37.457376 ms
25/12/13 22:57:36 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:36 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:37 INFO Executor: Finished task 1.0 in stage 14.0 (TID 16). 2841 bytes result sent to driver
25/12/13 22:57:37 INFO TaskSetManager: Finished task 1.0 in stage 14.0 (TID 16) in 1154 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:37 INFO Executor: Finished task 0.0 in stage 14.0 (TID 15). 2841 bytes result sent to driver
25/12/13 22:57:37 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 15) in 1331 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:37 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
25/12/13 22:57:37 INFO DAGScheduler: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 1.343 s
25/12/13 22:57:37 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:37 INFO DAGScheduler: running: Set()
25/12/13 22:57:37 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:37 INFO DAGScheduler: failed: Set()
25/12/13 22:57:37 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:37 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:37 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:37 INFO DAGScheduler: Got job 11 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:37 INFO DAGScheduler: Final stage: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:37 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 15)
25/12/13 22:57:37 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:37 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:37 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 57.9 KiB, free 412.3 MiB)
25/12/13 22:57:37 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 24.9 KiB, free 412.3 MiB)
25/12/13 22:57:37 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on ip-172-31-64-111.ec2.internal:36671 (size: 24.9 KiB, free: 413.6 MiB)
25/12/13 22:57:37 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:37 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:37 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
25/12/13 22:57:37 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 17) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:37 INFO Executor: Running task 0.0 in stage 16.0 (TID 17)
25/12/13 22:57:37 INFO ShuffleBlockFetcherIterator: Getting 2 (4.6 KiB) non-empty blocks including 2 (4.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:37 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/12/13 22:57:37 INFO Executor: Finished task 0.0 in stage 16.0 (TID 17). 5840 bytes result sent to driver
25/12/13 22:57:37 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 17) in 20 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:37 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/12/13 22:57:37 INFO DAGScheduler: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.030 s
25/12/13 22:57:37 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:37 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
25/12/13 22:57:37 INFO DAGScheduler: Job 11 finished: showString at NativeMethodAccessorImpl.java:0, took 0.035557 s
+----------------------------+------------------+
|carrier_name                |avg_carrier_delay |
+----------------------------+------------------+
|Southwest Airlines Co.      |11242.021392808376|
|American Airlines Inc.      |8029.828780981285 |
|United Air Lines Inc.       |5979.190406367826 |
|JetBlue Airways             |5430.483753888697 |
|Delta Air Lines Inc.        |4574.997310851079 |
|US Airways Inc.             |4518.197250280584 |
|Continental Air Lines Inc.  |4342.791835552982 |
|Spirit Air Lines            |4336.106388595565 |
|American Eagle Airlines Inc.|4183.37684265212  |
|ExpressJet Airlines Inc.    |4005.9157512149304|
+----------------------------+------------------+
only showing top 10 rows

25/12/13 22:57:37 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/13 22:57:37 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/13 22:57:37 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/13 22:57:37 INFO MemoryStore: MemoryStore cleared
25/12/13 22:57:37 INFO BlockManager: BlockManager stopped
25/12/13 22:57:37 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/13 22:57:37 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/13 22:57:37 INFO SparkContext: Successfully stopped SparkContext
25/12/13 22:57:37 INFO ShutdownHookManager: Shutdown hook called
25/12/13 22:57:37 INFO ShutdownHookManager: Deleting directory /tmp/spark-46d2182a-8ca9-4c96-8e5d-015f4f7e654d
25/12/13 22:57:37 INFO ShutdownHookManager: Deleting directory /tmp/spark-fc48b42e-ad27-429d-8474-1ffab6f67f8a
25/12/13 22:57:37 INFO ShutdownHookManager: Deleting directory /tmp/spark-fc48b42e-ad27-429d-8474-1ffab6f67f8a/pyspark-44802ab3-c411-4e8c-a702-705a9608cf9a
[4/5] Running Spark SQL analysis...
25/12/13 22:57:42 INFO SparkContext: Running Spark version 3.5.1
25/12/13 22:57:42 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:57:42 INFO SparkContext: Java version 17.0.17
25/12/13 22:57:42 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/13 22:57:42 INFO ResourceUtils: ==============================================================
25/12/13 22:57:42 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/13 22:57:42 INFO ResourceUtils: ==============================================================
25/12/13 22:57:42 INFO SparkContext: Submitted application: Airline SQL
25/12/13 22:57:42 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/13 22:57:42 INFO ResourceProfile: Limiting resource is cpu
25/12/13 22:57:42 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/13 22:57:42 INFO SecurityManager: Changing view acls to: ubuntu
25/12/13 22:57:42 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/13 22:57:42 INFO SecurityManager: Changing view acls groups to: 
25/12/13 22:57:42 INFO SecurityManager: Changing modify acls groups to: 
25/12/13 22:57:42 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/13 22:57:42 INFO Utils: Successfully started service 'sparkDriver' on port 46523.
25/12/13 22:57:42 INFO SparkEnv: Registering MapOutputTracker
25/12/13 22:57:43 INFO SparkEnv: Registering BlockManagerMaster
25/12/13 22:57:43 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/13 22:57:43 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/13 22:57:43 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/13 22:57:43 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-6d371084-e879-4778-9753-82855067b83a
25/12/13 22:57:43 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/13 22:57:43 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/13 22:57:43 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/13 22:57:43 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/13 22:57:43 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/13 22:57:43 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:57:43 INFO Executor: Java version 17.0.17
25/12/13 22:57:43 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/13 22:57:43 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/13 22:57:43 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 40533.
25/12/13 22:57:43 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:40533
25/12/13 22:57:43 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/13 22:57:43 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 40533, None)
25/12/13 22:57:43 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:40533 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 40533, None)
25/12/13 22:57:43 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 40533, None)
25/12/13 22:57:43 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 40533, None)
25/12/13 22:57:44 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/13 22:57:44 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/13 22:57:46 INFO InMemoryFileIndex: It took 59 ms to list leaf files for 1 paths.
25/12/13 22:57:46 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
25/12/13 22:57:49 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:49 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/13 22:57:49 INFO CodeGenerator: Code generated in 307.54031 ms
25/12/13 22:57:49 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/13 22:57:50 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.7 MiB)
25/12/13 22:57:50 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.9 MiB)
25/12/13 22:57:50 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:50 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:50 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:50 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:50 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:50 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:50 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:50 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:50 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/13 22:57:50 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/13 22:57:50 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 6.4 KiB, free: 413.9 MiB)
25/12/13 22:57:50 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:50 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:50 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/13 22:57:50 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:50 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/13 22:57:50 INFO CodeGenerator: Code generated in 31.356328 ms
25/12/13 22:57:50 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:50 INFO CodeGenerator: Code generated in 14.285259 ms
25/12/13 22:57:50 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/13 22:57:50 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 305 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:50 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/13 22:57:50 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.438 s
25/12/13 22:57:50 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:50 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/13 22:57:50 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.487296 s
25/12/13 22:57:50 INFO CodeGenerator: Code generated in 19.967081 ms
25/12/13 22:57:50 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:50 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:57:50 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/13 22:57:50 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.4 MiB)
25/12/13 22:57:50 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.9 MiB)
25/12/13 22:57:50 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:50 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:51 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:57:51 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:51 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:51 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:51 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:51 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:51 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/13 22:57:51 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/13 22:57:51 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:57:51 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:51 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:51 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/13 22:57:51 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:51 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:57:51 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/13 22:57:51 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/13 22:57:51 INFO CodeGenerator: Code generated in 22.517198 ms
25/12/13 22:57:51 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:51 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:53 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/13 22:57:53 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2196 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:53 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/13 22:57:53 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2352 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:53 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/13 22:57:53 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.405 s
25/12/13 22:57:53 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:53 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/13 22:57:53 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.413291 s
25/12/13 22:57:53 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:53 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:54 INFO CodeGenerator: Code generated in 159.418631 ms
25/12/13 22:57:54 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/13 22:57:54 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/13 22:57:54 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:54 INFO SparkContext: Created broadcast 4 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:54 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:54 INFO DAGScheduler: Registering RDD 13 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/12/13 22:57:54 INFO DAGScheduler: Got map stage job 2 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:54 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:54 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:54 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:54 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:54 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 53.2 KiB, free 413.1 MiB)
25/12/13 22:57:54 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 22.4 KiB, free 413.1 MiB)
25/12/13 22:57:54 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 22.4 KiB, free: 413.8 MiB)
25/12/13 22:57:54 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:54 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:54 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/13 22:57:54 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:54 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:54 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/13 22:57:54 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/13 22:57:54 INFO CodeGenerator: Code generated in 99.644507 ms
25/12/13 22:57:54 INFO CodeGenerator: Code generated in 24.021986 ms
25/12/13 22:57:54 INFO CodeGenerator: Code generated in 15.048092 ms
25/12/13 22:57:54 INFO CodeGenerator: Code generated in 11.734675 ms
25/12/13 22:57:54 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:54 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:54 INFO CodeGenerator: Code generated in 40.455672 ms
25/12/13 22:57:55 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:55 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:57:55 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 6.4 KiB, free: 413.8 MiB)
25/12/13 22:57:55 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 34.3 KiB, free: 413.9 MiB)
25/12/13 22:57:56 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2884 bytes result sent to driver
25/12/13 22:57:56 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 2277 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:56 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2841 bytes result sent to driver
25/12/13 22:57:56 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 2372 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:56 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/13 22:57:56 INFO DAGScheduler: ShuffleMapStage 2 (showString at NativeMethodAccessorImpl.java:0) finished in 2.396 s
25/12/13 22:57:56 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:56 INFO DAGScheduler: running: Set()
25/12/13 22:57:56 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:56 INFO DAGScheduler: failed: Set()
25/12/13 22:57:56 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:56 INFO CodeGenerator: Code generated in 22.067066 ms
25/12/13 22:57:56 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:56 INFO CodeGenerator: Code generated in 20.843811 ms
25/12/13 22:57:57 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:57 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:57 INFO DAGScheduler: Final stage: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:57 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/12/13 22:57:57 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:57 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:57 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 54.0 KiB, free 413.6 MiB)
25/12/13 22:57:57 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 23.7 KiB, free 413.5 MiB)
25/12/13 22:57:57 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 23.7 KiB, free: 413.8 MiB)
25/12/13 22:57:57 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:57 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[17] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:57 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/12/13 22:57:57 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:57 INFO Executor: Running task 0.0 in stage 4.0 (TID 5)
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 9.630504 ms
25/12/13 22:57:57 INFO ShuffleBlockFetcherIterator: Getting 2 (4.5 KiB) non-empty blocks including 2 (4.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:57 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 12 ms
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 23.45188 ms
25/12/13 22:57:57 INFO Executor: Finished task 0.0 in stage 4.0 (TID 5). 5840 bytes result sent to driver
25/12/13 22:57:57 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 5) in 146 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:57 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/12/13 22:57:57 INFO DAGScheduler: ResultStage 4 (showString at NativeMethodAccessorImpl.java:0) finished in 0.166 s
25/12/13 22:57:57 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:57 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/12/13 22:57:57 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.187944 s
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 17.76228 ms
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 15.445491 ms
+----------------------------+-------------------+
|carrier_name                |total_arrival_delay|
+----------------------------+-------------------+
|Southwest Airlines Co.      |197589768          |
|American Airlines Inc.      |158749715          |
|SkyWest Airlines Inc.       |126613903          |
|Delta Air Lines Inc.        |125895285          |
|United Air Lines Inc.       |114178620          |
|ExpressJet Airlines Inc.    |98092859           |
|American Eagle Airlines Inc.|64419820           |
|JetBlue Airways             |62841558           |
|US Airways Inc.             |48308565           |
|Atlantic Southeast Airlines |36380279           |
+----------------------------+-------------------+
only showing top 10 rows

25/12/13 22:57:57 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:57 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 83.433675 ms
25/12/13 22:57:57 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.5 KiB, free 413.4 MiB)
25/12/13 22:57:57 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.3 MiB)
25/12/13 22:57:57 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:57 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:57 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:57 INFO BlockManagerInfo: Removed broadcast_6_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 23.7 KiB, free: 413.8 MiB)
25/12/13 22:57:57 INFO DAGScheduler: Registering RDD 21 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 1
25/12/13 22:57:57 INFO DAGScheduler: Got map stage job 4 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:57 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:57 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:57 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:57 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:57 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 54.6 KiB, free 413.3 MiB)
25/12/13 22:57:57 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.0 KiB, free 413.3 MiB)
25/12/13 22:57:57 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 23.0 KiB, free: 413.8 MiB)
25/12/13 22:57:57 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:57 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[21] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:57 INFO TaskSchedulerImpl: Adding task set 5.0 with 2 tasks resource profile 0
25/12/13 22:57:57 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:57 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 7) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:57 INFO Executor: Running task 1.0 in stage 5.0 (TID 7)
25/12/13 22:57:57 INFO Executor: Running task 0.0 in stage 5.0 (TID 6)
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 79.475852 ms
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 11.22877 ms
25/12/13 22:57:57 INFO CodeGenerator: Code generated in 12.230533 ms
25/12/13 22:57:57 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:57:57 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:57:59 INFO Executor: Finished task 1.0 in stage 5.0 (TID 7). 2841 bytes result sent to driver
25/12/13 22:57:59 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 7) in 1711 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:57:59 INFO Executor: Finished task 0.0 in stage 5.0 (TID 6). 2841 bytes result sent to driver
25/12/13 22:57:59 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 6) in 1727 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:57:59 INFO DAGScheduler: ShuffleMapStage 5 (showString at NativeMethodAccessorImpl.java:0) finished in 1.742 s
25/12/13 22:57:59 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:57:59 INFO DAGScheduler: running: Set()
25/12/13 22:57:59 INFO DAGScheduler: waiting: Set()
25/12/13 22:57:59 INFO DAGScheduler: failed: Set()
25/12/13 22:57:59 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/12/13 22:57:59 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 11.151721 ms
25/12/13 22:57:59 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 18.366057 ms
25/12/13 22:57:59 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:59 INFO DAGScheduler: Got job 5 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:57:59 INFO DAGScheduler: Final stage: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:59 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/12/13 22:57:59 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:59 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:59 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 55.8 KiB, free 413.3 MiB)
25/12/13 22:57:59 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 24.2 KiB, free 413.2 MiB)
25/12/13 22:57:59 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 24.2 KiB, free: 413.8 MiB)
25/12/13 22:57:59 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:59 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[25] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:57:59 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/12/13 22:57:59 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 8) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:57:59 INFO Executor: Running task 0.0 in stage 7.0 (TID 8)
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 8.666976 ms
25/12/13 22:57:59 INFO ShuffleBlockFetcherIterator: Getting 2 (59.8 KiB) non-empty blocks including 2 (59.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:57:59 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 22.290222 ms
25/12/13 22:57:59 INFO Executor: Finished task 0.0 in stage 7.0 (TID 8). 6090 bytes result sent to driver
25/12/13 22:57:59 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 8) in 96 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:57:59 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/12/13 22:57:59 INFO DAGScheduler: ResultStage 7 (showString at NativeMethodAccessorImpl.java:0) finished in 0.113 s
25/12/13 22:57:59 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:57:59 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/12/13 22:57:59 INFO DAGScheduler: Job 5 finished: showString at NativeMethodAccessorImpl.java:0, took 0.132969 s
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 8.302245 ms
+------------------------------------------------------+------------------+
|airport_name                                          |avg_arrival_delay |
+------------------------------------------------------+------------------+
|Chicago, IL: Chicago O'Hare International             |31867.799072091362|
|Atlanta, GA: Hartsfield-Jackson Atlanta International |27830.672919508866|
|Dallas/Fort Worth, TX: Dallas/Fort Worth International|20571.237798546208|
|Newark, NJ: Newark Liberty International              |17511.09181784524 |
|San Francisco, CA: San Francisco International        |16140.159023668639|
|Sanford, FL: Orlando Sanford International            |16041.452830188678|
|Denver, CO: Denver International                      |15025.973445143256|
|New York, NY: John F. Kennedy International           |14642.515225933203|
|Los Angeles, CA: Los Angeles International            |13589.449129852745|
|Houston, TX: George Bush Intercontinental/Houston     |13375.582714118107|
+------------------------------------------------------+------------------+
only showing top 10 rows

25/12/13 22:57:59 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:57:59 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 80.545153 ms
25/12/13 22:57:59 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 199.5 KiB, free 413.0 MiB)
25/12/13 22:57:59 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.0 MiB)
25/12/13 22:57:59 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:57:59 INFO SparkContext: Created broadcast 10 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:57:59 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:57:59 INFO DAGScheduler: Registering RDD 29 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/12/13 22:57:59 INFO DAGScheduler: Got map stage job 6 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:57:59 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:57:59 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:57:59 INFO DAGScheduler: Missing parents: List()
25/12/13 22:57:59 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:57:59 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 52.9 KiB, free 413.0 MiB)
25/12/13 22:57:59 INFO BlockManagerInfo: Removed broadcast_9_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 24.2 KiB, free: 413.8 MiB)
25/12/13 22:57:59 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 22.2 KiB, free 412.9 MiB)
25/12/13 22:57:59 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 22.2 KiB, free: 413.8 MiB)
25/12/13 22:57:59 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/12/13 22:57:59 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[29] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:57:59 INFO TaskSchedulerImpl: Adding task set 8.0 with 2 tasks resource profile 0
25/12/13 22:57:59 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 9) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:59 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 10) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:57:59 INFO Executor: Running task 1.0 in stage 8.0 (TID 10)
25/12/13 22:57:59 INFO Executor: Running task 0.0 in stage 8.0 (TID 9)
25/12/13 22:57:59 INFO CodeGenerator: Code generated in 51.903118 ms
25/12/13 22:58:00 INFO CodeGenerator: Code generated in 17.987233 ms
25/12/13 22:58:00 INFO CodeGenerator: Code generated in 7.183407 ms
25/12/13 22:58:00 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:58:00 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:01 INFO Executor: Finished task 1.0 in stage 8.0 (TID 10). 2841 bytes result sent to driver
25/12/13 22:58:01 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 10) in 1792 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:58:01 INFO Executor: Finished task 0.0 in stage 8.0 (TID 9). 2841 bytes result sent to driver
25/12/13 22:58:01 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 9) in 1905 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:58:01 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/12/13 22:58:01 INFO DAGScheduler: ShuffleMapStage 8 (showString at NativeMethodAccessorImpl.java:0) finished in 1.935 s
25/12/13 22:58:01 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:58:01 INFO DAGScheduler: running: Set()
25/12/13 22:58:01 INFO DAGScheduler: waiting: Set()
25/12/13 22:58:01 INFO DAGScheduler: failed: Set()
25/12/13 22:58:01 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:58:01 INFO CodeGenerator: Code generated in 10.486809 ms
25/12/13 22:58:01 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:58:01 INFO CodeGenerator: Code generated in 30.604294 ms
25/12/13 22:58:01 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:58:01 INFO DAGScheduler: Got job 7 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:58:01 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:01 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/12/13 22:58:01 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:01 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:01 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 53.9 KiB, free 413.0 MiB)
25/12/13 22:58:01 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 412.9 MiB)
25/12/13 22:58:01 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 23.6 KiB, free: 413.7 MiB)
25/12/13 22:58:01 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:01 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[33] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:58:01 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/12/13 22:58:01 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 11) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:58:01 INFO Executor: Running task 0.0 in stage 10.0 (TID 11)
25/12/13 22:58:01 INFO CodeGenerator: Code generated in 7.914454 ms
25/12/13 22:58:01 INFO ShuffleBlockFetcherIterator: Getting 2 (1386.0 B) non-empty blocks including 2 (1386.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:58:01 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/12/13 22:58:02 INFO CodeGenerator: Code generated in 21.961283 ms
25/12/13 22:58:02 INFO Executor: Finished task 0.0 in stage 10.0 (TID 11). 5576 bytes result sent to driver
25/12/13 22:58:02 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 11) in 61 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:58:02 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/12/13 22:58:02 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.078 s
25/12/13 22:58:02 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:02 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/12/13 22:58:02 INFO DAGScheduler: Job 7 finished: showString at NativeMethodAccessorImpl.java:0, took 0.094590 s
25/12/13 22:58:02 INFO CodeGenerator: Code generated in 9.542564 ms
+----+------------+
|year|yearly_delay|
+----+------------+
|2003|32535792    |
|2004|73088325    |
|2005|76476224    |
|2006|87187039    |
|2007|100965732   |
|2008|86637993    |
|2009|66005819    |
|2010|63257498    |
|2011|61670561    |
|2012|56916692    |
+----+------------+
only showing top 10 rows

25/12/13 22:58:02 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:58:02 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:58:02 INFO CodeGenerator: Code generated in 61.101288 ms
25/12/13 22:58:02 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 199.5 KiB, free 412.7 MiB)
25/12/13 22:58:02 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.7 MiB)
25/12/13 22:58:02 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.7 MiB)
25/12/13 22:58:02 INFO SparkContext: Created broadcast 13 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:58:02 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:58:02 INFO DAGScheduler: Registering RDD 37 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/12/13 22:58:02 INFO DAGScheduler: Got map stage job 8 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:58:02 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:02 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:58:02 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:02 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:02 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 52.9 KiB, free 412.7 MiB)
25/12/13 22:58:02 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 22.2 KiB, free 412.6 MiB)
25/12/13 22:58:02 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 22.2 KiB, free: 413.7 MiB)
25/12/13 22:58:02 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:02 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[37] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:58:02 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
25/12/13 22:58:02 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 12) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:58:02 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 13) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:58:02 INFO Executor: Running task 0.0 in stage 11.0 (TID 12)
25/12/13 22:58:02 INFO Executor: Running task 1.0 in stage 11.0 (TID 13)
25/12/13 22:58:02 INFO BlockManagerInfo: Removed broadcast_12_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 23.6 KiB, free: 413.7 MiB)
25/12/13 22:58:02 INFO CodeGenerator: Code generated in 60.555592 ms
25/12/13 22:58:02 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:02 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:58:03 INFO Executor: Finished task 1.0 in stage 11.0 (TID 13). 2841 bytes result sent to driver
25/12/13 22:58:03 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 13) in 1253 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:58:03 INFO Executor: Finished task 0.0 in stage 11.0 (TID 12). 2841 bytes result sent to driver
25/12/13 22:58:03 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 12) in 1363 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:58:03 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
25/12/13 22:58:03 INFO DAGScheduler: ShuffleMapStage 11 (showString at NativeMethodAccessorImpl.java:0) finished in 1.376 s
25/12/13 22:58:03 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:58:03 INFO DAGScheduler: running: Set()
25/12/13 22:58:03 INFO DAGScheduler: waiting: Set()
25/12/13 22:58:03 INFO DAGScheduler: failed: Set()
25/12/13 22:58:03 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:58:03 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:58:03 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:58:03 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:58:03 INFO DAGScheduler: Final stage: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:03 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
25/12/13 22:58:03 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:03 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:03 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 53.9 KiB, free 412.7 MiB)
25/12/13 22:58:03 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 412.6 MiB)
25/12/13 22:58:03 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 23.6 KiB, free: 413.7 MiB)
25/12/13 22:58:03 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:03 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[41] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:58:03 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
25/12/13 22:58:03 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 14) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:58:03 INFO Executor: Running task 0.0 in stage 13.0 (TID 14)
25/12/13 22:58:03 INFO ShuffleBlockFetcherIterator: Getting 2 (1584.0 B) non-empty blocks including 2 (1584.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:58:03 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/12/13 22:58:03 INFO Executor: Finished task 0.0 in stage 13.0 (TID 14). 5576 bytes result sent to driver
25/12/13 22:58:03 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 14) in 35 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:58:03 INFO DAGScheduler: ResultStage 13 (showString at NativeMethodAccessorImpl.java:0) finished in 0.055 s
25/12/13 22:58:03 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
25/12/13 22:58:03 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:03 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
25/12/13 22:58:03 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.068652 s
+-----+-------------+
|month|monthly_delay|
+-----+-------------+
|1    |110991145    |
|2    |103189056    |
|3    |109732780    |
|4    |99452911     |
|5    |108496590    |
|6    |142912106    |
|7    |147857638    |
|8    |128591297    |
|9    |78557928     |
|10   |89932256     |
+-----+-------------+
only showing top 10 rows

25/12/13 22:58:03 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:58:03 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:58:04 INFO CodeGenerator: Code generated in 55.674998 ms
25/12/13 22:58:04 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 199.5 KiB, free 412.4 MiB)
25/12/13 22:58:04 INFO BlockManagerInfo: Removed broadcast_15_piece0 on ip-172-31-64-111.ec2.internal:40533 in memory (size: 23.6 KiB, free: 413.7 MiB)
25/12/13 22:58:04 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 412.5 MiB)
25/12/13 22:58:04 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 34.3 KiB, free: 413.7 MiB)
25/12/13 22:58:04 INFO SparkContext: Created broadcast 16 from showString at NativeMethodAccessorImpl.java:0
25/12/13 22:58:04 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:58:04 INFO DAGScheduler: Registering RDD 45 (showString at NativeMethodAccessorImpl.java:0) as input to shuffle 4
25/12/13 22:58:04 INFO DAGScheduler: Got map stage job 10 (showString at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:58:04 INFO DAGScheduler: Final stage: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:04 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:58:04 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:04 INFO DAGScheduler: Submitting ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:04 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 50.2 KiB, free 412.4 MiB)
25/12/13 22:58:04 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 412.4 MiB)
25/12/13 22:58:04 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 21.4 KiB, free: 413.6 MiB)
25/12/13 22:58:04 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:04 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 14 (MapPartitionsRDD[45] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:58:04 INFO TaskSchedulerImpl: Adding task set 14.0 with 2 tasks resource profile 0
25/12/13 22:58:04 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 15) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:58:04 INFO TaskSetManager: Starting task 1.0 in stage 14.0 (TID 16) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8231 bytes) 
25/12/13 22:58:04 INFO Executor: Running task 0.0 in stage 14.0 (TID 15)
25/12/13 22:58:04 INFO Executor: Running task 1.0 in stage 14.0 (TID 16)
25/12/13 22:58:04 INFO CodeGenerator: Code generated in 49.62384 ms
25/12/13 22:58:04 INFO CodeGenerator: Code generated in 11.181839 ms
25/12/13 22:58:04 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:04 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:58:05 INFO Executor: Finished task 1.0 in stage 14.0 (TID 16). 2841 bytes result sent to driver
25/12/13 22:58:05 INFO TaskSetManager: Finished task 1.0 in stage 14.0 (TID 16) in 1256 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:58:05 INFO Executor: Finished task 0.0 in stage 14.0 (TID 15). 2841 bytes result sent to driver
25/12/13 22:58:05 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 15) in 1400 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:58:05 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
25/12/13 22:58:05 INFO DAGScheduler: ShuffleMapStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 1.413 s
25/12/13 22:58:05 INFO DAGScheduler: looking for newly runnable stages
25/12/13 22:58:05 INFO DAGScheduler: running: Set()
25/12/13 22:58:05 INFO DAGScheduler: waiting: Set()
25/12/13 22:58:05 INFO DAGScheduler: failed: Set()
25/12/13 22:58:05 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/12/13 22:58:05 INFO CodeGenerator: Code generated in 6.455234 ms
25/12/13 22:58:05 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/12/13 22:58:05 INFO CodeGenerator: Code generated in 12.234759 ms
25/12/13 22:58:05 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
25/12/13 22:58:05 INFO DAGScheduler: Got job 11 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:58:05 INFO DAGScheduler: Final stage: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:05 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 15)
25/12/13 22:58:05 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:05 INFO DAGScheduler: Submitting ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:05 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 50.5 KiB, free 412.4 MiB)
25/12/13 22:58:05 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 22.5 KiB, free 412.3 MiB)
25/12/13 22:58:05 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on ip-172-31-64-111.ec2.internal:40533 (size: 22.5 KiB, free: 413.6 MiB)
25/12/13 22:58:05 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:05 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:58:05 INFO TaskSchedulerImpl: Adding task set 16.0 with 1 tasks resource profile 0
25/12/13 22:58:05 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 17) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, NODE_LOCAL, 7615 bytes) 
25/12/13 22:58:05 INFO Executor: Running task 0.0 in stage 16.0 (TID 17)
25/12/13 22:58:05 INFO CodeGenerator: Code generated in 5.293759 ms
25/12/13 22:58:05 INFO ShuffleBlockFetcherIterator: Getting 2 (4.4 KiB) non-empty blocks including 2 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/12/13 22:58:05 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/12/13 22:58:05 INFO CodeGenerator: Code generated in 11.525666 ms
25/12/13 22:58:05 INFO Executor: Finished task 0.0 in stage 16.0 (TID 17). 5856 bytes result sent to driver
25/12/13 22:58:05 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 17) in 41 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:58:05 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/12/13 22:58:05 INFO DAGScheduler: ResultStage 16 (showString at NativeMethodAccessorImpl.java:0) finished in 0.055 s
25/12/13 22:58:05 INFO DAGScheduler: Job 11 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:05 INFO TaskSchedulerImpl: Killing all running tasks in stage 16: Stage finished
25/12/13 22:58:05 INFO DAGScheduler: Job 11 finished: showString at NativeMethodAccessorImpl.java:0, took 0.062094 s
25/12/13 22:58:05 INFO CodeGenerator: Code generated in 12.44062 ms
+----------------------------+-------+
|carrier_name                |records|
+----------------------------+-------+
|SkyWest Airlines Inc.       |38038  |
|Delta Air Lines Inc.        |27518  |
|ExpressJet Airlines Inc.    |24487  |
|American Airlines Inc.      |19770  |
|United Air Lines Inc.       |19096  |
|Southwest Airlines Co.      |17576  |
|American Eagle Airlines Inc.|15399  |
|Mesa Airlines Inc.          |14483  |
|Alaska Airlines Inc.        |12933  |
|Frontier Airlines Inc.      |12275  |
+----------------------------+-------+
only showing top 10 rows

25/12/13 22:58:05 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/13 22:58:05 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/13 22:58:05 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/13 22:58:05 INFO MemoryStore: MemoryStore cleared
25/12/13 22:58:05 INFO BlockManager: BlockManager stopped
25/12/13 22:58:05 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/13 22:58:05 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/13 22:58:05 INFO SparkContext: Successfully stopped SparkContext
25/12/13 22:58:06 INFO ShutdownHookManager: Shutdown hook called
25/12/13 22:58:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-7a436d6b-d4f5-46b5-8151-58818f2d04ca/pyspark-4c2ba9a9-adf0-4a10-babe-3819a2df85f9
25/12/13 22:58:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-7a436d6b-d4f5-46b5-8151-58818f2d04ca
25/12/13 22:58:06 INFO ShutdownHookManager: Deleting directory /tmp/spark-b3d6cc3f-b3e2-4098-a462-fb2328314fc0
[5/5] Saving processed data to S3...
25/12/13 22:58:10 INFO SparkContext: Running Spark version 3.5.1
25/12/13 22:58:10 INFO SparkContext: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:58:10 INFO SparkContext: Java version 17.0.17
25/12/13 22:58:10 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/12/13 22:58:10 INFO ResourceUtils: ==============================================================
25/12/13 22:58:10 INFO ResourceUtils: No custom resources configured for spark.driver.
25/12/13 22:58:10 INFO ResourceUtils: ==============================================================
25/12/13 22:58:10 INFO SparkContext: Submitted application: Save Airline Data
25/12/13 22:58:10 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/12/13 22:58:10 INFO ResourceProfile: Limiting resource is cpu
25/12/13 22:58:10 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/12/13 22:58:10 INFO SecurityManager: Changing view acls to: ubuntu
25/12/13 22:58:10 INFO SecurityManager: Changing modify acls to: ubuntu
25/12/13 22:58:10 INFO SecurityManager: Changing view acls groups to: 
25/12/13 22:58:10 INFO SecurityManager: Changing modify acls groups to: 
25/12/13 22:58:10 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: ubuntu; groups with view permissions: EMPTY; users with modify permissions: ubuntu; groups with modify permissions: EMPTY
25/12/13 22:58:11 INFO Utils: Successfully started service 'sparkDriver' on port 43561.
25/12/13 22:58:11 INFO SparkEnv: Registering MapOutputTracker
25/12/13 22:58:11 INFO SparkEnv: Registering BlockManagerMaster
25/12/13 22:58:11 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/12/13 22:58:11 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/12/13 22:58:11 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/12/13 22:58:11 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-54945b1e-187c-424a-9714-c24761347acf
25/12/13 22:58:11 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/12/13 22:58:11 INFO SparkEnv: Registering OutputCommitCoordinator
25/12/13 22:58:11 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/12/13 22:58:11 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/12/13 22:58:12 INFO Executor: Starting executor ID driver on host ip-172-31-64-111.ec2.internal
25/12/13 22:58:12 INFO Executor: OS info Linux, 6.14.0-1018-aws, amd64
25/12/13 22:58:12 INFO Executor: Java version 17.0.17
25/12/13 22:58:12 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/12/13 22:58:12 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@38e4c1fd for default.
25/12/13 22:58:12 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 37159.
25/12/13 22:58:12 INFO NettyBlockTransferService: Server created on ip-172-31-64-111.ec2.internal:37159
25/12/13 22:58:12 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/12/13 22:58:12 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 37159, None)
25/12/13 22:58:12 INFO BlockManagerMasterEndpoint: Registering block manager ip-172-31-64-111.ec2.internal:37159 with 413.9 MiB RAM, BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 37159, None)
25/12/13 22:58:12 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 37159, None)
25/12/13 22:58:12 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-172-31-64-111.ec2.internal, 37159, None)
25/12/13 22:58:12 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/12/13 22:58:12 INFO SharedState: Warehouse path is 'file:/home/ubuntu/airline_project/spark-warehouse'.
25/12/13 22:58:14 INFO InMemoryFileIndex: It took 69 ms to list leaf files for 1 paths.
25/12/13 22:58:14 INFO InMemoryFileIndex: It took 2 ms to list leaf files for 1 paths.
25/12/13 22:58:16 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:58:16 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/12/13 22:58:17 INFO CodeGenerator: Code generated in 279.690144 ms
25/12/13 22:58:17 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.6 KiB, free 413.7 MiB)
25/12/13 22:58:17 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.7 MiB)
25/12/13 22:58:17 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 34.4 KiB, free: 413.9 MiB)
25/12/13 22:58:17 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:58:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:58:17 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:58:17 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/12/13 22:58:17 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:17 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:58:17 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:17 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:18 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 413.7 MiB)
25/12/13 22:58:18 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 413.7 MiB)
25/12/13 22:58:18 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 6.4 KiB, free: 413.9 MiB)
25/12/13 22:58:18 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:18 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/12/13 22:58:18 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/12/13 22:58:18 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:18 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/12/13 22:58:18 INFO CodeGenerator: Code generated in 34.506655 ms
25/12/13 22:58:18 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:18 INFO CodeGenerator: Code generated in 21.367117 ms
25/12/13 22:58:18 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1826 bytes result sent to driver
25/12/13 22:58:18 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 316 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/1)
25/12/13 22:58:18 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/12/13 22:58:18 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.499 s
25/12/13 22:58:18 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/12/13 22:58:18 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.562928 s
25/12/13 22:58:18 INFO CodeGenerator: Code generated in 25.502295 ms
25/12/13 22:58:18 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:58:18 INFO FileSourceStrategy: Post-Scan Filters: 
25/12/13 22:58:18 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.6 KiB, free 413.5 MiB)
25/12/13 22:58:18 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 413.4 MiB)
25/12/13 22:58:18 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 34.4 KiB, free: 413.9 MiB)
25/12/13 22:58:18 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:58:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:58:18 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:58:18 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:58:18 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:18 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:58:18 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:18 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:18 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.9 KiB, free 413.4 MiB)
25/12/13 22:58:18 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 413.4 MiB)
25/12/13 22:58:18 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 12.8 KiB, free: 413.8 MiB)
25/12/13 22:58:18 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:18 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:58:18 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
25/12/13 22:58:18 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:18 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:18 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/12/13 22:58:18 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/12/13 22:58:18 INFO CodeGenerator: Code generated in 10.381664 ms
25/12/13 22:58:18 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:58:18 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:21 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1802 bytes result sent to driver
25/12/13 22:58:21 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 2355 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:58:21 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1759 bytes result sent to driver
25/12/13 22:58:21 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 2523 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:58:21 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/12/13 22:58:21 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.584 s
25/12/13 22:58:21 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/12/13 22:58:21 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.597391 s
25/12/13 22:58:21 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:58:21 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:58:21 INFO ParquetUtils: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:21 INFO CodeGenerator: Code generated in 110.897084 ms
25/12/13 22:58:21 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/13 22:58:21 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/13 22:58:21 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:58:21 INFO SparkContext: Created broadcast 4 from parquet at NativeMethodAccessorImpl.java:0
25/12/13 22:58:21 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:58:21 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
25/12/13 22:58:21 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:58:21 INFO DAGScheduler: Final stage: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:21 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:58:21 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:21 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:22 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 231.5 KiB, free 413.0 MiB)
25/12/13 22:58:22 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 81.5 KiB, free 412.9 MiB)
25/12/13 22:58:22 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 81.5 KiB, free: 413.7 MiB)
25/12/13 22:58:22 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:22 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 2 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:58:22 INFO TaskSchedulerImpl: Adding task set 2.0 with 2 tasks resource profile 0
25/12/13 22:58:22 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 3) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:22 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 4) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:22 INFO Executor: Running task 1.0 in stage 2.0 (TID 4)
25/12/13 22:58:22 INFO Executor: Running task 0.0 in stage 2.0 (TID 3)
25/12/13 22:58:22 INFO CodeGenerator: Code generated in 89.375608 ms
25/12/13 22:58:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
25/12/13 22:58:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:58:22 INFO CodecConfig: Compression: SNAPPY
25/12/13 22:58:22 INFO CodecConfig: Compression: SNAPPY
25/12/13 22:58:22 INFO ParquetOutputFormat: ParquetRecordWriter [block size: 134217728b, row group padding size: 8388608b, validating: false]
25/12/13 22:58:22 INFO CodeGenerator: Code generated in 73.644863 ms
25/12/13 22:58:22 INFO CodecConfig: Compression: SNAPPY
25/12/13 22:58:22 INFO CodecConfig: Compression: SNAPPY
25/12/13 22:58:22 INFO ParquetOutputFormat: ParquetRecordWriter [block size: 134217728b, row group padding size: 8388608b, validating: false]
25/12/13 22:58:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "year",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "month",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_flights",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_del15",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_cancelled",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_diverted",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_minutes",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_count",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional int32 year;
  optional int32 month;
  optional binary carrier (STRING);
  optional binary carrier_name (STRING);
  optional binary airport (STRING);
  optional binary airport_name (STRING);
  optional int32 arr_flights;
  optional int32 arr_del15;
  optional double carrier_ct;
  optional double weather_ct;
  optional double nas_ct;
  optional double security_ct;
  optional double late_aircraft_ct;
  optional int32 arr_cancelled;
  optional int32 arr_diverted;
  optional int32 arr_delay;
  optional int32 carrier_delay;
  optional int32 weather_delay;
  optional int32 nas_delay;
  optional int32 security_delay;
  optional int32 late_aircraft_delay;
  optional int32 total_delay_minutes;
  optional double total_delay_count;
}

       
25/12/13 22:58:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "year",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "month",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "airport_name",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_flights",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_del15",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_ct",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_cancelled",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_diverted",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "arr_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "carrier_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "weather_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "nas_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "security_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "late_aircraft_delay",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_minutes",
    "type" : "integer",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "total_delay_count",
    "type" : "double",
    "nullable" : true,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional int32 year;
  optional int32 month;
  optional binary carrier (STRING);
  optional binary carrier_name (STRING);
  optional binary airport (STRING);
  optional binary airport_name (STRING);
  optional int32 arr_flights;
  optional int32 arr_del15;
  optional double carrier_ct;
  optional double weather_ct;
  optional double nas_ct;
  optional double security_ct;
  optional double late_aircraft_ct;
  optional int32 arr_cancelled;
  optional int32 arr_diverted;
  optional int32 arr_delay;
  optional int32 carrier_delay;
  optional int32 weather_delay;
  optional int32 nas_delay;
  optional int32 security_delay;
  optional int32 late_aircraft_delay;
  optional int32 total_delay_minutes;
  optional double total_delay_count;
}

       
25/12/13 22:58:22 INFO CodecPool: Got brand-new compressor [.snappy]
25/12/13 22:58:22 INFO CodecPool: Got brand-new compressor [.snappy]
25/12/13 22:58:22 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:23 INFO BlockManagerInfo: Removed broadcast_3_piece0 on ip-172-31-64-111.ec2.internal:37159 in memory (size: 12.8 KiB, free: 413.7 MiB)
25/12/13 22:58:23 INFO BlockManagerInfo: Removed broadcast_1_piece0 on ip-172-31-64-111.ec2.internal:37159 in memory (size: 6.4 KiB, free: 413.7 MiB)
25/12/13 22:58:23 INFO BlockManagerInfo: Removed broadcast_0_piece0 on ip-172-31-64-111.ec2.internal:37159 in memory (size: 34.4 KiB, free: 413.8 MiB)
25/12/13 22:58:23 INFO BlockManagerInfo: Removed broadcast_2_piece0 on ip-172-31-64-111.ec2.internal:37159 in memory (size: 34.4 KiB, free: 413.8 MiB)
25/12/13 22:58:27 INFO FileOutputCommitter: Saved output of task 'attempt_202512132258212168357638709472064_0002_m_000001_4' to file:/home/ubuntu/airline_project/output/airline_processed_parquet/_temporary/0/task_202512132258212168357638709472064_0002_m_000001
25/12/13 22:58:27 INFO SparkHadoopMapRedUtil: attempt_202512132258212168357638709472064_0002_m_000001_4: Committed. Elapsed time: 8 ms.
25/12/13 22:58:27 INFO Executor: Finished task 1.0 in stage 2.0 (TID 4). 2669 bytes result sent to driver
25/12/13 22:58:27 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 4) in 5267 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:58:27 INFO FileOutputCommitter: Saved output of task 'attempt_202512132258212168357638709472064_0002_m_000000_3' to file:/home/ubuntu/airline_project/output/airline_processed_parquet/_temporary/0/task_202512132258212168357638709472064_0002_m_000000
25/12/13 22:58:27 INFO SparkHadoopMapRedUtil: attempt_202512132258212168357638709472064_0002_m_000000_3: Committed. Elapsed time: 1 ms.
25/12/13 22:58:27 INFO Executor: Finished task 0.0 in stage 2.0 (TID 3). 2626 bytes result sent to driver
25/12/13 22:58:27 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 3) in 5379 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:58:27 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/12/13 22:58:27 INFO DAGScheduler: ResultStage 2 (parquet at NativeMethodAccessorImpl.java:0) finished in 5.445 s
25/12/13 22:58:27 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
25/12/13 22:58:27 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 5.460997 s
25/12/13 22:58:27 INFO FileFormatWriter: Start to commit write Job a05ea3e8-fbb2-47c3-96e6-5a5949073f9f.
25/12/13 22:58:27 INFO FileFormatWriter: Write Job a05ea3e8-fbb2-47c3-96e6-5a5949073f9f committed. Elapsed time: 21 ms.
25/12/13 22:58:27 INFO FileFormatWriter: Finished processing stats for write job a05ea3e8-fbb2-47c3-96e6-5a5949073f9f.
25/12/13 22:58:27 INFO FileSourceStrategy: Pushed Filters: 
25/12/13 22:58:27 INFO FileSourceStrategy: Post-Scan Filters: atleastnnonnulls(21, year#17, month#18, carrier#19, carrier_name#20, airport#21, airport_name#22, arr_flights#23, arr_del15#24, carrier_ct#25, weather_ct#26, nas_ct#27, security_ct#28, late_aircraft_ct#29, arr_cancelled#30, arr_diverted#31, arr_delay#32, carrier_delay#33, weather_delay#34, nas_delay#35, security_delay#36, late_aircraft_delay#37)
25/12/13 22:58:27 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:27 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:27 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/13 22:58:27 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 199.5 KiB, free 413.2 MiB)
25/12/13 22:58:27 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 34.3 KiB, free 413.2 MiB)
25/12/13 22:58:27 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 34.3 KiB, free: 413.8 MiB)
25/12/13 22:58:27 INFO SparkContext: Created broadcast 6 from csv at NativeMethodAccessorImpl.java:0
25/12/13 22:58:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 23361877 bytes, open cost is considered as scanning 4194304 bytes.
25/12/13 22:58:27 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/12/13 22:58:27 INFO DAGScheduler: Got job 3 (csv at NativeMethodAccessorImpl.java:0) with 2 output partitions
25/12/13 22:58:27 INFO DAGScheduler: Final stage: ResultStage 3 (csv at NativeMethodAccessorImpl.java:0)
25/12/13 22:58:27 INFO DAGScheduler: Parents of final stage: List()
25/12/13 22:58:27 INFO DAGScheduler: Missing parents: List()
25/12/13 22:58:27 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[17] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/12/13 22:58:27 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 229.3 KiB, free 412.9 MiB)
25/12/13 22:58:27 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 80.6 KiB, free 412.9 MiB)
25/12/13 22:58:27 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on ip-172-31-64-111.ec2.internal:37159 (size: 80.6 KiB, free: 413.7 MiB)
25/12/13 22:58:27 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1585
25/12/13 22:58:27 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 3 (MapPartitionsRDD[17] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
25/12/13 22:58:27 INFO TaskSchedulerImpl: Adding task set 3.0 with 2 tasks resource profile 0
25/12/13 22:58:27 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 5) (ip-172-31-64-111.ec2.internal, executor driver, partition 0, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:27 INFO TaskSetManager: Starting task 1.0 in stage 3.0 (TID 6) (ip-172-31-64-111.ec2.internal, executor driver, partition 1, PROCESS_LOCAL, 8242 bytes) 
25/12/13 22:58:27 INFO Executor: Running task 0.0 in stage 3.0 (TID 5)
25/12/13 22:58:27 INFO Executor: Running task 1.0 in stage 3.0 (TID 6)
25/12/13 22:58:27 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:27 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:27 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/13 22:58:27 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
25/12/13 22:58:27 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
25/12/13 22:58:27 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
25/12/13 22:58:27 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 23361877-42529451, partition values: [empty row]
25/12/13 22:58:27 INFO FileScanRDD: Reading File path: file:///home/ubuntu/airline_project/data/Airline_Delay_Cause.csv, range: 0-23361877, partition values: [empty row]
25/12/13 22:58:29 INFO FileOutputCommitter: Saved output of task 'attempt_202512132258275183524111242441694_0003_m_000001_6' to file:/home/ubuntu/airline_project/output/airline_processed_csv/_temporary/0/task_202512132258275183524111242441694_0003_m_000001
25/12/13 22:58:29 INFO SparkHadoopMapRedUtil: attempt_202512132258275183524111242441694_0003_m_000001_6: Committed. Elapsed time: 1 ms.
25/12/13 22:58:29 INFO Executor: Finished task 1.0 in stage 3.0 (TID 6). 2626 bytes result sent to driver
25/12/13 22:58:29 INFO TaskSetManager: Finished task 1.0 in stage 3.0 (TID 6) in 1730 ms on ip-172-31-64-111.ec2.internal (executor driver) (1/2)
25/12/13 22:58:29 INFO FileOutputCommitter: Saved output of task 'attempt_202512132258275183524111242441694_0003_m_000000_5' to file:/home/ubuntu/airline_project/output/airline_processed_csv/_temporary/0/task_202512132258275183524111242441694_0003_m_000000
25/12/13 22:58:29 INFO SparkHadoopMapRedUtil: attempt_202512132258275183524111242441694_0003_m_000000_5: Committed. Elapsed time: 1 ms.
25/12/13 22:58:29 INFO Executor: Finished task 0.0 in stage 3.0 (TID 5). 2626 bytes result sent to driver
25/12/13 22:58:29 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 5) in 1997 ms on ip-172-31-64-111.ec2.internal (executor driver) (2/2)
25/12/13 22:58:29 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
25/12/13 22:58:29 INFO DAGScheduler: ResultStage 3 (csv at NativeMethodAccessorImpl.java:0) finished in 2.022 s
25/12/13 22:58:29 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/12/13 22:58:29 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
25/12/13 22:58:29 INFO DAGScheduler: Job 3 finished: csv at NativeMethodAccessorImpl.java:0, took 2.029852 s
25/12/13 22:58:29 INFO FileFormatWriter: Start to commit write Job fe2da002-c488-4258-95ae-1c2e8b06fe9e.
25/12/13 22:58:29 INFO FileFormatWriter: Write Job fe2da002-c488-4258-95ae-1c2e8b06fe9e committed. Elapsed time: 18 ms.
25/12/13 22:58:29 INFO FileFormatWriter: Finished processing stats for write job fe2da002-c488-4258-95ae-1c2e8b06fe9e.
25/12/13 22:58:29 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/12/13 22:58:29 INFO SparkUI: Stopped Spark web UI at http://ip-172-31-64-111.ec2.internal:4040
25/12/13 22:58:29 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/12/13 22:58:29 INFO MemoryStore: MemoryStore cleared
25/12/13 22:58:29 INFO BlockManager: BlockManager stopped
25/12/13 22:58:29 INFO BlockManagerMaster: BlockManagerMaster stopped
25/12/13 22:58:29 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/12/13 22:58:29 INFO SparkContext: Successfully stopped SparkContext
25/12/13 22:58:29 INFO ShutdownHookManager: Shutdown hook called
25/12/13 22:58:29 INFO ShutdownHookManager: Deleting directory /tmp/spark-f4131ffe-0f61-4ece-bc44-f4d14b71af9b
25/12/13 22:58:29 INFO ShutdownHookManager: Deleting directory /tmp/spark-f4131ffe-0f61-4ece-bc44-f4d14b71af9b/pyspark-770561de-051b-4e61-b384-61eea1001e15
25/12/13 22:58:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-124e0a13-66fa-4a74-acda-d3fc60b864cf
Uploading logs to S3...
Completed 199.8 KiB/199.8 KiB (2.0 MiB/s) with 1 file(s) remainingupload: ../pipeline/logs/pipeline_2025-12-13_22-56-35.log to s3://rg422-bigdata/processed/analytics/logs/pipeline_2025-12-13_22-56-35.log
{
    "MessageId": "b7bd5c46-23e8-5492-a7b8-3df1d2320df6"
}
==========================================
âœ… Pipeline completed successfully
==========================================
